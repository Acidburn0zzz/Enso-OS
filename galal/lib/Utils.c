/* Utils.c generated by valac 0.30.1, the Vala compiler
 * generated from Utils.vala, do not modify */

/**/
/*  Copyright (C) 2012 Tom Beckmann, Rico Tzschichholz*/
/**/
/*  This program is free software: you can redistribute it and/or modify*/
/*  it under the terms of the GNU General Public License as published by*/
/*  the Free Software Foundation, either version 3 of the License, or*/
/*  (at your option) any later version.*/
/**/
/*  This program is distributed in the hope that it will be useful,*/
/*  but WITHOUT ANY WARRANTY; without even the implied warranty of*/
/*  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the*/
/*  GNU General Public License for more details.*/
/**/
/*  You should have received a copy of the GNU General Public License*/
/*  along with this program.  If not, see <http://www.gnu.org/licenses/>.*/
/**/

#include <glib.h>
#include <glib-object.h>
#include <stdlib.h>
#include <string.h>
#include <gdk-pixbuf/gdk-pixbuf.h>
#include <meta/window.h>
#include <libbamf/libbamf.h>
#include <gio/gdesktopappinfo.h>
#include <plank.h>
#include <gio/gio.h>
#include <gtk/gtk.h>
#include <meta/workspace.h>
#include <meta/screen.h>
#include <meta/display.h>
#include <meta/meta-window-actor.h>
#include <meta/boxes.h>
#include <clutter/clutter.h>
#include <cairo.h>
#include <meta/meta-shaped-texture.h>
#include <float.h>
#include <math.h>
#include <meta/prefs.h>
#include <gdk/gdk.h>
#include <meta/compositor.h>
#include "config.h"
#include <gobject/gvaluecollector.h>


#define GALA_TYPE_UTILS (gala_utils_get_type ())
#define GALA_UTILS(obj) (G_TYPE_CHECK_INSTANCE_CAST ((obj), GALA_TYPE_UTILS, GalaUtils))
#define GALA_UTILS_CLASS(klass) (G_TYPE_CHECK_CLASS_CAST ((klass), GALA_TYPE_UTILS, GalaUtilsClass))
#define GALA_IS_UTILS(obj) (G_TYPE_CHECK_INSTANCE_TYPE ((obj), GALA_TYPE_UTILS))
#define GALA_IS_UTILS_CLASS(klass) (G_TYPE_CHECK_CLASS_TYPE ((klass), GALA_TYPE_UTILS))
#define GALA_UTILS_GET_CLASS(obj) (G_TYPE_INSTANCE_GET_CLASS ((obj), GALA_TYPE_UTILS, GalaUtilsClass))

typedef struct _GalaUtils GalaUtils;
typedef struct _GalaUtilsClass GalaUtilsClass;
typedef struct _GalaUtilsPrivate GalaUtilsPrivate;
#define _g_object_unref0(var) ((var == NULL) ? NULL : (var = (g_object_unref (var), NULL)))
#define _g_list_free0(var) ((var == NULL) ? NULL : (var = (g_list_free (var), NULL)))
typedef struct _Block1Data Block1Data;
#define _g_free0(var) (var = (g_free (var), NULL))
#define _g_error_free0(var) ((var == NULL) ? NULL : (var = (g_error_free (var), NULL)))
typedef struct _Block2Data Block2Data;
#define _cairo_surface_destroy0(var) ((var == NULL) ? NULL : (var = (cairo_surface_destroy (var), NULL)))
#define _g_hash_table_unref0(var) ((var == NULL) ? NULL : (var = (g_hash_table_unref (var), NULL)))
typedef struct _GalaParamSpecUtils GalaParamSpecUtils;

struct _GalaUtils {
	GTypeInstance parent_instance;
	volatile int ref_count;
	GalaUtilsPrivate * priv;
};

struct _GalaUtilsClass {
	GTypeClass parent_class;
	void (*finalize) (GalaUtils *self);
};

struct _Block1Data {
	int _ref_count_;
	guint32* xids;
	gint xids_length1;
};

struct _Block2Data {
	int _ref_count_;
	cairo_surface_t* surface;
};

struct _GalaParamSpecUtils {
	GParamSpec parent_instance;
};


static gpointer gala_utils_parent_class = NULL;
static GHashTable* gala_utils_xid_pixbuf_cache;
static GHashTable* gala_utils_xid_pixbuf_cache = NULL;
static GHashTable* gala_utils_icon_pixbuf_cache;
static GHashTable* gala_utils_icon_pixbuf_cache = NULL;
static guint gala_utils_cache_clear_timeout;
static guint gala_utils_cache_clear_timeout = (guint) 0;
static GdkPixbuf* gala_utils_close_pixbuf;
static GdkPixbuf* gala_utils_close_pixbuf = NULL;

gpointer gala_utils_ref (gpointer instance);
void gala_utils_unref (gpointer instance);
GParamSpec* gala_param_spec_utils (const gchar* name, const gchar* nick, const gchar* blurb, GType object_type, GParamFlags flags);
void gala_value_set_utils (GValue* value, gpointer v_object);
void gala_value_take_utils (GValue* value, gpointer v_object);
gpointer gala_value_get_utils (const GValue* value);
GType gala_utils_get_type (void) G_GNUC_CONST;
enum  {
	GALA_UTILS_DUMMY_PROPERTY
};
static GalaUtils* gala_utils_new (void);
static GalaUtils* gala_utils_construct (GType object_type);
static void gala_utils_clean_icon_cache (guint32* xids, int xids_length1);
static gboolean _vala_uint32_array_contains (guint32* stack, int stack_length, guint32 needle);
void gala_utils_request_clean_icon_cache (guint32* xids, int xids_length1);
static Block1Data* block1_data_ref (Block1Data* _data1_);
static void block1_data_unref (void * _userdata_);
static gboolean __lambda5_ (Block1Data* _data1_);
static gboolean __lambda6_ (Block1Data* _data1_);
static gboolean ___lambda6__gsource_func (gpointer self);
static gboolean ___lambda5__gsource_func (gpointer self);
GdkPixbuf* gala_utils_get_icon_for_window (MetaWindow* window, gint size, gboolean ignore_cache);
GdkPixbuf* gala_utils_get_icon_for_xid (guint32 xid, gint size, gboolean ignore_cache);
static GdkPixbuf* gala_utils_get_icon_for_application (BamfApplication* app, gint size, gboolean ignore_cache);
MetaWindow* gala_utils_get_next_window (MetaWorkspace* workspace, gboolean backward);
guint gala_utils_get_n_windows (MetaWorkspace* workspace);
ClutterActor* gala_utils_get_window_actor_snapshot (MetaWindowActor* actor, MetaRectangle* inner_rect, MetaRectangle* outer_rect);
static Block2Data* block2_data_ref (Block2Data* _data2_);
static void block2_data_unref (void * _userdata_);
static gboolean __lambda7_ (Block2Data* _data2_, cairo_t* cr);
static gboolean ___lambda7__clutter_canvas_draw (ClutterCanvas* _sender, cairo_t* cr, gint width, gint height, gpointer self);
void gala_utils_bell (MetaScreen* screen);
GdkPixbuf* gala_utils_get_close_button_pixbuf (void);
ClutterActor* gala_utils_create_close_button (void);
static void _g_free0_ (gpointer var);
static void _g_object_unref0_ (gpointer var);
static void gala_utils_finalize (GalaUtils* obj);
static void _vala_array_destroy (gpointer array, gint array_length, GDestroyNotify destroy_func);
static void _vala_array_free (gpointer array, gint array_length, GDestroyNotify destroy_func);
static gint _vala_array_length (gpointer array);


static GalaUtils* gala_utils_construct (GType object_type) {
	GalaUtils* self = NULL;
#line 35 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	self = (GalaUtils*) g_type_create_instance (object_type);
#line 35 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	return self;
#line 155 "Utils.c"
}


static GalaUtils* gala_utils_new (void) {
#line 35 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	return gala_utils_construct (GALA_TYPE_UTILS);
#line 162 "Utils.c"
}


/**
 * Clean icon caches
 */
static guint64 uint64_parse (const gchar* str) {
	guint64 result = 0ULL;
	const gchar* _tmp0_ = NULL;
	guint64 _tmp1_ = 0ULL;
#line 657 "/usr/share/vala-0.30/vapi/glib-2.0.vapi"
	g_return_val_if_fail (str != NULL, 0ULL);
#line 658 "/usr/share/vala-0.30/vapi/glib-2.0.vapi"
	_tmp0_ = str;
#line 658 "/usr/share/vala-0.30/vapi/glib-2.0.vapi"
	_tmp1_ = g_ascii_strtoull (_tmp0_, NULL, (guint) 0);
#line 658 "/usr/share/vala-0.30/vapi/glib-2.0.vapi"
	result = _tmp1_;
#line 658 "/usr/share/vala-0.30/vapi/glib-2.0.vapi"
	return result;
#line 183 "Utils.c"
}


static gboolean _vala_uint32_array_contains (guint32* stack, int stack_length, guint32 needle) {
	int i;
#line 50 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	for (i = 0; i < stack_length; i++) {
#line 50 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
		if (needle == stack[i]) {
#line 50 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
			return TRUE;
#line 195 "Utils.c"
		}
	}
#line 50 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	return FALSE;
#line 200 "Utils.c"
}


static gpointer _g_object_ref0 (gpointer self) {
#line 51 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	return self ? g_object_ref (self) : NULL;
#line 207 "Utils.c"
}


static void gala_utils_clean_icon_cache (guint32* xids, int xids_length1) {
	GList* list = NULL;
	GHashTable* _tmp0_ = NULL;
	GList* _tmp1_ = NULL;
	GList* pixbuf_list = NULL;
	GHashTable* _tmp2_ = NULL;
	GList* _tmp3_ = NULL;
	GList* icon_list = NULL;
	GHashTable* _tmp4_ = NULL;
	GList* _tmp5_ = NULL;
	GList* _tmp6_ = NULL;
#line 44 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	_tmp0_ = gala_utils_xid_pixbuf_cache;
#line 44 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	_tmp1_ = g_hash_table_get_keys (_tmp0_);
#line 44 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	list = _tmp1_;
#line 45 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	_tmp2_ = gala_utils_icon_pixbuf_cache;
#line 45 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	_tmp3_ = g_hash_table_get_values (_tmp2_);
#line 45 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	pixbuf_list = _tmp3_;
#line 46 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	_tmp4_ = gala_utils_icon_pixbuf_cache;
#line 46 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	_tmp5_ = g_hash_table_get_keys (_tmp4_);
#line 46 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	icon_list = _tmp5_;
#line 48 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	_tmp6_ = list;
#line 242 "Utils.c"
	{
		GList* xid_key_collection = NULL;
		GList* xid_key_it = NULL;
#line 48 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
		xid_key_collection = _tmp6_;
#line 48 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
		for (xid_key_it = xid_key_collection; xid_key_it != NULL; xid_key_it = xid_key_it->next) {
#line 250 "Utils.c"
			const gchar* xid_key = NULL;
#line 48 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
			xid_key = (const gchar*) xid_key_it->data;
#line 254 "Utils.c"
			{
				guint32 xid = 0U;
				const gchar* _tmp7_ = NULL;
				gchar** _tmp8_ = NULL;
				gchar** _tmp9_ = NULL;
				gchar** _tmp10_ = NULL;
				gint _tmp10__length1 = 0;
				const gchar* _tmp11_ = NULL;
				guint64 _tmp12_ = 0ULL;
				guint32 _tmp13_ = 0U;
				guint32 _tmp14_ = 0U;
				guint32* _tmp15_ = NULL;
				gint _tmp15__length1 = 0;
#line 49 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
				_tmp7_ = xid_key;
#line 49 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
				_tmp9_ = _tmp8_ = g_strsplit (_tmp7_, "::", 0);
#line 49 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
				_tmp10_ = _tmp9_;
#line 49 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
				_tmp10__length1 = _vala_array_length (_tmp8_);
#line 49 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
				_tmp11_ = _tmp10_[0];
#line 49 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
				_tmp12_ = uint64_parse (_tmp11_);
#line 49 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
				_tmp13_ = (guint32) _tmp12_;
#line 49 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
				_tmp10_ = (_vala_array_free (_tmp10_, _tmp10__length1, (GDestroyNotify) g_free), NULL);
#line 49 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
				xid = _tmp13_;
#line 50 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
				_tmp14_ = xid;
#line 50 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
				_tmp15_ = xids;
#line 50 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
				_tmp15__length1 = xids_length1;
#line 50 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
				if (!_vala_uint32_array_contains (_tmp15_, _tmp15__length1, _tmp14_)) {
#line 294 "Utils.c"
					GdkPixbuf* pixbuf = NULL;
					GHashTable* _tmp16_ = NULL;
					const gchar* _tmp17_ = NULL;
					gconstpointer _tmp18_ = NULL;
					GdkPixbuf* _tmp19_ = NULL;
					GHashTable* _tmp33_ = NULL;
					const gchar* _tmp34_ = NULL;
#line 51 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
					_tmp16_ = gala_utils_xid_pixbuf_cache;
#line 51 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
					_tmp17_ = xid_key;
#line 51 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
					_tmp18_ = g_hash_table_lookup (_tmp16_, _tmp17_);
#line 51 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
					_tmp19_ = _g_object_ref0 ((GdkPixbuf*) _tmp18_);
#line 51 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
					pixbuf = _tmp19_;
#line 312 "Utils.c"
					{
						gint j = 0;
#line 52 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
						j = 0;
#line 317 "Utils.c"
						{
							gboolean _tmp20_ = FALSE;
#line 52 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
							_tmp20_ = TRUE;
#line 52 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
							while (TRUE) {
#line 324 "Utils.c"
								gint _tmp22_ = 0;
								GList* _tmp23_ = NULL;
								guint _tmp24_ = 0U;
								GList* _tmp25_ = NULL;
								gint _tmp26_ = 0;
								gconstpointer _tmp27_ = NULL;
								GdkPixbuf* _tmp28_ = NULL;
#line 52 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
								if (!_tmp20_) {
#line 334 "Utils.c"
									gint _tmp21_ = 0;
#line 52 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
									_tmp21_ = j;
#line 52 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
									j = _tmp21_ + 1;
#line 340 "Utils.c"
								}
#line 52 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
								_tmp20_ = FALSE;
#line 52 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
								_tmp22_ = j;
#line 52 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
								_tmp23_ = pixbuf_list;
#line 52 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
								_tmp24_ = g_list_length (_tmp23_);
#line 52 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
								if (!(((guint) _tmp22_) < _tmp24_)) {
#line 52 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
									break;
#line 354 "Utils.c"
								}
#line 53 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
								_tmp25_ = pixbuf_list;
#line 53 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
								_tmp26_ = j;
#line 53 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
								_tmp27_ = g_list_nth_data (_tmp25_, (guint) _tmp26_);
#line 53 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
								_tmp28_ = pixbuf;
#line 53 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
								if (((GdkPixbuf*) _tmp27_) == _tmp28_) {
#line 366 "Utils.c"
									GHashTable* _tmp29_ = NULL;
									GList* _tmp30_ = NULL;
									gint _tmp31_ = 0;
									gconstpointer _tmp32_ = NULL;
#line 54 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
									_tmp29_ = gala_utils_xid_pixbuf_cache;
#line 54 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
									_tmp30_ = icon_list;
#line 54 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
									_tmp31_ = j;
#line 54 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
									_tmp32_ = g_list_nth_data (_tmp30_, (guint) _tmp31_);
#line 54 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
									g_hash_table_remove (_tmp29_, (const gchar*) _tmp32_);
#line 381 "Utils.c"
								}
							}
						}
					}
#line 58 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
					_tmp33_ = gala_utils_xid_pixbuf_cache;
#line 58 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
					_tmp34_ = xid_key;
#line 58 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
					g_hash_table_remove (_tmp33_, _tmp34_);
#line 50 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
					_g_object_unref0 (pixbuf);
#line 394 "Utils.c"
				}
			}
		}
	}
#line 42 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	_g_list_free0 (icon_list);
#line 42 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	_g_list_free0 (pixbuf_list);
#line 42 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	_g_list_free0 (list);
#line 405 "Utils.c"
}


/**
 * Marks the given xids as no longer needed, the corresponding icons
 * may be freed now. Mainly for internal purposes.
 *
 * @param xids The xids of the window that no longer need icons
 */
static Block1Data* block1_data_ref (Block1Data* _data1_) {
#line 69 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	g_atomic_int_inc (&_data1_->_ref_count_);
#line 69 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	return _data1_;
#line 420 "Utils.c"
}


static void block1_data_unref (void * _userdata_) {
	Block1Data* _data1_;
	_data1_ = (Block1Data*) _userdata_;
#line 69 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	if (g_atomic_int_dec_and_test (&_data1_->_ref_count_)) {
#line 69 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
		g_slice_free (Block1Data, _data1_);
#line 431 "Utils.c"
	}
}


static gboolean __lambda6_ (Block1Data* _data1_) {
	gboolean result = FALSE;
	guint32* _tmp0_ = NULL;
	gint _tmp0__length1 = 0;
#line 77 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	_tmp0_ = _data1_->xids;
#line 77 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	_tmp0__length1 = _data1_->xids_length1;
#line 77 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	gala_utils_clean_icon_cache (_tmp0_, _tmp0__length1);
#line 78 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	result = FALSE;
#line 78 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	return result;
#line 450 "Utils.c"
}


static gboolean ___lambda6__gsource_func (gpointer self) {
	gboolean result;
	result = __lambda6_ (self);
#line 76 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	return result;
#line 459 "Utils.c"
}


static gboolean __lambda5_ (Block1Data* _data1_) {
	gboolean result = FALSE;
#line 75 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	gala_utils_cache_clear_timeout = (guint) 0;
#line 76 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	g_idle_add_full (G_PRIORITY_DEFAULT_IDLE, ___lambda6__gsource_func, block1_data_ref (_data1_), block1_data_unref);
#line 80 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	result = FALSE;
#line 80 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	return result;
#line 473 "Utils.c"
}


static gboolean ___lambda5__gsource_func (gpointer self) {
	gboolean result;
	result = __lambda5_ (self);
#line 74 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	return result;
#line 482 "Utils.c"
}


void gala_utils_request_clean_icon_cache (guint32* xids, int xids_length1) {
	Block1Data* _data1_;
	guint32* _tmp0_ = NULL;
	gint _tmp0__length1 = 0;
	guint _tmp1_ = 0U;
	guint _tmp3_ = 0U;
#line 69 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	_data1_ = g_slice_new0 (Block1Data);
#line 69 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	_data1_->_ref_count_ = 1;
#line 69 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	_tmp0_ = xids;
#line 69 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	_tmp0__length1 = xids_length1;
#line 69 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	_data1_->xids = _tmp0_;
#line 69 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	_data1_->xids_length1 = _tmp0__length1;
#line 71 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	_tmp1_ = gala_utils_cache_clear_timeout;
#line 71 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	if (_tmp1_ > ((guint) 0)) {
#line 508 "Utils.c"
		guint _tmp2_ = 0U;
#line 72 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
		_tmp2_ = gala_utils_cache_clear_timeout;
#line 72 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
		g_source_remove (_tmp2_);
#line 514 "Utils.c"
	}
#line 74 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	_tmp3_ = g_timeout_add_seconds_full (G_PRIORITY_DEFAULT, (guint) 30, ___lambda5__gsource_func, block1_data_ref (_data1_), block1_data_unref);
#line 74 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	gala_utils_cache_clear_timeout = _tmp3_;
#line 69 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	block1_data_unref (_data1_);
#line 69 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	_data1_ = NULL;
#line 524 "Utils.c"
}


/**
 * Returns a pixbuf for the application of this window or a default icon
 *
 * @param window       The window to get an icon for
 * @param size         The size of the icon
 * @param ignore_cache Should not be necessary in most cases, if you care about the icon
 *                     being loaded correctly, you should consider using the WindowIcon class
 */
GdkPixbuf* gala_utils_get_icon_for_window (MetaWindow* window, gint size, gboolean ignore_cache) {
	GdkPixbuf* result = NULL;
	MetaWindow* _tmp0_ = NULL;
	Window _tmp1_ = 0;
	gint _tmp2_ = 0;
	gboolean _tmp3_ = FALSE;
	GdkPixbuf* _tmp4_ = NULL;
#line 92 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	g_return_val_if_fail (window != NULL, NULL);
#line 94 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	_tmp0_ = window;
#line 94 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	_tmp1_ = meta_window_get_xwindow (_tmp0_);
#line 94 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	_tmp2_ = size;
#line 94 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	_tmp3_ = ignore_cache;
#line 94 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	_tmp4_ = gala_utils_get_icon_for_xid ((guint32) _tmp1_, _tmp2_, _tmp3_);
#line 94 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	result = _tmp4_;
#line 94 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	return result;
#line 559 "Utils.c"
}


/**
 * Returns a pixbuf for a given xid or a default icon
 *
 * @see get_icon_for_window
 */
GdkPixbuf* gala_utils_get_icon_for_xid (guint32 xid, gint size, gboolean ignore_cache) {
	GdkPixbuf* result = NULL;
	GdkPixbuf* _result_ = NULL;
	gchar* xid_key = NULL;
	guint32 _tmp0_ = 0U;
	gint _tmp1_ = 0;
	gchar* _tmp2_ = NULL;
	gboolean _tmp3_ = FALSE;
	gboolean _tmp4_ = FALSE;
	BamfApplication* app = NULL;
	BamfMatcher* _tmp10_ = NULL;
	BamfMatcher* _tmp11_ = NULL;
	guint32 _tmp12_ = 0U;
	BamfApplication* _tmp13_ = NULL;
	BamfApplication* _tmp14_ = NULL;
	BamfApplication* _tmp15_ = NULL;
	BamfApplication* _tmp16_ = NULL;
	gint _tmp17_ = 0;
	gboolean _tmp18_ = FALSE;
	GdkPixbuf* _tmp19_ = NULL;
	GHashTable* _tmp20_ = NULL;
	const gchar* _tmp21_ = NULL;
	gchar* _tmp22_ = NULL;
	GdkPixbuf* _tmp23_ = NULL;
	GdkPixbuf* _tmp24_ = NULL;
#line 104 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	_result_ = NULL;
#line 105 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	_tmp0_ = xid;
#line 105 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	_tmp1_ = size;
#line 105 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	_tmp2_ = g_strdup_printf ("%u::%i", (guint) _tmp0_, _tmp1_);
#line 105 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	xid_key = _tmp2_;
#line 107 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	_tmp4_ = ignore_cache;
#line 107 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	if (!_tmp4_) {
#line 607 "Utils.c"
		GHashTable* _tmp5_ = NULL;
		const gchar* _tmp6_ = NULL;
		gconstpointer _tmp7_ = NULL;
		GdkPixbuf* _tmp8_ = NULL;
		GdkPixbuf* _tmp9_ = NULL;
#line 107 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
		_tmp5_ = gala_utils_xid_pixbuf_cache;
#line 107 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
		_tmp6_ = xid_key;
#line 107 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
		_tmp7_ = g_hash_table_lookup (_tmp5_, _tmp6_);
#line 107 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
		_tmp8_ = _g_object_ref0 ((GdkPixbuf*) _tmp7_);
#line 107 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
		_g_object_unref0 (_result_);
#line 107 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
		_result_ = _tmp8_;
#line 107 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
		_tmp9_ = _result_;
#line 107 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
		_tmp3_ = _tmp9_ != NULL;
#line 629 "Utils.c"
	} else {
#line 107 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
		_tmp3_ = FALSE;
#line 633 "Utils.c"
	}
#line 107 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	if (_tmp3_) {
#line 108 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
		result = _result_;
#line 108 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
		_g_free0 (xid_key);
#line 108 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
		return result;
#line 643 "Utils.c"
	}
#line 110 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	_tmp10_ = bamf_matcher_get_default ();
#line 110 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	_tmp11_ = _tmp10_;
#line 110 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	_tmp12_ = xid;
#line 110 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	_tmp13_ = bamf_matcher_get_application_for_xid (_tmp11_, _tmp12_);
#line 110 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	_tmp14_ = _g_object_ref0 (_tmp13_);
#line 110 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	_tmp15_ = _tmp14_;
#line 110 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	_g_object_unref0 (_tmp11_);
#line 110 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	app = _tmp15_;
#line 111 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	_tmp16_ = app;
#line 111 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	_tmp17_ = size;
#line 111 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	_tmp18_ = ignore_cache;
#line 111 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	_tmp19_ = gala_utils_get_icon_for_application (_tmp16_, _tmp17_, _tmp18_);
#line 111 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	_g_object_unref0 (_result_);
#line 111 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	_result_ = _tmp19_;
#line 113 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	_tmp20_ = gala_utils_xid_pixbuf_cache;
#line 113 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	_tmp21_ = xid_key;
#line 113 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	_tmp22_ = g_strdup (_tmp21_);
#line 113 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	_tmp23_ = _result_;
#line 113 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	_tmp24_ = _g_object_ref0 (_tmp23_);
#line 113 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	g_hash_table_insert (_tmp20_, _tmp22_, _tmp24_);
#line 115 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	result = _result_;
#line 115 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	_g_object_unref0 (app);
#line 115 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	_g_free0 (xid_key);
#line 115 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	return result;
#line 693 "Utils.c"
}


/**
 * Returns a pixbuf for this application or a default icon
 *
 * @see get_icon_for_window
 */
static GdkPixbuf* gala_utils_get_icon_for_application (BamfApplication* app, gint size, gboolean ignore_cache) {
	GdkPixbuf* result = NULL;
	GdkPixbuf* image = NULL;
	gboolean not_cached = FALSE;
	gchar* icon = NULL;
	gchar* icon_key = NULL;
	gboolean _tmp0_ = FALSE;
	BamfApplication* _tmp1_ = NULL;
	GdkPixbuf* _tmp25_ = NULL;
	GdkPixbuf* _tmp44_ = NULL;
	gboolean _tmp57_ = FALSE;
	gint _tmp58_ = 0;
	GdkPixbuf* _tmp59_ = NULL;
	gint _tmp60_ = 0;
	gint _tmp61_ = 0;
	gboolean _tmp70_ = FALSE;
	GError * _inner_error_ = NULL;
#line 126 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	image = NULL;
#line 127 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	not_cached = FALSE;
#line 129 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	icon = NULL;
#line 130 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	icon_key = NULL;
#line 132 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	_tmp1_ = app;
#line 132 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	if (_tmp1_ != NULL) {
#line 731 "Utils.c"
		BamfApplication* _tmp2_ = NULL;
		const gchar* _tmp3_ = NULL;
#line 132 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
		_tmp2_ = app;
#line 132 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
		_tmp3_ = bamf_application_get_desktop_file (_tmp2_);
#line 132 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
		_tmp0_ = _tmp3_ != NULL;
#line 740 "Utils.c"
	} else {
#line 132 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
		_tmp0_ = FALSE;
#line 744 "Utils.c"
	}
#line 132 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	if (_tmp0_) {
#line 748 "Utils.c"
		GDesktopAppInfo* appinfo = NULL;
		BamfApplication* _tmp4_ = NULL;
		const gchar* _tmp5_ = NULL;
		GDesktopAppInfo* _tmp6_ = NULL;
		GDesktopAppInfo* _tmp7_ = NULL;
#line 133 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
		_tmp4_ = app;
#line 133 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
		_tmp5_ = bamf_application_get_desktop_file (_tmp4_);
#line 133 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
		_tmp6_ = g_desktop_app_info_new_from_filename (_tmp5_);
#line 133 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
		appinfo = _tmp6_;
#line 134 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
		_tmp7_ = appinfo;
#line 134 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
		if (_tmp7_ != NULL) {
#line 766 "Utils.c"
			GDesktopAppInfo* _tmp8_ = NULL;
			GIcon* _tmp9_ = NULL;
			gchar* _tmp10_ = NULL;
			const gchar* _tmp11_ = NULL;
			gint _tmp12_ = 0;
			gchar* _tmp13_ = NULL;
			gboolean _tmp14_ = FALSE;
			gboolean _tmp15_ = FALSE;
#line 136 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
			_tmp8_ = appinfo;
#line 136 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
			_tmp9_ = g_app_info_get_icon ((GAppInfo*) _tmp8_);
#line 136 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
			_tmp10_ = plank_drawing_service_get_icon_from_gicon (_tmp9_);
#line 136 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
			_g_free0 (icon);
#line 136 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
			icon = _tmp10_;
#line 140 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
			_tmp11_ = icon;
#line 140 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
			_tmp12_ = size;
#line 140 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
			_tmp13_ = g_strdup_printf ("%s::%i", _tmp11_, _tmp12_);
#line 140 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
			_g_free0 (icon_key);
#line 140 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
			icon_key = _tmp13_;
#line 141 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
			_tmp15_ = ignore_cache;
#line 141 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
			if (_tmp15_) {
#line 141 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
				_tmp14_ = TRUE;
#line 801 "Utils.c"
			} else {
				GHashTable* _tmp16_ = NULL;
				const gchar* _tmp17_ = NULL;
				gconstpointer _tmp18_ = NULL;
				GdkPixbuf* _tmp19_ = NULL;
				GdkPixbuf* _tmp20_ = NULL;
#line 141 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
				_tmp16_ = gala_utils_icon_pixbuf_cache;
#line 141 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
				_tmp17_ = icon_key;
#line 141 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
				_tmp18_ = g_hash_table_lookup (_tmp16_, _tmp17_);
#line 141 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
				_tmp19_ = _g_object_ref0 ((GdkPixbuf*) _tmp18_);
#line 141 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
				_g_object_unref0 (image);
#line 141 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
				image = _tmp19_;
#line 141 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
				_tmp20_ = image;
#line 141 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
				_tmp14_ = _tmp20_ == NULL;
#line 824 "Utils.c"
			}
#line 141 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
			if (_tmp14_) {
#line 828 "Utils.c"
				const gchar* _tmp21_ = NULL;
				gint _tmp22_ = 0;
				gint _tmp23_ = 0;
				GdkPixbuf* _tmp24_ = NULL;
#line 143 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
				_tmp21_ = icon;
#line 143 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
				_tmp22_ = size;
#line 143 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
				_tmp23_ = size;
#line 143 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
				_tmp24_ = plank_drawing_service_load_icon (_tmp21_, _tmp22_, _tmp23_);
#line 143 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
				_g_object_unref0 (image);
#line 143 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
				image = _tmp24_;
#line 147 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
				not_cached = TRUE;
#line 847 "Utils.c"
			}
		}
#line 132 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
		_g_object_unref0 (appinfo);
#line 852 "Utils.c"
	}
#line 152 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	_tmp25_ = image;
#line 152 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	if (_tmp25_ == NULL) {
#line 858 "Utils.c"
		{
			GtkIconTheme* icon_theme = NULL;
			GtkIconTheme* _tmp26_ = NULL;
			gchar* _tmp27_ = NULL;
			const gchar* _tmp28_ = NULL;
			gint _tmp29_ = 0;
			gchar* _tmp30_ = NULL;
			GHashTable* _tmp31_ = NULL;
			const gchar* _tmp32_ = NULL;
			gconstpointer _tmp33_ = NULL;
			GdkPixbuf* _tmp34_ = NULL;
			GdkPixbuf* _tmp35_ = NULL;
#line 154 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
			_tmp26_ = gtk_icon_theme_get_default ();
#line 154 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
			icon_theme = _tmp26_;
#line 155 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
			_tmp27_ = g_strdup ("application-default-icon");
#line 155 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
			_g_free0 (icon);
#line 155 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
			icon = _tmp27_;
#line 156 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
			_tmp28_ = icon;
#line 156 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
			_tmp29_ = size;
#line 156 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
			_tmp30_ = g_strdup_printf ("%s::%i", _tmp28_, _tmp29_);
#line 156 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
			_g_free0 (icon_key);
#line 156 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
			icon_key = _tmp30_;
#line 157 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
			_tmp31_ = gala_utils_icon_pixbuf_cache;
#line 157 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
			_tmp32_ = icon_key;
#line 157 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
			_tmp33_ = g_hash_table_lookup (_tmp31_, _tmp32_);
#line 157 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
			_tmp34_ = _g_object_ref0 ((GdkPixbuf*) _tmp33_);
#line 157 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
			_g_object_unref0 (image);
#line 157 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
			image = _tmp34_;
#line 157 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
			_tmp35_ = image;
#line 157 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
			if (_tmp35_ == NULL) {
#line 907 "Utils.c"
				GdkPixbuf* _tmp36_ = NULL;
				GtkIconTheme* _tmp37_ = NULL;
				const gchar* _tmp38_ = NULL;
				gint _tmp39_ = 0;
				GdkPixbuf* _tmp40_ = NULL;
				GdkPixbuf* _tmp41_ = NULL;
#line 158 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
				_tmp37_ = icon_theme;
#line 158 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
				_tmp38_ = icon;
#line 158 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
				_tmp39_ = size;
#line 158 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
				_tmp40_ = gtk_icon_theme_load_icon (_tmp37_, _tmp38_, _tmp39_, 0, &_inner_error_);
#line 158 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
				_tmp36_ = _tmp40_;
#line 158 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
				if (G_UNLIKELY (_inner_error_ != NULL)) {
#line 926 "Utils.c"
					goto __catch0_g_error;
				}
#line 158 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
				_tmp41_ = _tmp36_;
#line 158 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
				_tmp36_ = NULL;
#line 158 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
				_g_object_unref0 (image);
#line 158 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
				image = _tmp41_;
#line 159 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
				not_cached = TRUE;
#line 157 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
				_g_object_unref0 (_tmp36_);
#line 941 "Utils.c"
			}
		}
		goto __finally0;
		__catch0_g_error:
		{
			GError* e = NULL;
			GError* _tmp42_ = NULL;
			const gchar* _tmp43_ = NULL;
#line 153 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
			e = _inner_error_;
#line 153 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
			_inner_error_ = NULL;
#line 162 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
			_tmp42_ = e;
#line 162 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
			_tmp43_ = _tmp42_->message;
#line 162 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
			g_warning ("Utils.vala:162: %s", _tmp43_);
#line 153 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
			_g_error_free0 (e);
#line 962 "Utils.c"
		}
		__finally0:
#line 153 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
		if (G_UNLIKELY (_inner_error_ != NULL)) {
#line 153 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
			_g_free0 (icon_key);
#line 153 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
			_g_free0 (icon);
#line 153 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
			_g_object_unref0 (image);
#line 153 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
			g_critical ("file %s: line %d: uncaught error: %s (%s, %d)", __FILE__, __LINE__, _inner_error_->message, g_quark_to_string (_inner_error_->domain), _inner_error_->code);
#line 153 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
			g_clear_error (&_inner_error_);
#line 153 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
			return NULL;
#line 979 "Utils.c"
		}
	}
#line 166 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	_tmp44_ = image;
#line 166 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	if (_tmp44_ == NULL) {
#line 986 "Utils.c"
		gchar* _tmp45_ = NULL;
		gint _tmp46_ = 0;
		gchar* _tmp47_ = NULL;
		GHashTable* _tmp48_ = NULL;
		const gchar* _tmp49_ = NULL;
		gconstpointer _tmp50_ = NULL;
		GdkPixbuf* _tmp51_ = NULL;
		GdkPixbuf* _tmp52_ = NULL;
#line 167 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
		_tmp45_ = g_strdup ("");
#line 167 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
		_g_free0 (icon);
#line 167 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
		icon = _tmp45_;
#line 168 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
		_tmp46_ = size;
#line 168 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
		_tmp47_ = g_strdup_printf ("::%i", _tmp46_);
#line 168 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
		_g_free0 (icon_key);
#line 168 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
		icon_key = _tmp47_;
#line 169 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
		_tmp48_ = gala_utils_icon_pixbuf_cache;
#line 169 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
		_tmp49_ = icon_key;
#line 169 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
		_tmp50_ = g_hash_table_lookup (_tmp48_, _tmp49_);
#line 169 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
		_tmp51_ = _g_object_ref0 ((GdkPixbuf*) _tmp50_);
#line 169 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
		_g_object_unref0 (image);
#line 169 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
		image = _tmp51_;
#line 169 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
		_tmp52_ = image;
#line 169 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
		if (_tmp52_ == NULL) {
#line 1025 "Utils.c"
			gint _tmp53_ = 0;
			gint _tmp54_ = 0;
			GdkPixbuf* _tmp55_ = NULL;
			GdkPixbuf* _tmp56_ = NULL;
#line 170 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
			_tmp53_ = size;
#line 170 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
			_tmp54_ = size;
#line 170 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
			_tmp55_ = gdk_pixbuf_new (GDK_COLORSPACE_RGB, TRUE, 8, _tmp53_, _tmp54_);
#line 170 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
			_g_object_unref0 (image);
#line 170 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
			image = _tmp55_;
#line 171 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
			_tmp56_ = image;
#line 171 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
			gdk_pixbuf_fill (_tmp56_, (guint32) 0x00000000);
#line 172 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
			not_cached = TRUE;
#line 1046 "Utils.c"
		}
	}
#line 176 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	_tmp58_ = size;
#line 176 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	_tmp59_ = image;
#line 176 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	_tmp60_ = gdk_pixbuf_get_width (_tmp59_);
#line 176 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	_tmp61_ = _tmp60_;
#line 176 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	if (_tmp58_ != _tmp61_) {
#line 176 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
		_tmp57_ = TRUE;
#line 1061 "Utils.c"
	} else {
		gint _tmp62_ = 0;
		GdkPixbuf* _tmp63_ = NULL;
		gint _tmp64_ = 0;
		gint _tmp65_ = 0;
#line 176 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
		_tmp62_ = size;
#line 176 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
		_tmp63_ = image;
#line 176 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
		_tmp64_ = gdk_pixbuf_get_height (_tmp63_);
#line 176 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
		_tmp65_ = _tmp64_;
#line 176 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
		_tmp57_ = _tmp62_ != _tmp65_;
#line 1077 "Utils.c"
	}
#line 176 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	if (_tmp57_) {
#line 1081 "Utils.c"
		GdkPixbuf* _tmp66_ = NULL;
		gint _tmp67_ = 0;
		gint _tmp68_ = 0;
		GdkPixbuf* _tmp69_ = NULL;
#line 178 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
		_tmp66_ = image;
#line 178 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
		_tmp67_ = size;
#line 178 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
		_tmp68_ = size;
#line 178 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
		_tmp69_ = plank_drawing_service_ar_scale (_tmp66_, _tmp67_, _tmp68_);
#line 178 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
		_g_object_unref0 (image);
#line 178 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
		image = _tmp69_;
#line 1098 "Utils.c"
	}
#line 183 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	_tmp70_ = not_cached;
#line 183 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	if (_tmp70_) {
#line 1104 "Utils.c"
		GHashTable* _tmp71_ = NULL;
		const gchar* _tmp72_ = NULL;
		gchar* _tmp73_ = NULL;
		GdkPixbuf* _tmp74_ = NULL;
		GdkPixbuf* _tmp75_ = NULL;
#line 184 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
		_tmp71_ = gala_utils_icon_pixbuf_cache;
#line 184 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
		_tmp72_ = icon_key;
#line 184 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
		_tmp73_ = g_strdup (_tmp72_);
#line 184 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
		_tmp74_ = image;
#line 184 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
		_tmp75_ = _g_object_ref0 (_tmp74_);
#line 184 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
		g_hash_table_insert (_tmp71_, _tmp73_, _tmp75_);
#line 1122 "Utils.c"
	}
#line 186 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	result = image;
#line 186 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	_g_free0 (icon_key);
#line 186 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	_g_free0 (icon);
#line 186 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	return result;
#line 1132 "Utils.c"
}


/**
 * Get the next window that should be active on a workspace right now. Based on
 * stacking order
 *
 * @param workspace The workspace on which to find the window
 * @param backward  Whether to get the previous one instead
 */
MetaWindow* gala_utils_get_next_window (MetaWorkspace* workspace, gboolean backward) {
	MetaWindow* result = NULL;
	MetaScreen* screen = NULL;
	MetaWorkspace* _tmp0_ = NULL;
	MetaScreen* _tmp1_ = NULL;
	MetaScreen* _tmp2_ = NULL;
	MetaDisplay* display = NULL;
	MetaScreen* _tmp3_ = NULL;
	MetaDisplay* _tmp4_ = NULL;
	MetaDisplay* _tmp5_ = NULL;
	MetaWindow* window = NULL;
	MetaDisplay* _tmp6_ = NULL;
	MetaWorkspace* _tmp7_ = NULL;
	gboolean _tmp8_ = FALSE;
	MetaWindow* _tmp9_ = NULL;
	MetaWindow* _tmp10_ = NULL;
	MetaWindow* _tmp11_ = NULL;
#line 196 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	g_return_val_if_fail (workspace != NULL, NULL);
#line 198 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	_tmp0_ = workspace;
#line 198 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	_tmp1_ = meta_workspace_get_screen (_tmp0_);
#line 198 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	_tmp2_ = _g_object_ref0 (_tmp1_);
#line 198 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	screen = _tmp2_;
#line 199 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	_tmp3_ = screen;
#line 199 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	_tmp4_ = meta_screen_get_display (_tmp3_);
#line 199 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	_tmp5_ = _g_object_ref0 (_tmp4_);
#line 199 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	display = _tmp5_;
#line 201 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	_tmp6_ = display;
#line 201 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	_tmp7_ = workspace;
#line 201 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	_tmp8_ = backward;
#line 201 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	_tmp9_ = meta_display_get_tab_next (_tmp6_, META_TAB_LIST_NORMAL, _tmp7_, NULL, _tmp8_);
#line 201 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	_tmp10_ = _g_object_ref0 (_tmp9_);
#line 201 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	window = _tmp10_;
#line 204 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	_tmp11_ = window;
#line 204 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	if (_tmp11_ == NULL) {
#line 1194 "Utils.c"
		MetaDisplay* _tmp12_ = NULL;
		MetaWorkspace* _tmp13_ = NULL;
		MetaWindow* _tmp14_ = NULL;
		MetaWindow* _tmp15_ = NULL;
#line 205 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
		_tmp12_ = display;
#line 205 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
		_tmp13_ = workspace;
#line 205 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
		_tmp14_ = meta_display_get_tab_current (_tmp12_, META_TAB_LIST_NORMAL, _tmp13_);
#line 205 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
		_tmp15_ = _g_object_ref0 (_tmp14_);
#line 205 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
		_g_object_unref0 (window);
#line 205 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
		window = _tmp15_;
#line 1211 "Utils.c"
	}
#line 207 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	result = window;
#line 207 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	_g_object_unref0 (display);
#line 207 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	_g_object_unref0 (screen);
#line 207 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	return result;
#line 1221 "Utils.c"
}


/**
 * Get the number of toplevel windows on a workspace excluding those that are
 * on all workspaces
 *
 * @param workspace The workspace on which to count the windows
 */
guint gala_utils_get_n_windows (MetaWorkspace* workspace) {
	guint result = 0U;
	gint n = 0;
	MetaWorkspace* _tmp0_ = NULL;
	GList* _tmp1_ = NULL;
#line 216 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	g_return_val_if_fail (workspace != NULL, 0U);
#line 218 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	n = 0;
#line 219 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	_tmp0_ = workspace;
#line 219 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	_tmp1_ = meta_workspace_list_windows (_tmp0_);
#line 1244 "Utils.c"
	{
		GList* window_collection = NULL;
		GList* window_it = NULL;
#line 219 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
		window_collection = _tmp1_;
#line 219 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
		for (window_it = window_collection; window_it != NULL; window_it = window_it->next) {
#line 1252 "Utils.c"
			MetaWindow* window = NULL;
#line 219 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
			window = (MetaWindow*) window_it->data;
#line 1256 "Utils.c"
			{
				MetaWindow* _tmp2_ = NULL;
				gboolean _tmp3_ = FALSE;
				gboolean _tmp4_ = FALSE;
				gboolean _tmp5_ = FALSE;
				MetaWindow* _tmp6_ = NULL;
				MetaWindowType _tmp7_ = 0;
				MetaWindowType _tmp8_ = 0;
#line 220 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
				_tmp2_ = window;
#line 220 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
				_tmp3_ = meta_window_is_on_all_workspaces (_tmp2_);
#line 220 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
				if (_tmp3_) {
#line 221 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
					continue;
#line 1273 "Utils.c"
				}
#line 222 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
				_tmp6_ = window;
#line 222 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
				_tmp7_ = meta_window_get_window_type (_tmp6_);
#line 222 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
				_tmp8_ = _tmp7_;
#line 222 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
				if (_tmp8_ == META_WINDOW_NORMAL) {
#line 222 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
					_tmp5_ = TRUE;
#line 1285 "Utils.c"
				} else {
					MetaWindow* _tmp9_ = NULL;
					MetaWindowType _tmp10_ = 0;
					MetaWindowType _tmp11_ = 0;
#line 223 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
					_tmp9_ = window;
#line 223 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
					_tmp10_ = meta_window_get_window_type (_tmp9_);
#line 223 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
					_tmp11_ = _tmp10_;
#line 223 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
					_tmp5_ = _tmp11_ == META_WINDOW_DIALOG;
#line 1298 "Utils.c"
				}
#line 222 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
				if (_tmp5_) {
#line 222 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
					_tmp4_ = TRUE;
#line 1304 "Utils.c"
				} else {
					MetaWindow* _tmp12_ = NULL;
					MetaWindowType _tmp13_ = 0;
					MetaWindowType _tmp14_ = 0;
#line 224 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
					_tmp12_ = window;
#line 224 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
					_tmp13_ = meta_window_get_window_type (_tmp12_);
#line 224 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
					_tmp14_ = _tmp13_;
#line 224 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
					_tmp4_ = _tmp14_ == META_WINDOW_MODAL_DIALOG;
#line 1317 "Utils.c"
				}
#line 222 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
				if (_tmp4_) {
#line 1321 "Utils.c"
					gint _tmp15_ = 0;
#line 225 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
					_tmp15_ = n;
#line 225 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
					n = _tmp15_ + 1;
#line 1327 "Utils.c"
				}
			}
		}
#line 219 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
		_g_list_free0 (window_collection);
#line 1333 "Utils.c"
	}
#line 228 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	result = (guint) n;
#line 228 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	return result;
#line 1339 "Utils.c"
}


/**
 * Creates an actor showing the current contents of the given WindowActor.
 *
 * @param actor 	 The actor from which to create a shnapshot
 * @param inner_rect The inner (actually visible) rectangle of the window
 * @param outer_rect The outer (input region) rectangle of the window
 *
 * @return           A copy of the actor at that time or %NULL
 */
static Block2Data* block2_data_ref (Block2Data* _data2_) {
#line 240 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	g_atomic_int_inc (&_data2_->_ref_count_);
#line 240 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	return _data2_;
#line 1357 "Utils.c"
}


static void block2_data_unref (void * _userdata_) {
	Block2Data* _data2_;
	_data2_ = (Block2Data*) _userdata_;
#line 240 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	if (g_atomic_int_dec_and_test (&_data2_->_ref_count_)) {
#line 240 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
		_cairo_surface_destroy0 (_data2_->surface);
#line 240 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
		g_slice_free (Block2Data, _data2_);
#line 1370 "Utils.c"
	}
}


static gboolean __lambda7_ (Block2Data* _data2_, cairo_t* cr) {
	gboolean result = FALSE;
	cairo_t* _tmp0_ = NULL;
	cairo_surface_t* _tmp1_ = NULL;
	cairo_t* _tmp2_ = NULL;
#line 258 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	g_return_val_if_fail (cr != NULL, FALSE);
#line 259 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	_tmp0_ = cr;
#line 259 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	_tmp1_ = _data2_->surface;
#line 259 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	cairo_set_source_surface (_tmp0_, _tmp1_, (gdouble) 0, (gdouble) 0);
#line 260 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	_tmp2_ = cr;
#line 260 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	cairo_paint (_tmp2_);
#line 261 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	result = FALSE;
#line 261 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	return result;
#line 1396 "Utils.c"
}


static gboolean ___lambda7__clutter_canvas_draw (ClutterCanvas* _sender, cairo_t* cr, gint width, gint height, gpointer self) {
	gboolean result;
	result = __lambda7_ (self, cr);
#line 258 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	return result;
#line 1405 "Utils.c"
}


ClutterActor* gala_utils_get_window_actor_snapshot (MetaWindowActor* actor, MetaRectangle* inner_rect, MetaRectangle* outer_rect) {
	ClutterActor* result = NULL;
	Block2Data* _data2_;
	MetaShapedTexture* texture = NULL;
	MetaWindowActor* _tmp0_ = NULL;
	ClutterActor* _tmp1_ = NULL;
	MetaShapedTexture* _tmp2_ = NULL;
	MetaShapedTexture* _tmp3_ = NULL;
	MetaShapedTexture* _tmp4_ = NULL;
	MetaRectangle _tmp5_ = {0};
	gint _tmp6_ = 0;
	MetaRectangle _tmp7_ = {0};
	gint _tmp8_ = 0;
	MetaRectangle _tmp9_ = {0};
	gint _tmp10_ = 0;
	MetaRectangle _tmp11_ = {0};
	gint _tmp12_ = 0;
	MetaRectangle _tmp13_ = {0};
	gint _tmp14_ = 0;
	MetaRectangle _tmp15_ = {0};
	gint _tmp16_ = 0;
	cairo_rectangle_int_t _tmp17_ = {0};
	cairo_surface_t* _tmp18_ = NULL;
	cairo_surface_t* _tmp19_ = NULL;
	ClutterCanvas* canvas = NULL;
	ClutterCanvas* _tmp20_ = NULL;
	gulong handler = 0UL;
	ClutterCanvas* _tmp21_ = NULL;
	gulong _tmp22_ = 0UL;
	ClutterCanvas* _tmp23_ = NULL;
	MetaRectangle _tmp24_ = {0};
	gint _tmp25_ = 0;
	MetaRectangle _tmp26_ = {0};
	gint _tmp27_ = 0;
	ClutterCanvas* _tmp28_ = NULL;
	gulong _tmp29_ = 0UL;
	ClutterActor* container = NULL;
	ClutterActor* _tmp30_ = NULL;
	ClutterActor* _tmp31_ = NULL;
	MetaRectangle _tmp32_ = {0};
	gint _tmp33_ = 0;
	MetaRectangle _tmp34_ = {0};
	gint _tmp35_ = 0;
	ClutterActor* _tmp36_ = NULL;
	ClutterCanvas* _tmp37_ = NULL;
#line 240 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	g_return_val_if_fail (actor != NULL, NULL);
#line 240 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	g_return_val_if_fail (inner_rect != NULL, NULL);
#line 240 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	g_return_val_if_fail (outer_rect != NULL, NULL);
#line 240 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	_data2_ = g_slice_new0 (Block2Data);
#line 240 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	_data2_->_ref_count_ = 1;
#line 242 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	_tmp0_ = actor;
#line 242 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	_tmp1_ = meta_window_actor_get_texture (_tmp0_);
#line 242 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	_tmp2_ = _g_object_ref0 (G_TYPE_CHECK_INSTANCE_TYPE (_tmp1_, meta_shaped_texture_get_type ()) ? ((MetaShapedTexture*) _tmp1_) : NULL);
#line 242 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	texture = _tmp2_;
#line 244 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	_tmp3_ = texture;
#line 244 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	if (_tmp3_ == NULL) {
#line 245 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
		result = NULL;
#line 245 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
		_g_object_unref0 (texture);
#line 245 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
		block2_data_unref (_data2_);
#line 245 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
		_data2_ = NULL;
#line 245 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
		return result;
#line 1486 "Utils.c"
	}
#line 247 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	_tmp4_ = texture;
#line 247 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	_tmp5_ = *inner_rect;
#line 247 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	_tmp6_ = _tmp5_.x;
#line 247 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	_tmp7_ = *outer_rect;
#line 247 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	_tmp8_ = _tmp7_.x;
#line 247 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	_tmp9_ = *inner_rect;
#line 247 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	_tmp10_ = _tmp9_.y;
#line 247 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	_tmp11_ = *outer_rect;
#line 247 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	_tmp12_ = _tmp11_.y;
#line 247 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	_tmp13_ = *inner_rect;
#line 247 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	_tmp14_ = _tmp13_.width;
#line 247 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	_tmp15_ = *inner_rect;
#line 247 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	_tmp16_ = _tmp15_.height;
#line 247 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	_tmp17_.x = _tmp6_ - _tmp8_;
#line 247 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	_tmp17_.y = _tmp10_ - _tmp12_;
#line 247 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	_tmp17_.width = _tmp14_;
#line 247 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	_tmp17_.height = _tmp16_;
#line 247 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	_tmp18_ = meta_shaped_texture_get_image (_tmp4_, &_tmp17_);
#line 247 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	_data2_->surface = _tmp18_;
#line 254 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	_tmp19_ = _data2_->surface;
#line 254 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	if (_tmp19_ == NULL) {
#line 255 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
		result = NULL;
#line 255 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
		_g_object_unref0 (texture);
#line 255 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
		block2_data_unref (_data2_);
#line 255 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
		_data2_ = NULL;
#line 255 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
		return result;
#line 1540 "Utils.c"
	}
#line 257 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	_tmp20_ = clutter_canvas_new ();
#line 257 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	canvas = _tmp20_;
#line 258 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	_tmp21_ = canvas;
#line 258 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	_tmp22_ = g_signal_connect_data (_tmp21_, "draw", (GCallback) ___lambda7__clutter_canvas_draw, block2_data_ref (_data2_), (GClosureNotify) block2_data_unref, 0);
#line 258 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	handler = _tmp22_;
#line 263 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	_tmp23_ = canvas;
#line 263 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	_tmp24_ = *inner_rect;
#line 263 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	_tmp25_ = _tmp24_.width;
#line 263 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	_tmp26_ = *inner_rect;
#line 263 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	_tmp27_ = _tmp26_.height;
#line 263 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	clutter_canvas_set_size (_tmp23_, _tmp25_, _tmp27_);
#line 264 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	_tmp28_ = canvas;
#line 264 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	_tmp29_ = handler;
#line 264 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	g_signal_handler_disconnect (_tmp28_, _tmp29_);
#line 266 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	_tmp30_ = clutter_actor_new ();
#line 266 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	g_object_ref_sink (_tmp30_);
#line 266 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	container = _tmp30_;
#line 267 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	_tmp31_ = container;
#line 267 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	_tmp32_ = *inner_rect;
#line 267 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	_tmp33_ = _tmp32_.width;
#line 267 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	_tmp34_ = *inner_rect;
#line 267 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	_tmp35_ = _tmp34_.height;
#line 267 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	clutter_actor_set_size (_tmp31_, (gfloat) _tmp33_, (gfloat) _tmp35_);
#line 268 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	_tmp36_ = container;
#line 268 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	_tmp37_ = canvas;
#line 268 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	clutter_actor_set_content (_tmp36_, (ClutterContent*) _tmp37_);
#line 270 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	result = container;
#line 270 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	_g_object_unref0 (canvas);
#line 270 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	_g_object_unref0 (texture);
#line 270 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	block2_data_unref (_data2_);
#line 270 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	_data2_ = NULL;
#line 270 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	return result;
#line 1606 "Utils.c"
}


/**
 * Ring the system bell, will most likely emit a <beep> error sound or, if the
 * audible bell is disabled, flash the screen
 *
 * @param screen The screen to flash, if necessary
 */
void gala_utils_bell (MetaScreen* screen) {
	gboolean _tmp0_ = FALSE;
#line 279 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	g_return_if_fail (screen != NULL);
#line 281 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	_tmp0_ = meta_prefs_bell_is_audible ();
#line 281 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	if (_tmp0_) {
#line 282 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
		gdk_beep ();
#line 1626 "Utils.c"
	} else {
		MetaScreen* _tmp1_ = NULL;
		MetaDisplay* _tmp2_ = NULL;
		MetaCompositor* _tmp3_ = NULL;
		MetaScreen* _tmp4_ = NULL;
#line 284 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
		_tmp1_ = screen;
#line 284 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
		_tmp2_ = meta_screen_get_display (_tmp1_);
#line 284 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
		_tmp3_ = meta_display_get_compositor (_tmp2_);
#line 284 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
		_tmp4_ = screen;
#line 284 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
		meta_compositor_flash_screen (_tmp3_, _tmp4_);
#line 1642 "Utils.c"
	}
}


/**
 * Returns the pixbuf that is used for close buttons throughout gala at a
 * size of 36px
 *
 * @return the close button pixbuf or null if it failed to load
 */
GdkPixbuf* gala_utils_get_close_button_pixbuf (void) {
	GdkPixbuf* result = NULL;
	GdkPixbuf* _tmp0_ = NULL;
	GdkPixbuf* _tmp6_ = NULL;
	GdkPixbuf* _tmp7_ = NULL;
	GError * _inner_error_ = NULL;
#line 295 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	_tmp0_ = gala_utils_close_pixbuf;
#line 295 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	if (_tmp0_ == NULL) {
#line 1663 "Utils.c"
		{
			GdkPixbuf* _tmp1_ = NULL;
			GdkPixbuf* _tmp2_ = NULL;
			GdkPixbuf* _tmp3_ = NULL;
#line 297 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
			_tmp2_ = gdk_pixbuf_new_from_file_at_scale (PKGDATADIR "/close.svg", -1, 36, TRUE, &_inner_error_);
#line 297 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
			_tmp1_ = _tmp2_;
#line 297 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
			if (G_UNLIKELY (_inner_error_ != NULL)) {
#line 1674 "Utils.c"
				goto __catch1_g_error;
			}
#line 297 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
			_tmp3_ = _tmp1_;
#line 297 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
			_tmp1_ = NULL;
#line 297 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
			_g_object_unref0 (gala_utils_close_pixbuf);
#line 297 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
			gala_utils_close_pixbuf = _tmp3_;
#line 296 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
			_g_object_unref0 (_tmp1_);
#line 1687 "Utils.c"
		}
		goto __finally1;
		__catch1_g_error:
		{
			GError* e = NULL;
			GError* _tmp4_ = NULL;
			const gchar* _tmp5_ = NULL;
#line 296 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
			e = _inner_error_;
#line 296 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
			_inner_error_ = NULL;
#line 299 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
			_tmp4_ = e;
#line 299 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
			_tmp5_ = _tmp4_->message;
#line 299 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
			g_warning ("Utils.vala:299: %s", _tmp5_);
#line 300 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
			result = NULL;
#line 300 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
			_g_error_free0 (e);
#line 300 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
			return result;
#line 1711 "Utils.c"
		}
		__finally1:
#line 296 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
		if (G_UNLIKELY (_inner_error_ != NULL)) {
#line 296 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
			g_critical ("file %s: line %d: uncaught error: %s (%s, %d)", __FILE__, __LINE__, _inner_error_->message, g_quark_to_string (_inner_error_->domain), _inner_error_->code);
#line 296 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
			g_clear_error (&_inner_error_);
#line 296 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
			return NULL;
#line 1722 "Utils.c"
		}
	}
#line 304 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	_tmp6_ = gala_utils_close_pixbuf;
#line 304 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	_tmp7_ = _g_object_ref0 (_tmp6_);
#line 304 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	result = _tmp7_;
#line 304 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	return result;
#line 1733 "Utils.c"
}


/**
 * Creates a new reactive ClutterActor at 36px with the close pixbuf
 *
 * @return The close button actor
 */
ClutterActor* gala_utils_create_close_button (void) {
	ClutterActor* result = NULL;
	ClutterTexture* texture = NULL;
	ClutterTexture* _tmp0_ = NULL;
	GdkPixbuf* pixbuf = NULL;
	GdkPixbuf* _tmp1_ = NULL;
	ClutterTexture* _tmp2_ = NULL;
	GdkPixbuf* _tmp3_ = NULL;
	GError * _inner_error_ = NULL;
#line 314 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	_tmp0_ = (ClutterTexture*) clutter_texture_new ();
#line 314 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	g_object_ref_sink (_tmp0_);
#line 314 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	texture = _tmp0_;
#line 315 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	_tmp1_ = gala_utils_get_close_button_pixbuf ();
#line 315 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	pixbuf = _tmp1_;
#line 317 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	_tmp2_ = texture;
#line 317 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	clutter_actor_set_reactive ((ClutterActor*) _tmp2_, TRUE);
#line 319 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	_tmp3_ = pixbuf;
#line 319 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	if (_tmp3_ != NULL) {
#line 1769 "Utils.c"
		{
			gint _tmp4_ = 0;
			GdkPixbuf* _tmp5_ = NULL;
			gboolean _tmp6_ = FALSE;
			ClutterTexture* _tmp7_ = NULL;
			GdkPixbuf* _tmp8_ = NULL;
			guint8* _tmp9_ = NULL;
			GdkPixbuf* _tmp10_ = NULL;
			gboolean _tmp11_ = FALSE;
			GdkPixbuf* _tmp12_ = NULL;
			gint _tmp13_ = 0;
			GdkPixbuf* _tmp14_ = NULL;
			gint _tmp15_ = 0;
			GdkPixbuf* _tmp16_ = NULL;
			gint _tmp17_ = 0;
#line 323 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
			_tmp5_ = pixbuf;
#line 323 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
			_tmp6_ = gdk_pixbuf_get_has_alpha (_tmp5_);
#line 323 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
			if (_tmp6_) {
#line 323 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
				_tmp4_ = 4;
#line 1793 "Utils.c"
			} else {
#line 323 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
				_tmp4_ = 3;
#line 1797 "Utils.c"
			}
#line 321 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
			_tmp7_ = texture;
#line 321 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
			_tmp8_ = pixbuf;
#line 321 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
			_tmp9_ = gdk_pixbuf_get_pixels (_tmp8_);
#line 321 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
			_tmp10_ = pixbuf;
#line 321 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
			_tmp11_ = gdk_pixbuf_get_has_alpha (_tmp10_);
#line 321 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
			_tmp12_ = pixbuf;
#line 321 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
			_tmp13_ = gdk_pixbuf_get_width (_tmp12_);
#line 321 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
			_tmp14_ = pixbuf;
#line 321 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
			_tmp15_ = gdk_pixbuf_get_height (_tmp14_);
#line 321 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
			_tmp16_ = pixbuf;
#line 321 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
			_tmp17_ = gdk_pixbuf_get_rowstride (_tmp16_);
#line 321 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
			clutter_texture_set_from_rgb_data (_tmp7_, _tmp9_, _tmp11_, _tmp13_, _tmp15_, _tmp17_, _tmp4_, 0, &_inner_error_);
#line 321 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
			if (G_UNLIKELY (_inner_error_ != NULL)) {
#line 1825 "Utils.c"
				goto __catch2_g_error;
			}
		}
		goto __finally2;
		__catch2_g_error:
		{
			GError* e = NULL;
#line 320 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
			e = _inner_error_;
#line 320 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
			_inner_error_ = NULL;
#line 320 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
			_g_error_free0 (e);
#line 1839 "Utils.c"
		}
		__finally2:
#line 320 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
		if (G_UNLIKELY (_inner_error_ != NULL)) {
#line 320 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
			_g_object_unref0 (pixbuf);
#line 320 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
			_g_object_unref0 (texture);
#line 320 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
			g_critical ("file %s: line %d: uncaught error: %s (%s, %d)", __FILE__, __LINE__, _inner_error_->message, g_quark_to_string (_inner_error_->domain), _inner_error_->code);
#line 320 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
			g_clear_error (&_inner_error_);
#line 320 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
			return NULL;
#line 1854 "Utils.c"
		}
	} else {
		ClutterTexture* _tmp18_ = NULL;
		ClutterTexture* _tmp19_ = NULL;
		ClutterColor _tmp20_ = {0};
#line 329 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
		_tmp18_ = texture;
#line 329 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
		clutter_actor_set_size ((ClutterActor*) _tmp18_, (gfloat) 36, (gfloat) 36);
#line 330 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
		_tmp19_ = texture;
#line 330 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
		_tmp20_.red = (guint8) 255;
#line 330 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
		_tmp20_.green = (guint8) 0;
#line 330 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
		_tmp20_.blue = (guint8) 0;
#line 330 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
		_tmp20_.alpha = (guint8) 255;
#line 330 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
		clutter_actor_set_background_color ((ClutterActor*) _tmp19_, &_tmp20_);
#line 1876 "Utils.c"
	}
#line 333 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	result = (ClutterActor*) texture;
#line 333 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	_g_object_unref0 (pixbuf);
#line 333 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	return result;
#line 1884 "Utils.c"
}


static void _g_free0_ (gpointer var) {
#line 31 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	var = (g_free (var), NULL);
#line 1891 "Utils.c"
}


static void _g_object_unref0_ (gpointer var) {
#line 31 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	(var == NULL) ? NULL : (var = (g_object_unref (var), NULL));
#line 1898 "Utils.c"
}


static void gala_value_utils_init (GValue* value) {
#line 20 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	value->data[0].v_pointer = NULL;
#line 1905 "Utils.c"
}


static void gala_value_utils_free_value (GValue* value) {
#line 20 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	if (value->data[0].v_pointer) {
#line 20 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
		gala_utils_unref (value->data[0].v_pointer);
#line 1914 "Utils.c"
	}
}


static void gala_value_utils_copy_value (const GValue* src_value, GValue* dest_value) {
#line 20 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	if (src_value->data[0].v_pointer) {
#line 20 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
		dest_value->data[0].v_pointer = gala_utils_ref (src_value->data[0].v_pointer);
#line 1924 "Utils.c"
	} else {
#line 20 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
		dest_value->data[0].v_pointer = NULL;
#line 1928 "Utils.c"
	}
}


static gpointer gala_value_utils_peek_pointer (const GValue* value) {
#line 20 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	return value->data[0].v_pointer;
#line 1936 "Utils.c"
}


static gchar* gala_value_utils_collect_value (GValue* value, guint n_collect_values, GTypeCValue* collect_values, guint collect_flags) {
#line 20 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	if (collect_values[0].v_pointer) {
#line 1943 "Utils.c"
		GalaUtils* object;
		object = collect_values[0].v_pointer;
#line 20 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
		if (object->parent_instance.g_class == NULL) {
#line 20 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
			return g_strconcat ("invalid unclassed object pointer for value type `", G_VALUE_TYPE_NAME (value), "'", NULL);
#line 1950 "Utils.c"
		} else if (!g_value_type_compatible (G_TYPE_FROM_INSTANCE (object), G_VALUE_TYPE (value))) {
#line 20 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
			return g_strconcat ("invalid object type `", g_type_name (G_TYPE_FROM_INSTANCE (object)), "' for value type `", G_VALUE_TYPE_NAME (value), "'", NULL);
#line 1954 "Utils.c"
		}
#line 20 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
		value->data[0].v_pointer = gala_utils_ref (object);
#line 1958 "Utils.c"
	} else {
#line 20 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
		value->data[0].v_pointer = NULL;
#line 1962 "Utils.c"
	}
#line 20 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	return NULL;
#line 1966 "Utils.c"
}


static gchar* gala_value_utils_lcopy_value (const GValue* value, guint n_collect_values, GTypeCValue* collect_values, guint collect_flags) {
	GalaUtils** object_p;
	object_p = collect_values[0].v_pointer;
#line 20 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	if (!object_p) {
#line 20 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
		return g_strdup_printf ("value location for `%s' passed as NULL", G_VALUE_TYPE_NAME (value));
#line 1977 "Utils.c"
	}
#line 20 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	if (!value->data[0].v_pointer) {
#line 20 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
		*object_p = NULL;
#line 1983 "Utils.c"
	} else if (collect_flags & G_VALUE_NOCOPY_CONTENTS) {
#line 20 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
		*object_p = value->data[0].v_pointer;
#line 1987 "Utils.c"
	} else {
#line 20 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
		*object_p = gala_utils_ref (value->data[0].v_pointer);
#line 1991 "Utils.c"
	}
#line 20 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	return NULL;
#line 1995 "Utils.c"
}


GParamSpec* gala_param_spec_utils (const gchar* name, const gchar* nick, const gchar* blurb, GType object_type, GParamFlags flags) {
	GalaParamSpecUtils* spec;
#line 20 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	g_return_val_if_fail (g_type_is_a (object_type, GALA_TYPE_UTILS), NULL);
#line 20 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	spec = g_param_spec_internal (G_TYPE_PARAM_OBJECT, name, nick, blurb, flags);
#line 20 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	G_PARAM_SPEC (spec)->value_type = object_type;
#line 20 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	return G_PARAM_SPEC (spec);
#line 2009 "Utils.c"
}


gpointer gala_value_get_utils (const GValue* value) {
#line 20 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	g_return_val_if_fail (G_TYPE_CHECK_VALUE_TYPE (value, GALA_TYPE_UTILS), NULL);
#line 20 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	return value->data[0].v_pointer;
#line 2018 "Utils.c"
}


void gala_value_set_utils (GValue* value, gpointer v_object) {
	GalaUtils* old;
#line 20 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	g_return_if_fail (G_TYPE_CHECK_VALUE_TYPE (value, GALA_TYPE_UTILS));
#line 20 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	old = value->data[0].v_pointer;
#line 20 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	if (v_object) {
#line 20 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
		g_return_if_fail (G_TYPE_CHECK_INSTANCE_TYPE (v_object, GALA_TYPE_UTILS));
#line 20 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
		g_return_if_fail (g_value_type_compatible (G_TYPE_FROM_INSTANCE (v_object), G_VALUE_TYPE (value)));
#line 20 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
		value->data[0].v_pointer = v_object;
#line 20 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
		gala_utils_ref (value->data[0].v_pointer);
#line 2038 "Utils.c"
	} else {
#line 20 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
		value->data[0].v_pointer = NULL;
#line 2042 "Utils.c"
	}
#line 20 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	if (old) {
#line 20 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
		gala_utils_unref (old);
#line 2048 "Utils.c"
	}
}


void gala_value_take_utils (GValue* value, gpointer v_object) {
	GalaUtils* old;
#line 20 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	g_return_if_fail (G_TYPE_CHECK_VALUE_TYPE (value, GALA_TYPE_UTILS));
#line 20 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	old = value->data[0].v_pointer;
#line 20 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	if (v_object) {
#line 20 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
		g_return_if_fail (G_TYPE_CHECK_INSTANCE_TYPE (v_object, GALA_TYPE_UTILS));
#line 20 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
		g_return_if_fail (g_value_type_compatible (G_TYPE_FROM_INSTANCE (v_object), G_VALUE_TYPE (value)));
#line 20 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
		value->data[0].v_pointer = v_object;
#line 2067 "Utils.c"
	} else {
#line 20 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
		value->data[0].v_pointer = NULL;
#line 2071 "Utils.c"
	}
#line 20 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	if (old) {
#line 20 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
		gala_utils_unref (old);
#line 2077 "Utils.c"
	}
}


static void gala_utils_class_init (GalaUtilsClass * klass) {
	GHashFunc _tmp0_ = NULL;
	GEqualFunc _tmp1_ = NULL;
	GHashTable* _tmp2_ = NULL;
	GHashFunc _tmp3_ = NULL;
	GEqualFunc _tmp4_ = NULL;
	GHashTable* _tmp5_ = NULL;
#line 20 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	gala_utils_parent_class = g_type_class_peek_parent (klass);
#line 20 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	((GalaUtilsClass *) klass)->finalize = gala_utils_finalize;
#line 31 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	_tmp0_ = g_str_hash;
#line 31 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	_tmp1_ = g_str_equal;
#line 31 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	_tmp2_ = g_hash_table_new_full (_tmp0_, _tmp1_, _g_free0_, _g_object_unref0_);
#line 31 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	_g_hash_table_unref0 (gala_utils_xid_pixbuf_cache);
#line 31 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	gala_utils_xid_pixbuf_cache = _tmp2_;
#line 32 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	_tmp3_ = g_str_hash;
#line 32 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	_tmp4_ = g_str_equal;
#line 32 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	_tmp5_ = g_hash_table_new_full (_tmp3_, _tmp4_, _g_free0_, _g_object_unref0_);
#line 32 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	_g_hash_table_unref0 (gala_utils_icon_pixbuf_cache);
#line 32 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	gala_utils_icon_pixbuf_cache = _tmp5_;
#line 2113 "Utils.c"
}


static void gala_utils_instance_init (GalaUtils * self) {
#line 20 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	self->ref_count = 1;
#line 2120 "Utils.c"
}


static void gala_utils_finalize (GalaUtils* obj) {
	GalaUtils * self;
#line 20 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	self = G_TYPE_CHECK_INSTANCE_CAST (obj, GALA_TYPE_UTILS, GalaUtils);
#line 20 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	g_signal_handlers_destroy (self);
#line 2130 "Utils.c"
}


GType gala_utils_get_type (void) {
	static volatile gsize gala_utils_type_id__volatile = 0;
	if (g_once_init_enter (&gala_utils_type_id__volatile)) {
		static const GTypeValueTable g_define_type_value_table = { gala_value_utils_init, gala_value_utils_free_value, gala_value_utils_copy_value, gala_value_utils_peek_pointer, "p", gala_value_utils_collect_value, "p", gala_value_utils_lcopy_value };
		static const GTypeInfo g_define_type_info = { sizeof (GalaUtilsClass), (GBaseInitFunc) NULL, (GBaseFinalizeFunc) NULL, (GClassInitFunc) gala_utils_class_init, (GClassFinalizeFunc) NULL, NULL, sizeof (GalaUtils), 0, (GInstanceInitFunc) gala_utils_instance_init, &g_define_type_value_table };
		static const GTypeFundamentalInfo g_define_type_fundamental_info = { (G_TYPE_FLAG_CLASSED | G_TYPE_FLAG_INSTANTIATABLE | G_TYPE_FLAG_DERIVABLE | G_TYPE_FLAG_DEEP_DERIVABLE) };
		GType gala_utils_type_id;
		gala_utils_type_id = g_type_register_fundamental (g_type_fundamental_next (), "GalaUtils", &g_define_type_info, &g_define_type_fundamental_info, 0);
		g_once_init_leave (&gala_utils_type_id__volatile, gala_utils_type_id);
	}
	return gala_utils_type_id__volatile;
}


gpointer gala_utils_ref (gpointer instance) {
	GalaUtils* self;
	self = instance;
#line 20 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	g_atomic_int_inc (&self->ref_count);
#line 20 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	return instance;
#line 2155 "Utils.c"
}


void gala_utils_unref (gpointer instance) {
	GalaUtils* self;
	self = instance;
#line 20 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
	if (g_atomic_int_dec_and_test (&self->ref_count)) {
#line 20 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
		GALA_UTILS_GET_CLASS (self)->finalize (self);
#line 20 "/home/nick/work/Enso-OS/galal/lib/Utils.vala"
		g_type_free_instance ((GTypeInstance *) self);
#line 2168 "Utils.c"
	}
}


static void _vala_array_destroy (gpointer array, gint array_length, GDestroyNotify destroy_func) {
	if ((array != NULL) && (destroy_func != NULL)) {
		int i;
		for (i = 0; i < array_length; i = i + 1) {
			if (((gpointer*) array)[i] != NULL) {
				destroy_func (((gpointer*) array)[i]);
			}
		}
	}
}


static void _vala_array_free (gpointer array, gint array_length, GDestroyNotify destroy_func) {
	_vala_array_destroy (array, array_length, destroy_func);
	g_free (array);
}


static gint _vala_array_length (gpointer array) {
	int length;
	length = 0;
	if (array) {
		while (((gpointer*) array)[length]) {
			length++;
		}
	}
	return length;
}



