/* Main.c generated by valac 0.30.1, the Vala compiler
 * generated from Main.vala, do not modify */

/**/
/*  Copyright (C) 2015 Rory J Sanderson*/
/**/
/*  This program is free software: you can redistribute it and/or modify*/
/*  it under the terms of the GNU General Public License as published by*/
/*  the Free Software Foundation, either version 3 of the License, or*/
/*  (at your option) any later version.*/
/**/
/*  This program is distributed in the hope that it will be useful,*/
/*  but WITHOUT ANY WARRANTY; without even the implied warranty of*/
/*  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the*/
/*  GNU General Public License for more details.*/
/**/
/*  You should have received a copy of the GNU General Public License*/
/*  along with this program.  If not, see <http://www.gnu.org/licenses/>.*/
/**/

#include <glib.h>
#include <glib-object.h>
#include "gala.h"
#include <meta/screen.h>
#include <granite.h>
#include <clutter/clutter.h>
#include <meta/meta-plugin.h>
#include <meta/boxes.h>
#include <cairo.h>
#include <float.h>
#include <math.h>


#define GALA_PLUGINS_MASK_CORNERS_TYPE_MAIN (gala_plugins_mask_corners_main_get_type ())
#define GALA_PLUGINS_MASK_CORNERS_MAIN(obj) (G_TYPE_CHECK_INSTANCE_CAST ((obj), GALA_PLUGINS_MASK_CORNERS_TYPE_MAIN, GalaPluginsMaskCornersMain))
#define GALA_PLUGINS_MASK_CORNERS_MAIN_CLASS(klass) (G_TYPE_CHECK_CLASS_CAST ((klass), GALA_PLUGINS_MASK_CORNERS_TYPE_MAIN, GalaPluginsMaskCornersMainClass))
#define GALA_PLUGINS_MASK_CORNERS_IS_MAIN(obj) (G_TYPE_CHECK_INSTANCE_TYPE ((obj), GALA_PLUGINS_MASK_CORNERS_TYPE_MAIN))
#define GALA_PLUGINS_MASK_CORNERS_IS_MAIN_CLASS(klass) (G_TYPE_CHECK_CLASS_TYPE ((klass), GALA_PLUGINS_MASK_CORNERS_TYPE_MAIN))
#define GALA_PLUGINS_MASK_CORNERS_MAIN_GET_CLASS(obj) (G_TYPE_INSTANCE_GET_CLASS ((obj), GALA_PLUGINS_MASK_CORNERS_TYPE_MAIN, GalaPluginsMaskCornersMainClass))

typedef struct _GalaPluginsMaskCornersMain GalaPluginsMaskCornersMain;
typedef struct _GalaPluginsMaskCornersMainClass GalaPluginsMaskCornersMainClass;
typedef struct _GalaPluginsMaskCornersMainPrivate GalaPluginsMaskCornersMainPrivate;

#define GALA_PLUGINS_MASK_CORNERS_TYPE_SETTINGS (gala_plugins_mask_corners_settings_get_type ())
#define GALA_PLUGINS_MASK_CORNERS_SETTINGS(obj) (G_TYPE_CHECK_INSTANCE_CAST ((obj), GALA_PLUGINS_MASK_CORNERS_TYPE_SETTINGS, GalaPluginsMaskCornersSettings))
#define GALA_PLUGINS_MASK_CORNERS_SETTINGS_CLASS(klass) (G_TYPE_CHECK_CLASS_CAST ((klass), GALA_PLUGINS_MASK_CORNERS_TYPE_SETTINGS, GalaPluginsMaskCornersSettingsClass))
#define GALA_PLUGINS_MASK_CORNERS_IS_SETTINGS(obj) (G_TYPE_CHECK_INSTANCE_TYPE ((obj), GALA_PLUGINS_MASK_CORNERS_TYPE_SETTINGS))
#define GALA_PLUGINS_MASK_CORNERS_IS_SETTINGS_CLASS(klass) (G_TYPE_CHECK_CLASS_TYPE ((klass), GALA_PLUGINS_MASK_CORNERS_TYPE_SETTINGS))
#define GALA_PLUGINS_MASK_CORNERS_SETTINGS_GET_CLASS(obj) (G_TYPE_INSTANCE_GET_CLASS ((obj), GALA_PLUGINS_MASK_CORNERS_TYPE_SETTINGS, GalaPluginsMaskCornersSettingsClass))

typedef struct _GalaPluginsMaskCornersSettings GalaPluginsMaskCornersSettings;
typedef struct _GalaPluginsMaskCornersSettingsClass GalaPluginsMaskCornersSettingsClass;
#define _g_object_unref0(var) ((var == NULL) ? NULL : (var = (g_object_unref (var), NULL)))
#define _cairo_destroy0(var) ((var == NULL) ? NULL : (var = (cairo_destroy (var), NULL)))
#define _g_free0(var) (var = (g_free (var), NULL))

struct _GalaPluginsMaskCornersMain {
	GalaPlugin parent_instance;
	GalaPluginsMaskCornersMainPrivate * priv;
};

struct _GalaPluginsMaskCornersMainClass {
	GalaPluginClass parent_class;
};

struct _GalaPluginsMaskCornersMainPrivate {
	GalaWindowManager* wm;
	MetaScreen* screen;
	GalaPluginsMaskCornersSettings* settings;
	GList** cornermasks;
	gint cornermasks_length1;
	gint _cornermasks_size_;
	gint corner_radius;
};


static gpointer gala_plugins_mask_corners_main_parent_class = NULL;

GType gala_plugins_mask_corners_main_get_type (void) G_GNUC_CONST;
GType gala_plugins_mask_corners_settings_get_type (void) G_GNUC_CONST;
#define GALA_PLUGINS_MASK_CORNERS_MAIN_GET_PRIVATE(o) (G_TYPE_INSTANCE_GET_PRIVATE ((o), GALA_PLUGINS_MASK_CORNERS_TYPE_MAIN, GalaPluginsMaskCornersMainPrivate))
enum  {
	GALA_PLUGINS_MASK_CORNERS_MAIN_DUMMY_PROPERTY
};
static void _g_object_unref0_ (gpointer var);
static void _g_list_free__g_object_unref0_ (GList* self);
static void gala_plugins_mask_corners_main_real_initialize (GalaPlugin* base, GalaWindowManager* wm);
GalaPluginsMaskCornersSettings* gala_plugins_mask_corners_settings_get_default (void);
static void gala_plugins_mask_corners_main_setup_cornermasks (GalaPluginsMaskCornersMain* self);
static void gala_plugins_mask_corners_main_resetup_cornermasks (GalaPluginsMaskCornersMain* self);
static void _gala_plugins_mask_corners_main_resetup_cornermasks_granite_services_settings_changed (GraniteServicesSettings* _sender, gpointer self);
static void gala_plugins_mask_corners_main_real_destroy (GalaPlugin* base);
static void gala_plugins_mask_corners_main_destroy_cornermasks (GalaPluginsMaskCornersMain* self);
gboolean gala_plugins_mask_corners_settings_get_enable (GalaPluginsMaskCornersSettings* self);
gint gala_plugins_mask_corners_settings_get_corner_radius (GalaPluginsMaskCornersSettings* self);
gboolean gala_plugins_mask_corners_settings_get_only_on_primary (GalaPluginsMaskCornersSettings* self);
static void gala_plugins_mask_corners_main_add_cornermasks (GalaPluginsMaskCornersMain* self, gint monitor_no);
gboolean gala_plugins_mask_corners_settings_get_disable_on_fullscreen (GalaPluginsMaskCornersSettings* self);
static void gala_plugins_mask_corners_main_fullscreen_changed (GalaPluginsMaskCornersMain* self);
static void _gala_plugins_mask_corners_main_fullscreen_changed_meta_screen_in_fullscreen_changed (MetaScreen* _sender, gpointer self);
static void _gala_plugins_mask_corners_main_resetup_cornermasks_meta_screen_monitors_changed (MetaScreen* _sender, gpointer self);
static gboolean gala_plugins_mask_corners_main_draw_cornermask (GalaPluginsMaskCornersMain* self, cairo_t* context);
static gboolean _gala_plugins_mask_corners_main_draw_cornermask_clutter_canvas_draw (ClutterCanvas* _sender, cairo_t* cr, gint width, gint height, gpointer self);
GalaPluginsMaskCornersMain* gala_plugins_mask_corners_main_new (void);
GalaPluginsMaskCornersMain* gala_plugins_mask_corners_main_construct (GType object_type);
static void gala_plugins_mask_corners_main_finalize (GObject* obj);
void register_plugin (GalaPluginInfo* result);
static void _vala_array_destroy (gpointer array, gint array_length, GDestroyNotify destroy_func);
static void _vala_array_free (gpointer array, gint array_length, GDestroyNotify destroy_func);


static void _g_object_unref0_ (gpointer var) {
#line 29 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
	(var == NULL) ? NULL : (var = (g_object_unref (var), NULL));
#line 117 "Main.c"
}


static void _g_list_free__g_object_unref0_ (GList* self) {
#line 29 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
	g_list_foreach (self, (GFunc) _g_object_unref0_, NULL);
#line 29 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
	g_list_free (self);
#line 126 "Main.c"
}


static gpointer _g_object_ref0 (gpointer self) {
#line 34 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
	return self ? g_object_ref (self) : NULL;
#line 133 "Main.c"
}


static void _gala_plugins_mask_corners_main_resetup_cornermasks_granite_services_settings_changed (GraniteServicesSettings* _sender, gpointer self) {
#line 40 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
	gala_plugins_mask_corners_main_resetup_cornermasks ((GalaPluginsMaskCornersMain*) self);
#line 140 "Main.c"
}


static void gala_plugins_mask_corners_main_real_initialize (GalaPlugin* base, GalaWindowManager* wm) {
	GalaPluginsMaskCornersMain * self;
	GalaWindowManager* _tmp0_ = NULL;
	GalaWindowManager* _tmp1_ = NULL;
	GalaWindowManager* _tmp2_ = NULL;
	MetaScreen* _tmp3_ = NULL;
	MetaScreen* _tmp4_ = NULL;
	GalaPluginsMaskCornersSettings* _tmp5_ = NULL;
	GalaPluginsMaskCornersSettings* _tmp6_ = NULL;
	GalaPluginsMaskCornersSettings* _tmp7_ = NULL;
#line 32 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
	self = (GalaPluginsMaskCornersMain*) base;
#line 32 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
	g_return_if_fail (wm != NULL);
#line 34 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
	_tmp0_ = wm;
#line 34 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
	_tmp1_ = _g_object_ref0 (_tmp0_);
#line 34 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
	_g_object_unref0 (self->priv->wm);
#line 34 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
	self->priv->wm = _tmp1_;
#line 35 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
	_tmp2_ = wm;
#line 35 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
	_tmp3_ = meta_plugin_get_screen ((MetaPlugin*) _tmp2_);
#line 35 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
	_tmp4_ = _g_object_ref0 (_tmp3_);
#line 35 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
	_g_object_unref0 (self->priv->screen);
#line 35 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
	self->priv->screen = _tmp4_;
#line 36 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
	_tmp5_ = gala_plugins_mask_corners_settings_get_default ();
#line 36 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
	_tmp6_ = _g_object_ref0 (_tmp5_);
#line 36 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
	_g_object_unref0 (self->priv->settings);
#line 36 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
	self->priv->settings = _tmp6_;
#line 38 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
	gala_plugins_mask_corners_main_setup_cornermasks (self);
#line 40 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
	_tmp7_ = self->priv->settings;
#line 40 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
	g_signal_connect_object ((GraniteServicesSettings*) _tmp7_, "changed", (GCallback) _gala_plugins_mask_corners_main_resetup_cornermasks_granite_services_settings_changed, self, 0);
#line 190 "Main.c"
}


static void gala_plugins_mask_corners_main_real_destroy (GalaPlugin* base) {
	GalaPluginsMaskCornersMain * self;
#line 43 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
	self = (GalaPluginsMaskCornersMain*) base;
#line 45 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
	gala_plugins_mask_corners_main_destroy_cornermasks (self);
#line 200 "Main.c"
}


static void _gala_plugins_mask_corners_main_fullscreen_changed_meta_screen_in_fullscreen_changed (MetaScreen* _sender, gpointer self) {
#line 65 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
	gala_plugins_mask_corners_main_fullscreen_changed ((GalaPluginsMaskCornersMain*) self);
#line 207 "Main.c"
}


static void _gala_plugins_mask_corners_main_resetup_cornermasks_meta_screen_monitors_changed (MetaScreen* _sender, gpointer self) {
#line 67 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
	gala_plugins_mask_corners_main_resetup_cornermasks ((GalaPluginsMaskCornersMain*) self);
#line 214 "Main.c"
}


static void gala_plugins_mask_corners_main_setup_cornermasks (GalaPluginsMaskCornersMain* self) {
	GalaPluginsMaskCornersSettings* _tmp0_ = NULL;
	gboolean _tmp1_ = FALSE;
	gboolean _tmp2_ = FALSE;
	gint n_monitors = 0;
	MetaScreen* _tmp3_ = NULL;
	gint _tmp4_ = 0;
	gint _tmp5_ = 0;
	GList** _tmp6_ = NULL;
	GalaPluginsMaskCornersSettings* _tmp7_ = NULL;
	gint _tmp8_ = 0;
	gint _tmp9_ = 0;
	GalaPluginsMaskCornersSettings* _tmp10_ = NULL;
	gboolean _tmp11_ = FALSE;
	gboolean _tmp12_ = FALSE;
	GalaPluginsMaskCornersSettings* _tmp20_ = NULL;
	gboolean _tmp21_ = FALSE;
	gboolean _tmp22_ = FALSE;
	MetaScreen* _tmp24_ = NULL;
#line 48 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
	g_return_if_fail (self != NULL);
#line 50 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
	_tmp0_ = self->priv->settings;
#line 50 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
	_tmp1_ = gala_plugins_mask_corners_settings_get_enable (_tmp0_);
#line 50 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
	_tmp2_ = _tmp1_;
#line 50 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
	if (!_tmp2_) {
#line 51 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
		return;
#line 249 "Main.c"
	}
#line 53 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
	_tmp3_ = self->priv->screen;
#line 53 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
	_tmp4_ = meta_screen_get_n_monitors (_tmp3_);
#line 53 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
	n_monitors = _tmp4_;
#line 54 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
	_tmp5_ = n_monitors;
#line 54 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
	_tmp6_ = g_new0 (GList*, _tmp5_ + 1);
#line 54 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
	self->priv->cornermasks = (_vala_array_free (self->priv->cornermasks, self->priv->cornermasks_length1, (GDestroyNotify) _g_list_free__g_object_unref0_), NULL);
#line 54 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
	self->priv->cornermasks = _tmp6_;
#line 54 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
	self->priv->cornermasks_length1 = _tmp5_;
#line 54 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
	self->priv->_cornermasks_size_ = self->priv->cornermasks_length1;
#line 55 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
	_tmp7_ = self->priv->settings;
#line 55 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
	_tmp8_ = gala_plugins_mask_corners_settings_get_corner_radius (_tmp7_);
#line 55 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
	_tmp9_ = _tmp8_;
#line 55 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
	self->priv->corner_radius = _tmp9_;
#line 57 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
	_tmp10_ = self->priv->settings;
#line 57 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
	_tmp11_ = gala_plugins_mask_corners_settings_get_only_on_primary (_tmp10_);
#line 57 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
	_tmp12_ = _tmp11_;
#line 57 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
	if (_tmp12_) {
#line 285 "Main.c"
		MetaScreen* _tmp13_ = NULL;
		gint _tmp14_ = 0;
#line 58 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
		_tmp13_ = self->priv->screen;
#line 58 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
		_tmp14_ = meta_screen_get_primary_monitor (_tmp13_);
#line 58 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
		gala_plugins_mask_corners_main_add_cornermasks (self, _tmp14_);
#line 294 "Main.c"
	} else {
		{
			gint m = 0;
#line 60 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
			m = 0;
#line 300 "Main.c"
			{
				gboolean _tmp15_ = FALSE;
#line 60 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
				_tmp15_ = TRUE;
#line 60 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
				while (TRUE) {
#line 307 "Main.c"
					gint _tmp17_ = 0;
					gint _tmp18_ = 0;
					gint _tmp19_ = 0;
#line 60 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
					if (!_tmp15_) {
#line 313 "Main.c"
						gint _tmp16_ = 0;
#line 60 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
						_tmp16_ = m;
#line 60 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
						m = _tmp16_ + 1;
#line 319 "Main.c"
					}
#line 60 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
					_tmp15_ = FALSE;
#line 60 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
					_tmp17_ = m;
#line 60 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
					_tmp18_ = n_monitors;
#line 60 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
					if (!(_tmp17_ < _tmp18_)) {
#line 60 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
						break;
#line 331 "Main.c"
					}
#line 61 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
					_tmp19_ = m;
#line 61 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
					gala_plugins_mask_corners_main_add_cornermasks (self, _tmp19_);
#line 337 "Main.c"
				}
			}
		}
	}
#line 64 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
	_tmp20_ = self->priv->settings;
#line 64 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
	_tmp21_ = gala_plugins_mask_corners_settings_get_disable_on_fullscreen (_tmp20_);
#line 64 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
	_tmp22_ = _tmp21_;
#line 64 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
	if (_tmp22_) {
#line 350 "Main.c"
		MetaScreen* _tmp23_ = NULL;
#line 65 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
		_tmp23_ = self->priv->screen;
#line 65 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
		g_signal_connect_object (_tmp23_, "in-fullscreen-changed", (GCallback) _gala_plugins_mask_corners_main_fullscreen_changed_meta_screen_in_fullscreen_changed, self, 0);
#line 356 "Main.c"
	}
#line 67 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
	_tmp24_ = self->priv->screen;
#line 67 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
	g_signal_connect_object (_tmp24_, "monitors-changed", (GCallback) _gala_plugins_mask_corners_main_resetup_cornermasks_meta_screen_monitors_changed, self, 0);
#line 362 "Main.c"
}


static void gala_plugins_mask_corners_main_destroy_cornermasks (GalaPluginsMaskCornersMain* self) {
	MetaScreen* _tmp0_ = NULL;
	guint _tmp1_ = 0U;
	MetaScreen* _tmp2_ = NULL;
	guint _tmp3_ = 0U;
	GList** _tmp4_ = NULL;
	gint _tmp4__length1 = 0;
#line 70 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
	g_return_if_fail (self != NULL);
#line 72 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
	_tmp0_ = self->priv->screen;
#line 72 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
	g_signal_parse_name ("monitors-changed", meta_screen_get_type (), &_tmp1_, NULL, FALSE);
#line 72 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
	g_signal_handlers_disconnect_matched (_tmp0_, G_SIGNAL_MATCH_ID | G_SIGNAL_MATCH_FUNC | G_SIGNAL_MATCH_DATA, _tmp1_, 0, NULL, (GCallback) _gala_plugins_mask_corners_main_resetup_cornermasks_meta_screen_monitors_changed, self);
#line 73 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
	_tmp2_ = self->priv->screen;
#line 73 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
	g_signal_parse_name ("in-fullscreen-changed", meta_screen_get_type (), &_tmp3_, NULL, FALSE);
#line 73 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
	g_signal_handlers_disconnect_matched (_tmp2_, G_SIGNAL_MATCH_ID | G_SIGNAL_MATCH_FUNC | G_SIGNAL_MATCH_DATA, _tmp3_, 0, NULL, (GCallback) _gala_plugins_mask_corners_main_fullscreen_changed_meta_screen_in_fullscreen_changed, self);
#line 75 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
	_tmp4_ = self->priv->cornermasks;
#line 75 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
	_tmp4__length1 = self->priv->cornermasks_length1;
#line 391 "Main.c"
	{
		GList** list_collection = NULL;
		gint list_collection_length1 = 0;
		gint _list_collection_size_ = 0;
		gint list_it = 0;
#line 75 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
		list_collection = _tmp4_;
#line 75 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
		list_collection_length1 = _tmp4__length1;
#line 75 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
		for (list_it = 0; list_it < _tmp4__length1; list_it = list_it + 1) {
#line 403 "Main.c"
			GList* list = NULL;
#line 75 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
			list = list_collection[list_it];
#line 407 "Main.c"
			{
				GList* _tmp5_ = NULL;
#line 76 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
				_tmp5_ = list;
#line 412 "Main.c"
				{
					GList* actor_collection = NULL;
					GList* actor_it = NULL;
#line 76 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
					actor_collection = _tmp5_;
#line 76 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
					for (actor_it = actor_collection; actor_it != NULL; actor_it = actor_it->next) {
#line 420 "Main.c"
						ClutterActor* _tmp6_ = NULL;
						ClutterActor* actor = NULL;
#line 76 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
						_tmp6_ = _g_object_ref0 ((ClutterActor*) actor_it->data);
#line 76 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
						actor = _tmp6_;
#line 427 "Main.c"
						{
							ClutterActor* _tmp7_ = NULL;
#line 77 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
							_tmp7_ = actor;
#line 77 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
							clutter_actor_destroy (_tmp7_);
#line 76 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
							_g_object_unref0 (actor);
#line 436 "Main.c"
						}
					}
				}
			}
		}
	}
}


static void gala_plugins_mask_corners_main_resetup_cornermasks (GalaPluginsMaskCornersMain* self) {
#line 81 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
	g_return_if_fail (self != NULL);
#line 83 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
	gala_plugins_mask_corners_main_destroy_cornermasks (self);
#line 84 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
	gala_plugins_mask_corners_main_setup_cornermasks (self);
#line 453 "Main.c"
}


static void gala_plugins_mask_corners_main_fullscreen_changed (GalaPluginsMaskCornersMain* self) {
#line 87 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
	g_return_if_fail (self != NULL);
#line 460 "Main.c"
	{
		gint i = 0;
#line 89 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
		i = 0;
#line 465 "Main.c"
		{
			gboolean _tmp0_ = FALSE;
#line 89 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
			_tmp0_ = TRUE;
#line 89 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
			while (TRUE) {
#line 472 "Main.c"
				gint _tmp2_ = 0;
				MetaScreen* _tmp3_ = NULL;
				gint _tmp4_ = 0;
				GList** _tmp5_ = NULL;
				gint _tmp5__length1 = 0;
				gint _tmp6_ = 0;
				GList* _tmp7_ = NULL;
#line 89 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
				if (!_tmp0_) {
#line 482 "Main.c"
					gint _tmp1_ = 0;
#line 89 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
					_tmp1_ = i;
#line 89 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
					i = _tmp1_ + 1;
#line 488 "Main.c"
				}
#line 89 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
				_tmp0_ = FALSE;
#line 89 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
				_tmp2_ = i;
#line 89 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
				_tmp3_ = self->priv->screen;
#line 89 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
				_tmp4_ = meta_screen_get_n_monitors (_tmp3_);
#line 89 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
				if (!(_tmp2_ < _tmp4_)) {
#line 89 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
					break;
#line 502 "Main.c"
				}
#line 90 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
				_tmp5_ = self->priv->cornermasks;
#line 90 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
				_tmp5__length1 = self->priv->cornermasks_length1;
#line 90 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
				_tmp6_ = i;
#line 90 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
				_tmp7_ = _tmp5_[_tmp6_];
#line 512 "Main.c"
				{
					GList* actor_collection = NULL;
					GList* actor_it = NULL;
#line 90 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
					actor_collection = _tmp7_;
#line 90 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
					for (actor_it = actor_collection; actor_it != NULL; actor_it = actor_it->next) {
#line 520 "Main.c"
						ClutterActor* _tmp8_ = NULL;
						ClutterActor* actor = NULL;
#line 90 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
						_tmp8_ = _g_object_ref0 ((ClutterActor*) actor_it->data);
#line 90 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
						actor = _tmp8_;
#line 527 "Main.c"
						{
							MetaScreen* _tmp9_ = NULL;
							gint _tmp10_ = 0;
							gboolean _tmp11_ = FALSE;
#line 91 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
							_tmp9_ = self->priv->screen;
#line 91 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
							_tmp10_ = i;
#line 91 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
							_tmp11_ = meta_screen_get_monitor_in_fullscreen (_tmp9_, _tmp10_);
#line 91 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
							if (_tmp11_) {
#line 540 "Main.c"
								ClutterActor* _tmp12_ = NULL;
#line 92 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
								_tmp12_ = actor;
#line 92 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
								clutter_actor_hide (_tmp12_);
#line 546 "Main.c"
							} else {
								ClutterActor* _tmp13_ = NULL;
#line 94 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
								_tmp13_ = actor;
#line 94 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
								clutter_actor_show (_tmp13_);
#line 553 "Main.c"
							}
#line 90 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
							_g_object_unref0 (actor);
#line 557 "Main.c"
						}
					}
				}
			}
		}
	}
}


static gboolean _gala_plugins_mask_corners_main_draw_cornermask_clutter_canvas_draw (ClutterCanvas* _sender, cairo_t* cr, gint width, gint height, gpointer self) {
	gboolean result;
	result = gala_plugins_mask_corners_main_draw_cornermask ((GalaPluginsMaskCornersMain*) self, cr);
#line 105 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
	return result;
#line 572 "Main.c"
}


static void gala_plugins_mask_corners_main_add_cornermasks (GalaPluginsMaskCornersMain* self, gint monitor_no) {
	MetaRectangle monitor_geometry = {0};
	MetaScreen* _tmp0_ = NULL;
	gint _tmp1_ = 0;
	MetaRectangle _tmp2_ = {0};
	ClutterCanvas* canvas = NULL;
	ClutterCanvas* _tmp3_ = NULL;
	ClutterCanvas* _tmp4_ = NULL;
	gint _tmp5_ = 0;
	gint _tmp6_ = 0;
	ClutterCanvas* _tmp7_ = NULL;
	ClutterCanvas* _tmp8_ = NULL;
	ClutterActor* actor = NULL;
	ClutterActor* _tmp9_ = NULL;
	ClutterActor* _tmp10_ = NULL;
	ClutterCanvas* _tmp11_ = NULL;
	ClutterActor* _tmp12_ = NULL;
	gint _tmp13_ = 0;
	gint _tmp14_ = 0;
	ClutterActor* _tmp15_ = NULL;
	MetaRectangle _tmp16_ = {0};
	gint _tmp17_ = 0;
	MetaRectangle _tmp18_ = {0};
	gint _tmp19_ = 0;
	ClutterActor* _tmp20_ = NULL;
	GList** _tmp21_ = NULL;
	gint _tmp21__length1 = 0;
	gint _tmp22_ = 0;
	ClutterActor* _tmp23_ = NULL;
	ClutterActor* _tmp24_ = NULL;
	GalaWindowManager* _tmp25_ = NULL;
	ClutterStage* _tmp26_ = NULL;
	ClutterStage* _tmp27_ = NULL;
	ClutterActor* _tmp28_ = NULL;
#line 99 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
	g_return_if_fail (self != NULL);
#line 101 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
	_tmp0_ = self->priv->screen;
#line 101 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
	_tmp1_ = monitor_no;
#line 101 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
	meta_screen_get_monitor_geometry (_tmp0_, _tmp1_, &_tmp2_);
#line 101 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
	monitor_geometry = _tmp2_;
#line 103 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
	_tmp3_ = clutter_canvas_new ();
#line 103 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
	canvas = _tmp3_;
#line 104 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
	_tmp4_ = canvas;
#line 104 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
	_tmp5_ = self->priv->corner_radius;
#line 104 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
	_tmp6_ = self->priv->corner_radius;
#line 104 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
	clutter_canvas_set_size (_tmp4_, _tmp5_, _tmp6_);
#line 105 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
	_tmp7_ = canvas;
#line 105 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
	g_signal_connect_object (_tmp7_, "draw", (GCallback) _gala_plugins_mask_corners_main_draw_cornermask_clutter_canvas_draw, self, 0);
#line 106 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
	_tmp8_ = canvas;
#line 106 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
	clutter_content_invalidate ((ClutterContent*) _tmp8_);
#line 108 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
	_tmp9_ = clutter_actor_new ();
#line 108 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
	g_object_ref_sink (_tmp9_);
#line 108 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
	actor = _tmp9_;
#line 109 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
	_tmp10_ = actor;
#line 109 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
	_tmp11_ = canvas;
#line 109 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
	clutter_actor_set_content (_tmp10_, (ClutterContent*) _tmp11_);
#line 110 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
	_tmp12_ = actor;
#line 110 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
	_tmp13_ = self->priv->corner_radius;
#line 110 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
	_tmp14_ = self->priv->corner_radius;
#line 110 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
	clutter_actor_set_size (_tmp12_, (gfloat) _tmp13_, (gfloat) _tmp14_);
#line 111 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
	_tmp15_ = actor;
#line 111 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
	_tmp16_ = monitor_geometry;
#line 111 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
	_tmp17_ = _tmp16_.x;
#line 111 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
	_tmp18_ = monitor_geometry;
#line 111 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
	_tmp19_ = _tmp18_.y;
#line 111 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
	clutter_actor_set_position (_tmp15_, (gfloat) _tmp17_, (gfloat) _tmp19_);
#line 112 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
	_tmp20_ = actor;
#line 112 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
	clutter_actor_set_pivot_point (_tmp20_, (gfloat) 0.5, (gfloat) 0.5);
#line 114 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
	_tmp21_ = self->priv->cornermasks;
#line 114 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
	_tmp21__length1 = self->priv->cornermasks_length1;
#line 114 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
	_tmp22_ = monitor_no;
#line 114 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
	_tmp23_ = actor;
#line 114 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
	_tmp24_ = _g_object_ref0 (_tmp23_);
#line 114 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
	_tmp21_[_tmp22_] = g_list_append (_tmp21_[_tmp22_], _tmp24_);
#line 115 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
	_tmp25_ = self->priv->wm;
#line 115 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
	_tmp26_ = gala_window_manager_get_stage (_tmp25_);
#line 115 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
	_tmp27_ = _tmp26_;
#line 115 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
	_tmp28_ = actor;
#line 115 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
	clutter_actor_add_child ((ClutterActor*) _tmp27_, _tmp28_);
#line 698 "Main.c"
	{
		gint p = 0;
#line 117 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
		p = 1;
#line 703 "Main.c"
		{
			gboolean _tmp29_ = FALSE;
#line 117 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
			_tmp29_ = TRUE;
#line 117 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
			while (TRUE) {
#line 710 "Main.c"
				gint _tmp31_ = 0;
				ClutterClone* clone = NULL;
				ClutterActor* _tmp32_ = NULL;
				ClutterClone* _tmp33_ = NULL;
				ClutterClone* _tmp34_ = NULL;
				gint _tmp35_ = 0;
				gint _tmp36_ = 0;
				GList** _tmp60_ = NULL;
				gint _tmp60__length1 = 0;
				gint _tmp61_ = 0;
				ClutterClone* _tmp62_ = NULL;
				ClutterActor* _tmp63_ = NULL;
				GalaWindowManager* _tmp64_ = NULL;
				ClutterStage* _tmp65_ = NULL;
				ClutterStage* _tmp66_ = NULL;
				ClutterClone* _tmp67_ = NULL;
#line 117 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
				if (!_tmp29_) {
#line 729 "Main.c"
					gint _tmp30_ = 0;
#line 117 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
					_tmp30_ = p;
#line 117 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
					p = _tmp30_ + 1;
#line 735 "Main.c"
				}
#line 117 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
				_tmp29_ = FALSE;
#line 117 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
				_tmp31_ = p;
#line 117 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
				if (!(_tmp31_ < 4)) {
#line 117 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
					break;
#line 745 "Main.c"
				}
#line 118 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
				_tmp32_ = actor;
#line 118 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
				_tmp33_ = (ClutterClone*) clutter_clone_new (_tmp32_);
#line 118 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
				g_object_ref_sink (_tmp33_);
#line 118 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
				clone = _tmp33_;
#line 119 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
				_tmp34_ = clone;
#line 119 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
				_tmp35_ = p;
#line 119 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
				g_object_set ((ClutterActor*) _tmp34_, "rotation-angle-z", (gdouble) (_tmp35_ * 90), NULL);
#line 121 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
				_tmp36_ = p;
#line 121 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
				switch (_tmp36_) {
#line 121 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
					case 1:
#line 767 "Main.c"
					{
						ClutterClone* _tmp37_ = NULL;
						MetaRectangle _tmp38_ = {0};
						gint _tmp39_ = 0;
						MetaRectangle _tmp40_ = {0};
						gint _tmp41_ = 0;
						MetaRectangle _tmp42_ = {0};
						gint _tmp43_ = 0;
#line 123 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
						_tmp37_ = clone;
#line 123 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
						_tmp38_ = monitor_geometry;
#line 123 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
						_tmp39_ = _tmp38_.x;
#line 123 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
						_tmp40_ = monitor_geometry;
#line 123 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
						_tmp41_ = _tmp40_.width;
#line 123 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
						_tmp42_ = monitor_geometry;
#line 123 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
						_tmp43_ = _tmp42_.y;
#line 123 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
						clutter_actor_set_position ((ClutterActor*) _tmp37_, (gfloat) (_tmp39_ + _tmp41_), (gfloat) _tmp43_);
#line 124 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
						break;
#line 794 "Main.c"
					}
#line 121 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
					case 2:
#line 798 "Main.c"
					{
						ClutterClone* _tmp44_ = NULL;
						MetaRectangle _tmp45_ = {0};
						gint _tmp46_ = 0;
						MetaRectangle _tmp47_ = {0};
						gint _tmp48_ = 0;
						MetaRectangle _tmp49_ = {0};
						gint _tmp50_ = 0;
						MetaRectangle _tmp51_ = {0};
						gint _tmp52_ = 0;
#line 126 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
						_tmp44_ = clone;
#line 126 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
						_tmp45_ = monitor_geometry;
#line 126 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
						_tmp46_ = _tmp45_.x;
#line 126 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
						_tmp47_ = monitor_geometry;
#line 126 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
						_tmp48_ = _tmp47_.width;
#line 126 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
						_tmp49_ = monitor_geometry;
#line 126 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
						_tmp50_ = _tmp49_.y;
#line 126 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
						_tmp51_ = monitor_geometry;
#line 126 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
						_tmp52_ = _tmp51_.height;
#line 126 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
						clutter_actor_set_position ((ClutterActor*) _tmp44_, (gfloat) (_tmp46_ + _tmp48_), (gfloat) (_tmp50_ + _tmp52_));
#line 127 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
						break;
#line 831 "Main.c"
					}
#line 121 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
					case 3:
#line 835 "Main.c"
					{
						ClutterClone* _tmp53_ = NULL;
						MetaRectangle _tmp54_ = {0};
						gint _tmp55_ = 0;
						MetaRectangle _tmp56_ = {0};
						gint _tmp57_ = 0;
						MetaRectangle _tmp58_ = {0};
						gint _tmp59_ = 0;
#line 129 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
						_tmp53_ = clone;
#line 129 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
						_tmp54_ = monitor_geometry;
#line 129 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
						_tmp55_ = _tmp54_.x;
#line 129 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
						_tmp56_ = monitor_geometry;
#line 129 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
						_tmp57_ = _tmp56_.y;
#line 129 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
						_tmp58_ = monitor_geometry;
#line 129 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
						_tmp59_ = _tmp58_.height;
#line 129 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
						clutter_actor_set_position ((ClutterActor*) _tmp53_, (gfloat) _tmp55_, (gfloat) (_tmp57_ + _tmp59_));
#line 130 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
						break;
#line 862 "Main.c"
					}
					default:
#line 121 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
					break;
#line 867 "Main.c"
				}
#line 133 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
				_tmp60_ = self->priv->cornermasks;
#line 133 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
				_tmp60__length1 = self->priv->cornermasks_length1;
#line 133 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
				_tmp61_ = monitor_no;
#line 133 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
				_tmp62_ = clone;
#line 133 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
				_tmp63_ = _g_object_ref0 ((ClutterActor*) _tmp62_);
#line 133 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
				_tmp60_[_tmp61_] = g_list_append (_tmp60_[_tmp61_], _tmp63_);
#line 134 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
				_tmp64_ = self->priv->wm;
#line 134 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
				_tmp65_ = gala_window_manager_get_stage (_tmp64_);
#line 134 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
				_tmp66_ = _tmp65_;
#line 134 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
				_tmp67_ = clone;
#line 134 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
				clutter_actor_add_child ((ClutterActor*) _tmp66_, (ClutterActor*) _tmp67_);
#line 117 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
				_g_object_unref0 (clone);
#line 893 "Main.c"
			}
		}
	}
#line 99 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
	_g_object_unref0 (actor);
#line 99 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
	_g_object_unref0 (canvas);
#line 901 "Main.c"
}


static gpointer _cairo_reference0 (gpointer self) {
#line 141 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
	return self ? cairo_reference (self) : NULL;
#line 908 "Main.c"
}


static gboolean gala_plugins_mask_corners_main_draw_cornermask (GalaPluginsMaskCornersMain* self, cairo_t* context) {
	gboolean result = FALSE;
	GraniteDrawingBufferSurface* buffer = NULL;
	gint _tmp0_ = 0;
	gint _tmp1_ = 0;
	GraniteDrawingBufferSurface* _tmp2_ = NULL;
	cairo_t* buffer_context = NULL;
	cairo_t* _tmp3_ = NULL;
	cairo_t* _tmp4_ = NULL;
	cairo_t* _tmp5_ = NULL;
	gint _tmp6_ = 0;
	gint _tmp7_ = 0;
	gint _tmp8_ = 0;
	gint _tmp9_ = 0;
	cairo_t* _tmp10_ = NULL;
	cairo_t* _tmp11_ = NULL;
	cairo_t* _tmp12_ = NULL;
	cairo_t* _tmp13_ = NULL;
	cairo_surface_t* _tmp14_ = NULL;
	cairo_surface_t* _tmp15_ = NULL;
	cairo_t* _tmp16_ = NULL;
#line 138 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
	g_return_val_if_fail (self != NULL, FALSE);
#line 138 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
	g_return_val_if_fail (context != NULL, FALSE);
#line 140 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
	_tmp0_ = self->priv->corner_radius;
#line 140 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
	_tmp1_ = self->priv->corner_radius;
#line 140 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
	_tmp2_ = granite_drawing_buffer_surface_new (_tmp0_, _tmp1_);
#line 140 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
	buffer = _tmp2_;
#line 141 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
	_tmp3_ = granite_drawing_buffer_surface_get_context (buffer);
#line 141 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
	_tmp4_ = _tmp3_;
#line 141 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
	_tmp5_ = _cairo_reference0 (_tmp4_);
#line 141 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
	buffer_context = _tmp5_;
#line 143 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
	_tmp6_ = self->priv->corner_radius;
#line 143 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
	_tmp7_ = self->priv->corner_radius;
#line 143 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
	_tmp8_ = self->priv->corner_radius;
#line 143 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
	cairo_arc (buffer_context, (gdouble) _tmp6_, (gdouble) _tmp7_, (gdouble) _tmp8_, G_PI, 1.5 * G_PI);
#line 144 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
	cairo_line_to (buffer_context, (gdouble) 0, (gdouble) 0);
#line 145 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
	_tmp9_ = self->priv->corner_radius;
#line 145 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
	cairo_line_to (buffer_context, (gdouble) 0, (gdouble) _tmp9_);
#line 146 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
	cairo_set_source_rgb (buffer_context, (gdouble) 0, (gdouble) 0, (gdouble) 0);
#line 147 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
	cairo_fill (buffer_context);
#line 149 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
	_tmp10_ = context;
#line 149 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
	cairo_set_operator (_tmp10_, CAIRO_OPERATOR_CLEAR);
#line 150 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
	_tmp11_ = context;
#line 150 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
	cairo_paint (_tmp11_);
#line 151 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
	_tmp12_ = context;
#line 151 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
	cairo_set_operator (_tmp12_, CAIRO_OPERATOR_OVER);
#line 152 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
	_tmp13_ = context;
#line 152 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
	_tmp14_ = granite_drawing_buffer_surface_get_surface (buffer);
#line 152 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
	_tmp15_ = _tmp14_;
#line 152 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
	cairo_set_source_surface (_tmp13_, _tmp15_, (gdouble) 0, (gdouble) 0);
#line 153 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
	_tmp16_ = context;
#line 153 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
	cairo_paint (_tmp16_);
#line 155 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
	result = TRUE;
#line 155 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
	_cairo_destroy0 (buffer_context);
#line 155 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
	_g_object_unref0 (buffer);
#line 155 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
	return result;
#line 1003 "Main.c"
}


GalaPluginsMaskCornersMain* gala_plugins_mask_corners_main_construct (GType object_type) {
	GalaPluginsMaskCornersMain * self = NULL;
#line 23 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
	self = (GalaPluginsMaskCornersMain*) gala_plugin_construct (object_type);
#line 23 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
	return self;
#line 1013 "Main.c"
}


GalaPluginsMaskCornersMain* gala_plugins_mask_corners_main_new (void) {
#line 23 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
	return gala_plugins_mask_corners_main_construct (GALA_PLUGINS_MASK_CORNERS_TYPE_MAIN);
#line 1020 "Main.c"
}


static void gala_plugins_mask_corners_main_class_init (GalaPluginsMaskCornersMainClass * klass) {
#line 23 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
	gala_plugins_mask_corners_main_parent_class = g_type_class_peek_parent (klass);
#line 23 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
	g_type_class_add_private (klass, sizeof (GalaPluginsMaskCornersMainPrivate));
#line 23 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
	((GalaPluginClass *) klass)->initialize = gala_plugins_mask_corners_main_real_initialize;
#line 23 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
	((GalaPluginClass *) klass)->destroy = gala_plugins_mask_corners_main_real_destroy;
#line 23 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
	G_OBJECT_CLASS (klass)->finalize = gala_plugins_mask_corners_main_finalize;
#line 1035 "Main.c"
}


static void gala_plugins_mask_corners_main_instance_init (GalaPluginsMaskCornersMain * self) {
#line 23 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
	self->priv = GALA_PLUGINS_MASK_CORNERS_MAIN_GET_PRIVATE (self);
#line 25 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
	self->priv->wm = NULL;
#line 30 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
	self->priv->corner_radius = 4;
#line 1046 "Main.c"
}


static void gala_plugins_mask_corners_main_finalize (GObject* obj) {
	GalaPluginsMaskCornersMain * self;
#line 23 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
	self = G_TYPE_CHECK_INSTANCE_CAST (obj, GALA_PLUGINS_MASK_CORNERS_TYPE_MAIN, GalaPluginsMaskCornersMain);
#line 25 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
	_g_object_unref0 (self->priv->wm);
#line 26 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
	_g_object_unref0 (self->priv->screen);
#line 27 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
	_g_object_unref0 (self->priv->settings);
#line 29 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
	self->priv->cornermasks = (_vala_array_free (self->priv->cornermasks, self->priv->cornermasks_length1, (GDestroyNotify) _g_list_free__g_object_unref0_), NULL);
#line 23 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
	G_OBJECT_CLASS (gala_plugins_mask_corners_main_parent_class)->finalize (obj);
#line 1064 "Main.c"
}


GType gala_plugins_mask_corners_main_get_type (void) {
	static volatile gsize gala_plugins_mask_corners_main_type_id__volatile = 0;
	if (g_once_init_enter (&gala_plugins_mask_corners_main_type_id__volatile)) {
		static const GTypeInfo g_define_type_info = { sizeof (GalaPluginsMaskCornersMainClass), (GBaseInitFunc) NULL, (GBaseFinalizeFunc) NULL, (GClassInitFunc) gala_plugins_mask_corners_main_class_init, (GClassFinalizeFunc) NULL, NULL, sizeof (GalaPluginsMaskCornersMain), 0, (GInstanceInitFunc) gala_plugins_mask_corners_main_instance_init, NULL };
		GType gala_plugins_mask_corners_main_type_id;
		gala_plugins_mask_corners_main_type_id = g_type_register_static (GALA_TYPE_PLUGIN, "GalaPluginsMaskCornersMain", &g_define_type_info, 0);
		g_once_init_leave (&gala_plugins_mask_corners_main_type_id__volatile, gala_plugins_mask_corners_main_type_id);
	}
	return gala_plugins_mask_corners_main_type_id__volatile;
}


void register_plugin (GalaPluginInfo* result) {
	gchar* _tmp0_ = NULL;
	gchar* _tmp1_ = NULL;
	GalaPluginInfo _tmp2_ = {0};
#line 162 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
	_tmp0_ = g_strdup ("Mask Corners");
#line 162 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
	_tmp1_ = g_strdup ("Gala Developers");
#line 162 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
	_g_free0 (_tmp2_.name);
#line 162 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
	_tmp2_.name = _tmp0_;
#line 162 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
	_g_free0 (_tmp2_.author);
#line 162 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
	_tmp2_.author = _tmp1_;
#line 162 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
	_tmp2_.plugin_type = GALA_PLUGINS_MASK_CORNERS_TYPE_MAIN;
#line 162 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
	_tmp2_.provides = GALA_PLUGIN_FUNCTION_ADDITION;
#line 162 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
	_tmp2_.load_priority = GALA_LOAD_PRIORITY_IMMEDIATE;
#line 162 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
	*result = _tmp2_;
#line 162 "/home/nick/work/Enso-OS/galal/plugins/maskcorners/Main.vala"
	return;
#line 1106 "Main.c"
}


static void _vala_array_destroy (gpointer array, gint array_length, GDestroyNotify destroy_func) {
	if ((array != NULL) && (destroy_func != NULL)) {
		int i;
		for (i = 0; i < array_length; i = i + 1) {
			if (((gpointer*) array)[i] != NULL) {
				destroy_func (((gpointer*) array)[i]);
			}
		}
	}
}


static void _vala_array_free (gpointer array, gint array_length, GDestroyNotify destroy_func) {
	_vala_array_destroy (array, array_length, destroy_func);
	g_free (array);
}



