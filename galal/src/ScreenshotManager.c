/* ScreenshotManager.c generated by valac 0.30.1, the Vala compiler
 * generated from ScreenshotManager.vala, do not modify */

/**/
/*  Copyright (C) 2016 Rico Tzschichholz, Santiago Le√≥n O.*/
/**/
/*  This program is free software: you can redistribute it and/or modify*/
/*  it under the terms of the GNU General Public License as published by*/
/*  the Free Software Foundation, either version 3 of the License, or*/
/*  (at your option) any later version.*/
/**/
/*  This program is distributed in the hope that it will be useful,*/
/*  but WITHOUT ANY WARRANTY; without even the implied warranty of*/
/*  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the*/
/*  GNU General Public License for more details.*/
/**/
/*  You should have received a copy of the GNU General Public License*/
/*  along with this program.  If not, see <http://www.gnu.org/licenses/>.*/
/**/

#include <glib.h>
#include <glib-object.h>
#include <gio/gio.h>
#include "gala.h"
#include <stdlib.h>
#include <string.h>
#include <meta/meta-plugin.h>
#include <meta/screen.h>
#include <cairo.h>
#include <meta/window.h>
#include <meta/display.h>
#include <meta/meta-window-actor.h>
#include <meta/meta-shaped-texture.h>
#include <float.h>
#include <math.h>
#include <clutter/clutter.h>
#include <meta/boxes.h>
#include <glib/gstdio.h>
#include <gdk-pixbuf/gdk-pixbuf.h>
#include <gdk/gdk.h>
#include "cogl/cogl.h"


#define GALA_TYPE_SCREENSHOT_MANAGER (gala_screenshot_manager_get_type ())
#define GALA_SCREENSHOT_MANAGER(obj) (G_TYPE_CHECK_INSTANCE_CAST ((obj), GALA_TYPE_SCREENSHOT_MANAGER, GalaScreenshotManager))
#define GALA_SCREENSHOT_MANAGER_CLASS(klass) (G_TYPE_CHECK_CLASS_CAST ((klass), GALA_TYPE_SCREENSHOT_MANAGER, GalaScreenshotManagerClass))
#define GALA_IS_SCREENSHOT_MANAGER(obj) (G_TYPE_CHECK_INSTANCE_TYPE ((obj), GALA_TYPE_SCREENSHOT_MANAGER))
#define GALA_IS_SCREENSHOT_MANAGER_CLASS(klass) (G_TYPE_CHECK_CLASS_TYPE ((klass), GALA_TYPE_SCREENSHOT_MANAGER))
#define GALA_SCREENSHOT_MANAGER_GET_CLASS(obj) (G_TYPE_INSTANCE_GET_CLASS ((obj), GALA_TYPE_SCREENSHOT_MANAGER, GalaScreenshotManagerClass))

typedef struct _GalaScreenshotManager GalaScreenshotManager;
typedef struct _GalaScreenshotManagerClass GalaScreenshotManagerClass;
typedef struct _GalaScreenshotManagerPrivate GalaScreenshotManagerPrivate;
#define _g_object_unref0(var) ((var == NULL) ? NULL : (var = (g_object_unref (var), NULL)))
#define _g_free0(var) (var = (g_free (var), NULL))
#define _cairo_surface_destroy0(var) ((var == NULL) ? NULL : (var = (cairo_surface_destroy (var), NULL)))
#define _g_error_free0(var) ((var == NULL) ? NULL : (var = (g_error_free (var), NULL)))
#define _cogl_handle_unref0(var) ((var == NULL) ? NULL : (var = (cogl_handle_unref (var), NULL)))

struct _GalaScreenshotManager {
	GObject parent_instance;
	GalaScreenshotManagerPrivate * priv;
};

struct _GalaScreenshotManagerClass {
	GObjectClass parent_class;
};

struct _GalaScreenshotManagerPrivate {
	GalaWindowManager* wm;
};


static gpointer gala_screenshot_manager_parent_class = NULL;
static GalaScreenshotManager* gala_screenshot_manager_instance;
static GalaScreenshotManager* gala_screenshot_manager_instance = NULL;

GType gala_screenshot_manager_get_type (void) G_GNUC_CONST;
guint gala_screenshot_manager_register_object (void* object, GDBusConnection* connection, const gchar* path, GError** error);
#define GALA_SCREENSHOT_MANAGER_GET_PRIVATE(o) (G_TYPE_INSTANCE_GET_PRIVATE ((o), GALA_TYPE_SCREENSHOT_MANAGER, GalaScreenshotManagerPrivate))
enum  {
	GALA_SCREENSHOT_MANAGER_DUMMY_PROPERTY
};
GalaScreenshotManager* gala_screenshot_manager_init (GalaWindowManager* wm);
static GalaScreenshotManager* gala_screenshot_manager_new (GalaWindowManager* _wm);
static GalaScreenshotManager* gala_screenshot_manager_construct (GType object_type, GalaWindowManager* _wm);
void gala_screenshot_manager_flash_area (GalaScreenshotManager* self, gint x, gint y, gint width, gint height);
void gala_screenshot_manager_screenshot (GalaScreenshotManager* self, gboolean include_cursor, gboolean flash, const gchar* filename, gboolean* success, gchar** filename_used);
static cairo_surface_t* gala_screenshot_manager_take_screenshot (GalaScreenshotManager* self, gint x, gint y, gint width, gint height);
static gboolean gala_screenshot_manager_save_image (cairo_surface_t* image, const gchar* filename, gchar** used_filename);
void gala_screenshot_manager_screenshot_area (GalaScreenshotManager* self, gint x, gint y, gint width, gint height, gboolean flash, const gchar* filename, gboolean* success, gchar** filename_used, GError** error);
void gala_screenshot_manager_screenshot_window (GalaScreenshotManager* self, gboolean include_frame, gboolean include_cursor, gboolean flash, const gchar* filename, gboolean* success, gchar** filename_used);
void gala_screenshot_manager_select_area (GalaScreenshotManager* self, gint* x, gint* y, gint* width, gint* height, GError** error);
static void gala_screenshot_manager_finalize (GObject* obj);
static void _dbus_gala_screenshot_manager_flash_area (GalaScreenshotManager* self, GVariant* _parameters_, GDBusMethodInvocation* invocation);
static void _dbus_gala_screenshot_manager_screenshot (GalaScreenshotManager* self, GVariant* _parameters_, GDBusMethodInvocation* invocation);
static void _dbus_gala_screenshot_manager_screenshot_area (GalaScreenshotManager* self, GVariant* _parameters_, GDBusMethodInvocation* invocation);
static void _dbus_gala_screenshot_manager_screenshot_window (GalaScreenshotManager* self, GVariant* _parameters_, GDBusMethodInvocation* invocation);
static void _dbus_gala_screenshot_manager_select_area (GalaScreenshotManager* self, GVariant* _parameters_, GDBusMethodInvocation* invocation);
static void gala_screenshot_manager_dbus_interface_method_call (GDBusConnection* connection, const gchar* sender, const gchar* object_path, const gchar* interface_name, const gchar* method_name, GVariant* parameters, GDBusMethodInvocation* invocation, gpointer user_data);
static GVariant* gala_screenshot_manager_dbus_interface_get_property (GDBusConnection* connection, const gchar* sender, const gchar* object_path, const gchar* interface_name, const gchar* property_name, GError** error, gpointer user_data);
static gboolean gala_screenshot_manager_dbus_interface_set_property (GDBusConnection* connection, const gchar* sender, const gchar* object_path, const gchar* interface_name, const gchar* property_name, GVariant* value, GError** error, gpointer user_data);
static void _gala_screenshot_manager_unregister_object (gpointer user_data);

static const GDBusArgInfo _gala_screenshot_manager_dbus_arg_info_flash_area_x = {-1, "x", "i"};
static const GDBusArgInfo _gala_screenshot_manager_dbus_arg_info_flash_area_y = {-1, "y", "i"};
static const GDBusArgInfo _gala_screenshot_manager_dbus_arg_info_flash_area_width = {-1, "width", "i"};
static const GDBusArgInfo _gala_screenshot_manager_dbus_arg_info_flash_area_height = {-1, "height", "i"};
static const GDBusArgInfo * const _gala_screenshot_manager_dbus_arg_info_flash_area_in[] = {&_gala_screenshot_manager_dbus_arg_info_flash_area_x, &_gala_screenshot_manager_dbus_arg_info_flash_area_y, &_gala_screenshot_manager_dbus_arg_info_flash_area_width, &_gala_screenshot_manager_dbus_arg_info_flash_area_height, NULL};
static const GDBusArgInfo * const _gala_screenshot_manager_dbus_arg_info_flash_area_out[] = {NULL};
static const GDBusMethodInfo _gala_screenshot_manager_dbus_method_info_flash_area = {-1, "FlashArea", (GDBusArgInfo **) (&_gala_screenshot_manager_dbus_arg_info_flash_area_in), (GDBusArgInfo **) (&_gala_screenshot_manager_dbus_arg_info_flash_area_out)};
static const GDBusArgInfo _gala_screenshot_manager_dbus_arg_info_screenshot_include_cursor = {-1, "include_cursor", "b"};
static const GDBusArgInfo _gala_screenshot_manager_dbus_arg_info_screenshot_flash = {-1, "flash", "b"};
static const GDBusArgInfo _gala_screenshot_manager_dbus_arg_info_screenshot_filename = {-1, "filename", "s"};
static const GDBusArgInfo _gala_screenshot_manager_dbus_arg_info_screenshot_success = {-1, "success", "b"};
static const GDBusArgInfo _gala_screenshot_manager_dbus_arg_info_screenshot_filename_used = {-1, "filename_used", "s"};
static const GDBusArgInfo * const _gala_screenshot_manager_dbus_arg_info_screenshot_in[] = {&_gala_screenshot_manager_dbus_arg_info_screenshot_include_cursor, &_gala_screenshot_manager_dbus_arg_info_screenshot_flash, &_gala_screenshot_manager_dbus_arg_info_screenshot_filename, NULL};
static const GDBusArgInfo * const _gala_screenshot_manager_dbus_arg_info_screenshot_out[] = {&_gala_screenshot_manager_dbus_arg_info_screenshot_success, &_gala_screenshot_manager_dbus_arg_info_screenshot_filename_used, NULL};
static const GDBusMethodInfo _gala_screenshot_manager_dbus_method_info_screenshot = {-1, "Screenshot", (GDBusArgInfo **) (&_gala_screenshot_manager_dbus_arg_info_screenshot_in), (GDBusArgInfo **) (&_gala_screenshot_manager_dbus_arg_info_screenshot_out)};
static const GDBusArgInfo _gala_screenshot_manager_dbus_arg_info_screenshot_area_x = {-1, "x", "i"};
static const GDBusArgInfo _gala_screenshot_manager_dbus_arg_info_screenshot_area_y = {-1, "y", "i"};
static const GDBusArgInfo _gala_screenshot_manager_dbus_arg_info_screenshot_area_width = {-1, "width", "i"};
static const GDBusArgInfo _gala_screenshot_manager_dbus_arg_info_screenshot_area_height = {-1, "height", "i"};
static const GDBusArgInfo _gala_screenshot_manager_dbus_arg_info_screenshot_area_flash = {-1, "flash", "b"};
static const GDBusArgInfo _gala_screenshot_manager_dbus_arg_info_screenshot_area_filename = {-1, "filename", "s"};
static const GDBusArgInfo _gala_screenshot_manager_dbus_arg_info_screenshot_area_success = {-1, "success", "b"};
static const GDBusArgInfo _gala_screenshot_manager_dbus_arg_info_screenshot_area_filename_used = {-1, "filename_used", "s"};
static const GDBusArgInfo * const _gala_screenshot_manager_dbus_arg_info_screenshot_area_in[] = {&_gala_screenshot_manager_dbus_arg_info_screenshot_area_x, &_gala_screenshot_manager_dbus_arg_info_screenshot_area_y, &_gala_screenshot_manager_dbus_arg_info_screenshot_area_width, &_gala_screenshot_manager_dbus_arg_info_screenshot_area_height, &_gala_screenshot_manager_dbus_arg_info_screenshot_area_flash, &_gala_screenshot_manager_dbus_arg_info_screenshot_area_filename, NULL};
static const GDBusArgInfo * const _gala_screenshot_manager_dbus_arg_info_screenshot_area_out[] = {&_gala_screenshot_manager_dbus_arg_info_screenshot_area_success, &_gala_screenshot_manager_dbus_arg_info_screenshot_area_filename_used, NULL};
static const GDBusMethodInfo _gala_screenshot_manager_dbus_method_info_screenshot_area = {-1, "ScreenshotArea", (GDBusArgInfo **) (&_gala_screenshot_manager_dbus_arg_info_screenshot_area_in), (GDBusArgInfo **) (&_gala_screenshot_manager_dbus_arg_info_screenshot_area_out)};
static const GDBusArgInfo _gala_screenshot_manager_dbus_arg_info_screenshot_window_include_frame = {-1, "include_frame", "b"};
static const GDBusArgInfo _gala_screenshot_manager_dbus_arg_info_screenshot_window_include_cursor = {-1, "include_cursor", "b"};
static const GDBusArgInfo _gala_screenshot_manager_dbus_arg_info_screenshot_window_flash = {-1, "flash", "b"};
static const GDBusArgInfo _gala_screenshot_manager_dbus_arg_info_screenshot_window_filename = {-1, "filename", "s"};
static const GDBusArgInfo _gala_screenshot_manager_dbus_arg_info_screenshot_window_success = {-1, "success", "b"};
static const GDBusArgInfo _gala_screenshot_manager_dbus_arg_info_screenshot_window_filename_used = {-1, "filename_used", "s"};
static const GDBusArgInfo * const _gala_screenshot_manager_dbus_arg_info_screenshot_window_in[] = {&_gala_screenshot_manager_dbus_arg_info_screenshot_window_include_frame, &_gala_screenshot_manager_dbus_arg_info_screenshot_window_include_cursor, &_gala_screenshot_manager_dbus_arg_info_screenshot_window_flash, &_gala_screenshot_manager_dbus_arg_info_screenshot_window_filename, NULL};
static const GDBusArgInfo * const _gala_screenshot_manager_dbus_arg_info_screenshot_window_out[] = {&_gala_screenshot_manager_dbus_arg_info_screenshot_window_success, &_gala_screenshot_manager_dbus_arg_info_screenshot_window_filename_used, NULL};
static const GDBusMethodInfo _gala_screenshot_manager_dbus_method_info_screenshot_window = {-1, "ScreenshotWindow", (GDBusArgInfo **) (&_gala_screenshot_manager_dbus_arg_info_screenshot_window_in), (GDBusArgInfo **) (&_gala_screenshot_manager_dbus_arg_info_screenshot_window_out)};
static const GDBusArgInfo _gala_screenshot_manager_dbus_arg_info_select_area_x = {-1, "x", "i"};
static const GDBusArgInfo _gala_screenshot_manager_dbus_arg_info_select_area_y = {-1, "y", "i"};
static const GDBusArgInfo _gala_screenshot_manager_dbus_arg_info_select_area_width = {-1, "width", "i"};
static const GDBusArgInfo _gala_screenshot_manager_dbus_arg_info_select_area_height = {-1, "height", "i"};
static const GDBusArgInfo * const _gala_screenshot_manager_dbus_arg_info_select_area_in[] = {NULL};
static const GDBusArgInfo * const _gala_screenshot_manager_dbus_arg_info_select_area_out[] = {&_gala_screenshot_manager_dbus_arg_info_select_area_x, &_gala_screenshot_manager_dbus_arg_info_select_area_y, &_gala_screenshot_manager_dbus_arg_info_select_area_width, &_gala_screenshot_manager_dbus_arg_info_select_area_height, NULL};
static const GDBusMethodInfo _gala_screenshot_manager_dbus_method_info_select_area = {-1, "SelectArea", (GDBusArgInfo **) (&_gala_screenshot_manager_dbus_arg_info_select_area_in), (GDBusArgInfo **) (&_gala_screenshot_manager_dbus_arg_info_select_area_out)};
static const GDBusMethodInfo * const _gala_screenshot_manager_dbus_method_info[] = {&_gala_screenshot_manager_dbus_method_info_flash_area, &_gala_screenshot_manager_dbus_method_info_screenshot, &_gala_screenshot_manager_dbus_method_info_screenshot_area, &_gala_screenshot_manager_dbus_method_info_screenshot_window, &_gala_screenshot_manager_dbus_method_info_select_area, NULL};
static const GDBusSignalInfo * const _gala_screenshot_manager_dbus_signal_info[] = {NULL};
static const GDBusPropertyInfo * const _gala_screenshot_manager_dbus_property_info[] = {NULL};
static const GDBusInterfaceInfo _gala_screenshot_manager_dbus_interface_info = {-1, "org.gnome.Shell.Screenshot", (GDBusMethodInfo **) (&_gala_screenshot_manager_dbus_method_info), (GDBusSignalInfo **) (&_gala_screenshot_manager_dbus_signal_info), (GDBusPropertyInfo **) (&_gala_screenshot_manager_dbus_property_info)};
static const GDBusInterfaceVTable _gala_screenshot_manager_dbus_interface_vtable = {gala_screenshot_manager_dbus_interface_method_call, gala_screenshot_manager_dbus_interface_get_property, gala_screenshot_manager_dbus_interface_set_property};

GalaScreenshotManager* gala_screenshot_manager_init (GalaWindowManager* wm) {
	GalaScreenshotManager* result = NULL;
	GalaScreenshotManager* _tmp0_ = NULL;
	GalaScreenshotManager* _tmp3_ = NULL;
#line 26 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
	g_return_val_if_fail (wm != NULL, NULL);
#line 28 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
	_tmp0_ = gala_screenshot_manager_instance;
#line 28 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
	if (_tmp0_ == NULL) {
#line 164 "ScreenshotManager.c"
		GalaWindowManager* _tmp1_ = NULL;
		GalaScreenshotManager* _tmp2_ = NULL;
#line 29 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
		_tmp1_ = wm;
#line 29 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
		_tmp2_ = gala_screenshot_manager_new (_tmp1_);
#line 29 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
		_g_object_unref0 (gala_screenshot_manager_instance);
#line 29 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
		gala_screenshot_manager_instance = _tmp2_;
#line 175 "ScreenshotManager.c"
	}
#line 31 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
	_tmp3_ = gala_screenshot_manager_instance;
#line 31 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
	result = _tmp3_;
#line 31 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
	return result;
#line 183 "ScreenshotManager.c"
}


static gpointer _g_object_ref0 (gpointer self) {
#line 38 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
	return self ? g_object_ref (self) : NULL;
#line 190 "ScreenshotManager.c"
}


static GalaScreenshotManager* gala_screenshot_manager_construct (GType object_type, GalaWindowManager* _wm) {
	GalaScreenshotManager * self = NULL;
	GalaWindowManager* _tmp0_ = NULL;
	GalaWindowManager* _tmp1_ = NULL;
#line 36 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
	g_return_val_if_fail (_wm != NULL, NULL);
#line 36 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
	self = (GalaScreenshotManager*) g_object_new (object_type, NULL);
#line 38 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
	_tmp0_ = _wm;
#line 38 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
	_tmp1_ = _g_object_ref0 (_tmp0_);
#line 38 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
	_g_object_unref0 (self->priv->wm);
#line 38 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
	self->priv->wm = _tmp1_;
#line 36 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
	return self;
#line 212 "ScreenshotManager.c"
}


static GalaScreenshotManager* gala_screenshot_manager_new (GalaWindowManager* _wm) {
#line 36 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
	return gala_screenshot_manager_construct (GALA_TYPE_SCREENSHOT_MANAGER, _wm);
#line 219 "ScreenshotManager.c"
}


void gala_screenshot_manager_flash_area (GalaScreenshotManager* self, gint x, gint y, gint width, gint height) {
#line 41 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
	g_return_if_fail (self != NULL);
#line 43 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
	g_warning ("ScreenshotManager.vala:43: FlashArea not implemented");
#line 228 "ScreenshotManager.c"
}


void gala_screenshot_manager_screenshot (GalaScreenshotManager* self, gboolean include_cursor, gboolean flash, const gchar* filename, gboolean* success, gchar** filename_used) {
	gboolean _vala_success = FALSE;
	gchar* _vala_filename_used = NULL;
	gint width = 0;
	gint height = 0;
	GalaWindowManager* _tmp0_ = NULL;
	MetaScreen* _tmp1_ = NULL;
	gint _tmp2_ = 0;
	gint _tmp3_ = 0;
	cairo_surface_t* image = NULL;
	cairo_surface_t* _tmp4_ = NULL;
	const gchar* _tmp5_ = NULL;
	gchar* _tmp6_ = NULL;
	gboolean _tmp7_ = FALSE;
#line 46 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
	g_return_if_fail (self != NULL);
#line 46 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
	g_return_if_fail (filename != NULL);
#line 48 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
	g_debug ("ScreenshotManager.vala:48: Taking screenshot");
#line 51 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
	_tmp0_ = self->priv->wm;
#line 51 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
	_tmp1_ = meta_plugin_get_screen ((MetaPlugin*) _tmp0_);
#line 51 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
	meta_screen_get_size (_tmp1_, &_tmp2_, &_tmp3_);
#line 51 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
	width = _tmp2_;
#line 51 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
	height = _tmp3_;
#line 53 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
	_tmp4_ = gala_screenshot_manager_take_screenshot (self, 0, 0, width, height);
#line 53 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
	image = _tmp4_;
#line 54 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
	_tmp5_ = filename;
#line 54 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
	_tmp7_ = gala_screenshot_manager_save_image (image, _tmp5_, &_tmp6_);
#line 54 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
	_g_free0 (_vala_filename_used);
#line 54 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
	_vala_filename_used = _tmp6_;
#line 54 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
	_vala_success = _tmp7_;
#line 46 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
	_cairo_surface_destroy0 (image);
#line 46 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
	if (success) {
#line 46 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
		*success = _vala_success;
#line 282 "ScreenshotManager.c"
	}
#line 46 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
	if (filename_used) {
#line 46 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
		*filename_used = _vala_filename_used;
#line 288 "ScreenshotManager.c"
	} else {
#line 46 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
		_g_free0 (_vala_filename_used);
#line 292 "ScreenshotManager.c"
	}
}


void gala_screenshot_manager_screenshot_area (GalaScreenshotManager* self, gint x, gint y, gint width, gint height, gboolean flash, const gchar* filename, gboolean* success, gchar** filename_used, GError** error) {
	gboolean _vala_success = FALSE;
	gchar* _vala_filename_used = NULL;
	gchar* _tmp0_ = NULL;
	GError* _tmp1_ = NULL;
	GError * _inner_error_ = NULL;
#line 57 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
	g_return_if_fail (self != NULL);
#line 57 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
	g_return_if_fail (filename != NULL);
#line 59 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
	g_warning ("ScreenshotManager.vala:59: ScreenShotArea not implemented");
#line 60 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
	_tmp0_ = g_strdup ("");
#line 60 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
	_g_free0 (_vala_filename_used);
#line 60 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
	_vala_filename_used = _tmp0_;
#line 61 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
	_vala_success = FALSE;
#line 63 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
	_tmp1_ = g_error_new_literal (G_DBUS_ERROR, G_DBUS_ERROR_FAILED, "ScreenShotArea not implemented");
#line 63 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
	_inner_error_ = _tmp1_;
#line 63 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
	if (_inner_error_->domain == G_DBUS_ERROR) {
#line 63 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
		g_propagate_error (error, _inner_error_);
#line 63 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
		return;
#line 327 "ScreenshotManager.c"
	} else {
#line 63 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
		g_critical ("file %s: line %d: uncaught error: %s (%s, %d)", __FILE__, __LINE__, _inner_error_->message, g_quark_to_string (_inner_error_->domain), _inner_error_->code);
#line 63 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
		g_clear_error (&_inner_error_);
#line 63 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
		return;
#line 335 "ScreenshotManager.c"
	}
#line 57 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
	if (success) {
#line 57 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
		*success = _vala_success;
#line 341 "ScreenshotManager.c"
	}
#line 57 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
	if (filename_used) {
#line 57 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
		*filename_used = _vala_filename_used;
#line 347 "ScreenshotManager.c"
	} else {
#line 57 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
		_g_free0 (_vala_filename_used);
#line 351 "ScreenshotManager.c"
	}
}


void gala_screenshot_manager_screenshot_window (GalaScreenshotManager* self, gboolean include_frame, gboolean include_cursor, gboolean flash, const gchar* filename, gboolean* success, gchar** filename_used) {
	gboolean _vala_success = FALSE;
	gchar* _vala_filename_used = NULL;
	MetaWindow* window = NULL;
	GalaWindowManager* _tmp0_ = NULL;
	MetaScreen* _tmp1_ = NULL;
	MetaDisplay* _tmp2_ = NULL;
	MetaWindow* _tmp3_ = NULL;
	MetaWindow* _tmp4_ = NULL;
	MetaWindowActor* window_actor = NULL;
	MetaWindow* _tmp5_ = NULL;
	GObject* _tmp6_ = NULL;
	MetaWindowActor* _tmp7_ = NULL;
	MetaShapedTexture* window_texture = NULL;
	MetaWindowActor* _tmp8_ = NULL;
	ClutterActor* _tmp9_ = NULL;
	gfloat actor_x = 0.0F;
	gfloat actor_y = 0.0F;
	MetaWindowActor* _tmp10_ = NULL;
	gfloat _tmp11_ = 0.0F;
	gfloat _tmp12_ = 0.0F;
	MetaRectangle rect = {0};
	MetaWindow* _tmp13_ = NULL;
	MetaRectangle _tmp14_ = {0};
	gboolean _tmp15_ = FALSE;
	cairo_rectangle_int_t clip = {0};
	MetaRectangle _tmp19_ = {0};
	gint _tmp20_ = 0;
	gfloat _tmp21_ = 0.0F;
	MetaRectangle _tmp22_ = {0};
	gint _tmp23_ = 0;
	gfloat _tmp24_ = 0.0F;
	MetaRectangle _tmp25_ = {0};
	gint _tmp26_ = 0;
	MetaRectangle _tmp27_ = {0};
	gint _tmp28_ = 0;
	cairo_rectangle_int_t _tmp29_ = {0};
	cairo_surface_t* image = NULL;
	MetaShapedTexture* _tmp30_ = NULL;
	cairo_rectangle_int_t _tmp31_ = {0};
	cairo_surface_t* _tmp32_ = NULL;
	const gchar* _tmp33_ = NULL;
	gchar* _tmp34_ = NULL;
	gboolean _tmp35_ = FALSE;
#line 66 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
	g_return_if_fail (self != NULL);
#line 66 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
	g_return_if_fail (filename != NULL);
#line 68 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
	g_debug ("ScreenshotManager.vala:68: Taking window screenshot");
#line 70 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
	_tmp0_ = self->priv->wm;
#line 70 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
	_tmp1_ = meta_plugin_get_screen ((MetaPlugin*) _tmp0_);
#line 70 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
	_tmp2_ = meta_screen_get_display (_tmp1_);
#line 70 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
	_tmp3_ = meta_display_get_focus_window (_tmp2_);
#line 70 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
	_tmp4_ = _g_object_ref0 (_tmp3_);
#line 70 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
	window = _tmp4_;
#line 71 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
	_tmp5_ = window;
#line 71 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
	_tmp6_ = meta_window_get_compositor_private (_tmp5_);
#line 71 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
	_tmp7_ = _g_object_ref0 (G_TYPE_CHECK_INSTANCE_CAST (_tmp6_, meta_window_actor_get_type (), MetaWindowActor));
#line 71 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
	window_actor = _tmp7_;
#line 72 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
	_tmp8_ = window_actor;
#line 72 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
	_tmp9_ = meta_window_actor_get_texture (_tmp8_);
#line 72 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
	window_texture = G_TYPE_CHECK_INSTANCE_CAST (_tmp9_, meta_shaped_texture_get_type (), MetaShapedTexture);
#line 75 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
	_tmp10_ = window_actor;
#line 75 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
	clutter_actor_get_position ((ClutterActor*) _tmp10_, &_tmp11_, &_tmp12_);
#line 75 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
	actor_x = _tmp11_;
#line 75 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
	actor_y = _tmp12_;
#line 77 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
	_tmp13_ = window;
#line 77 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
	meta_window_get_frame_rect (_tmp13_, &_tmp14_);
#line 77 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
	rect = _tmp14_;
#line 78 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
	_tmp15_ = include_frame;
#line 78 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
	if (_tmp15_) {
#line 450 "ScreenshotManager.c"
		MetaWindow* _tmp16_ = NULL;
		MetaRectangle _tmp17_ = {0};
		MetaRectangle _tmp18_ = {0};
#line 79 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
		_tmp16_ = window;
#line 79 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
		_tmp17_ = rect;
#line 79 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
		meta_window_frame_rect_to_client_rect (_tmp16_, &_tmp17_, &_tmp18_);
#line 79 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
		rect = _tmp18_;
#line 462 "ScreenshotManager.c"
	}
#line 82 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
	_tmp19_ = rect;
#line 82 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
	_tmp20_ = _tmp19_.x;
#line 82 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
	_tmp21_ = actor_x;
#line 82 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
	_tmp22_ = rect;
#line 82 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
	_tmp23_ = _tmp22_.y;
#line 82 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
	_tmp24_ = actor_y;
#line 82 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
	_tmp25_ = rect;
#line 82 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
	_tmp26_ = _tmp25_.width;
#line 82 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
	_tmp27_ = rect;
#line 82 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
	_tmp28_ = _tmp27_.height;
#line 82 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
	_tmp29_.x = _tmp20_ - ((gint) _tmp21_);
#line 82 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
	_tmp29_.y = _tmp23_ - ((gint) _tmp24_);
#line 82 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
	_tmp29_.width = _tmp26_;
#line 82 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
	_tmp29_.height = _tmp28_;
#line 82 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
	clip = _tmp29_;
#line 83 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
	_tmp30_ = window_texture;
#line 83 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
	_tmp31_ = clip;
#line 83 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
	_tmp32_ = meta_shaped_texture_get_image (_tmp30_, &_tmp31_);
#line 83 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
	image = (cairo_surface_t*) _tmp32_;
#line 84 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
	_tmp33_ = filename;
#line 84 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
	_tmp35_ = gala_screenshot_manager_save_image (image, _tmp33_, &_tmp34_);
#line 84 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
	_g_free0 (_vala_filename_used);
#line 84 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
	_vala_filename_used = _tmp34_;
#line 84 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
	_vala_success = _tmp35_;
#line 66 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
	_cairo_surface_destroy0 (image);
#line 66 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
	_g_object_unref0 (window_actor);
#line 66 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
	_g_object_unref0 (window);
#line 66 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
	if (success) {
#line 66 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
		*success = _vala_success;
#line 522 "ScreenshotManager.c"
	}
#line 66 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
	if (filename_used) {
#line 66 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
		*filename_used = _vala_filename_used;
#line 528 "ScreenshotManager.c"
	} else {
#line 66 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
		_g_free0 (_vala_filename_used);
#line 532 "ScreenshotManager.c"
	}
}


void gala_screenshot_manager_select_area (GalaScreenshotManager* self, gint* x, gint* y, gint* width, gint* height, GError** error) {
	gint _vala_x = 0;
	gint _vala_y = 0;
	gint _vala_width = 0;
	gint _vala_height = 0;
	GError* _tmp0_ = NULL;
	GError * _inner_error_ = NULL;
#line 87 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
	g_return_if_fail (self != NULL);
#line 89 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
	g_warning ("ScreenshotManager.vala:89: SelectArea not implemented");
#line 90 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
	_vala_height = 0;
#line 90 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
	_vala_width = _vala_height;
#line 90 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
	_vala_y = _vala_width;
#line 90 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
	_vala_x = _vala_y;
#line 92 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
	_tmp0_ = g_error_new_literal (G_DBUS_ERROR, G_DBUS_ERROR_FAILED, "SelectArea not implemented");
#line 92 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
	_inner_error_ = _tmp0_;
#line 92 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
	if (_inner_error_->domain == G_DBUS_ERROR) {
#line 92 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
		g_propagate_error (error, _inner_error_);
#line 92 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
		return;
#line 566 "ScreenshotManager.c"
	} else {
#line 92 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
		g_critical ("file %s: line %d: uncaught error: %s (%s, %d)", __FILE__, __LINE__, _inner_error_->message, g_quark_to_string (_inner_error_->domain), _inner_error_->code);
#line 92 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
		g_clear_error (&_inner_error_);
#line 92 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
		return;
#line 574 "ScreenshotManager.c"
	}
#line 87 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
	if (x) {
#line 87 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
		*x = _vala_x;
#line 580 "ScreenshotManager.c"
	}
#line 87 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
	if (y) {
#line 87 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
		*y = _vala_y;
#line 586 "ScreenshotManager.c"
	}
#line 87 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
	if (width) {
#line 87 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
		*width = _vala_width;
#line 592 "ScreenshotManager.c"
	}
#line 87 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
	if (height) {
#line 87 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
		*height = _vala_height;
#line 598 "ScreenshotManager.c"
	}
}


static gboolean gala_screenshot_manager_save_image (cairo_surface_t* image, const gchar* filename, gchar** used_filename) {
	gchar* _vala_used_filename = NULL;
	gboolean result = FALSE;
	const gchar* _tmp0_ = NULL;
	gboolean _tmp1_ = FALSE;
	GError * _inner_error_ = NULL;
#line 95 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
	g_return_val_if_fail (image != NULL, FALSE);
#line 95 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
	g_return_val_if_fail (filename != NULL, FALSE);
#line 97 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
	_tmp0_ = filename;
#line 97 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
	_tmp1_ = g_path_is_absolute (_tmp0_);
#line 97 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
	if (!_tmp1_) {
#line 619 "ScreenshotManager.c"
		gchar* path = NULL;
		const gchar* _tmp2_ = NULL;
		gchar* _tmp3_ = NULL;
		const gchar* _tmp4_ = NULL;
		gboolean _tmp5_ = FALSE;
		const gchar* _tmp8_ = NULL;
		gboolean _tmp9_ = FALSE;
#line 98 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
		_tmp2_ = g_get_user_special_dir (G_USER_DIRECTORY_PICTURES);
#line 98 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
		_tmp3_ = g_strdup (_tmp2_);
#line 98 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
		path = _tmp3_;
#line 99 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
		_tmp4_ = path;
#line 99 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
		_tmp5_ = g_file_test (_tmp4_, G_FILE_TEST_EXISTS);
#line 99 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
		if (!_tmp5_) {
#line 639 "ScreenshotManager.c"
			const gchar* _tmp6_ = NULL;
			gchar* _tmp7_ = NULL;
#line 100 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
			_tmp6_ = g_get_home_dir ();
#line 100 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
			_tmp7_ = g_strdup (_tmp6_);
#line 100 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
			_g_free0 (path);
#line 100 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
			path = _tmp7_;
#line 650 "ScreenshotManager.c"
		}
#line 103 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
		_tmp8_ = filename;
#line 103 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
		_tmp9_ = g_str_has_suffix (_tmp8_, ".png");
#line 103 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
		if (!_tmp9_) {
#line 658 "ScreenshotManager.c"
			const gchar* _tmp10_ = NULL;
			const gchar* _tmp11_ = NULL;
			gchar* _tmp12_ = NULL;
			gchar* _tmp13_ = NULL;
			gchar* _tmp14_ = NULL;
#line 104 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
			_tmp10_ = path;
#line 104 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
			_tmp11_ = filename;
#line 104 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
			_tmp12_ = g_strconcat (_tmp11_, ".png", NULL);
#line 104 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
			_tmp13_ = _tmp12_;
#line 104 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
			_tmp14_ = g_build_filename (_tmp10_, _tmp13_, NULL, NULL);
#line 104 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
			_g_free0 (_vala_used_filename);
#line 104 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
			_vala_used_filename = _tmp14_;
#line 104 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
			_g_free0 (_tmp13_);
#line 680 "ScreenshotManager.c"
		} else {
			const gchar* _tmp15_ = NULL;
			const gchar* _tmp16_ = NULL;
			gchar* _tmp17_ = NULL;
#line 106 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
			_tmp15_ = path;
#line 106 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
			_tmp16_ = filename;
#line 106 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
			_tmp17_ = g_build_filename (_tmp15_, _tmp16_, NULL, NULL);
#line 106 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
			_g_free0 (_vala_used_filename);
#line 106 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
			_vala_used_filename = _tmp17_;
#line 695 "ScreenshotManager.c"
		}
#line 97 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
		_g_free0 (path);
#line 699 "ScreenshotManager.c"
	} else {
		const gchar* _tmp18_ = NULL;
		gchar* _tmp19_ = NULL;
#line 109 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
		_tmp18_ = filename;
#line 109 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
		_tmp19_ = g_strdup (_tmp18_);
#line 109 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
		_g_free0 (_vala_used_filename);
#line 109 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
		_vala_used_filename = _tmp19_;
#line 711 "ScreenshotManager.c"
	}
	{
		GdkPixbuf* screenshot = NULL;
		cairo_surface_t* _tmp20_ = NULL;
		cairo_surface_t* _tmp21_ = NULL;
		gint _tmp22_ = 0;
		cairo_surface_t* _tmp23_ = NULL;
		gint _tmp24_ = 0;
		GdkPixbuf* _tmp25_ = NULL;
		const gchar* _tmp26_ = NULL;
#line 113 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
		_tmp20_ = image;
#line 113 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
		_tmp21_ = image;
#line 113 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
		_tmp22_ = cairo_image_surface_get_width (_tmp21_);
#line 113 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
		_tmp23_ = image;
#line 113 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
		_tmp24_ = cairo_image_surface_get_height (_tmp23_);
#line 113 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
		_tmp25_ = gdk_pixbuf_get_from_surface (_tmp20_, 0, 0, _tmp22_, _tmp24_);
#line 113 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
		screenshot = _tmp25_;
#line 114 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
		_tmp26_ = _vala_used_filename;
#line 114 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
		gdk_pixbuf_save (screenshot, _tmp26_, "png", &_inner_error_, NULL);
#line 114 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
		if (G_UNLIKELY (_inner_error_ != NULL)) {
#line 114 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
			_g_object_unref0 (screenshot);
#line 744 "ScreenshotManager.c"
			goto __catch12_g_error;
		}
#line 115 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
		result = TRUE;
#line 115 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
		_g_object_unref0 (screenshot);
#line 115 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
		if (used_filename) {
#line 115 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
			*used_filename = _vala_used_filename;
#line 755 "ScreenshotManager.c"
		} else {
#line 115 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
			_g_free0 (_vala_used_filename);
#line 759 "ScreenshotManager.c"
		}
#line 115 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
		return result;
#line 763 "ScreenshotManager.c"
	}
	goto __finally12;
	__catch12_g_error:
	{
		GError* e = NULL;
#line 112 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
		e = _inner_error_;
#line 112 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
		_inner_error_ = NULL;
#line 117 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
		result = FALSE;
#line 117 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
		_g_error_free0 (e);
#line 117 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
		if (used_filename) {
#line 117 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
			*used_filename = _vala_used_filename;
#line 781 "ScreenshotManager.c"
		} else {
#line 117 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
			_g_free0 (_vala_used_filename);
#line 785 "ScreenshotManager.c"
		}
#line 117 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
		return result;
#line 789 "ScreenshotManager.c"
	}
	__finally12:
#line 112 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
	g_critical ("file %s: line %d: uncaught error: %s (%s, %d)", __FILE__, __LINE__, _inner_error_->message, g_quark_to_string (_inner_error_->domain), _inner_error_->code);
#line 112 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
	g_clear_error (&_inner_error_);
#line 112 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
	return FALSE;
#line 798 "ScreenshotManager.c"
}


static cairo_surface_t* gala_screenshot_manager_take_screenshot (GalaScreenshotManager* self, gint x, gint y, gint width, gint height) {
	cairo_surface_t* result = NULL;
	cairo_surface_t* image = NULL;
	ClutterBackend* backend = NULL;
	ClutterBackend* _tmp0_ = NULL;
	CoglContext* context = NULL;
	CoglContext* _tmp1_ = NULL;
	gint _tmp2_ = 0;
	gint _tmp3_ = 0;
	cairo_surface_t* _tmp4_ = NULL;
	CoglHandle* bitmap = NULL;
	gint _tmp5_ = 0;
	gint _tmp6_ = 0;
	gint _tmp7_ = 0;
	guchar* _tmp8_ = NULL;
	CoglHandle* _tmp9_ = NULL;
	CoglFramebuffer* _tmp10_ = NULL;
	gint _tmp11_ = 0;
	gint _tmp12_ = 0;
#line 121 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
	g_return_val_if_fail (self != NULL, NULL);
#line 135 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
	_tmp0_ = clutter_get_default_backend ();
#line 135 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
	backend = _tmp0_;
#line 136 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
	_tmp1_ = clutter_backend_get_cogl_context (backend);
#line 136 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
	context = _tmp1_;
#line 138 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
	_tmp2_ = width;
#line 138 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
	_tmp3_ = height;
#line 138 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
	_tmp4_ = cairo_image_surface_create (CAIRO_FORMAT_ARGB32, _tmp2_, _tmp3_);
#line 138 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
	_cairo_surface_destroy0 (image);
#line 138 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
	image = _tmp4_;
#line 139 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
	_tmp5_ = width;
#line 139 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
	_tmp6_ = height;
#line 139 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
	_tmp7_ = cairo_image_surface_get_stride (image);
#line 139 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
	_tmp8_ = cairo_image_surface_get_data (image);
#line 139 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
	_tmp9_ = cogl_bitmap_new_for_data (context, _tmp5_, _tmp6_, COGL_PIXEL_FORMAT_BGRA_8888_PRE, _tmp7_, _tmp8_);
#line 139 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
	bitmap = _tmp9_;
#line 140 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
	_tmp10_ = cogl_get_draw_framebuffer ();
#line 140 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
	_tmp11_ = x;
#line 140 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
	_tmp12_ = y;
#line 140 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
	cogl_framebuffer_read_pixels_into_bitmap (_tmp10_, _tmp11_, _tmp12_, COGL_READ_PIXELS_COLOR_BUFFER, bitmap);
#line 141 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
	cairo_surface_mark_dirty (image);
#line 144 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
	result = image;
#line 144 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
	_cogl_handle_unref0 (bitmap);
#line 144 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
	return result;
#line 869 "ScreenshotManager.c"
}


static void gala_screenshot_manager_class_init (GalaScreenshotManagerClass * klass) {
#line 21 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
	gala_screenshot_manager_parent_class = g_type_class_peek_parent (klass);
#line 21 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
	g_type_class_add_private (klass, sizeof (GalaScreenshotManagerPrivate));
#line 21 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
	G_OBJECT_CLASS (klass)->finalize = gala_screenshot_manager_finalize;
#line 880 "ScreenshotManager.c"
}


static void gala_screenshot_manager_instance_init (GalaScreenshotManager * self) {
#line 21 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
	self->priv = GALA_SCREENSHOT_MANAGER_GET_PRIVATE (self);
#line 887 "ScreenshotManager.c"
}


static void gala_screenshot_manager_finalize (GObject* obj) {
	GalaScreenshotManager * self;
#line 21 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
	self = G_TYPE_CHECK_INSTANCE_CAST (obj, GALA_TYPE_SCREENSHOT_MANAGER, GalaScreenshotManager);
#line 34 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
	_g_object_unref0 (self->priv->wm);
#line 21 "/home/nick/work/Enso-OS/galal/src/ScreenshotManager.vala"
	G_OBJECT_CLASS (gala_screenshot_manager_parent_class)->finalize (obj);
#line 899 "ScreenshotManager.c"
}


GType gala_screenshot_manager_get_type (void) {
	static volatile gsize gala_screenshot_manager_type_id__volatile = 0;
	if (g_once_init_enter (&gala_screenshot_manager_type_id__volatile)) {
		static const GTypeInfo g_define_type_info = { sizeof (GalaScreenshotManagerClass), (GBaseInitFunc) NULL, (GBaseFinalizeFunc) NULL, (GClassInitFunc) gala_screenshot_manager_class_init, (GClassFinalizeFunc) NULL, NULL, sizeof (GalaScreenshotManager), 0, (GInstanceInitFunc) gala_screenshot_manager_instance_init, NULL };
		GType gala_screenshot_manager_type_id;
		gala_screenshot_manager_type_id = g_type_register_static (G_TYPE_OBJECT, "GalaScreenshotManager", &g_define_type_info, 0);
		g_type_set_qdata (gala_screenshot_manager_type_id, g_quark_from_static_string ("vala-dbus-register-object"), (void*) gala_screenshot_manager_register_object);
		g_once_init_leave (&gala_screenshot_manager_type_id__volatile, gala_screenshot_manager_type_id);
	}
	return gala_screenshot_manager_type_id__volatile;
}


static void _dbus_gala_screenshot_manager_flash_area (GalaScreenshotManager* self, GVariant* _parameters_, GDBusMethodInvocation* invocation) {
	GError* error = NULL;
	GVariantIter _arguments_iter;
	gint x = 0;
	GVariant* _tmp51_;
	gint y = 0;
	GVariant* _tmp52_;
	gint width = 0;
	GVariant* _tmp53_;
	gint height = 0;
	GVariant* _tmp54_;
	GDBusMessage* _reply_message;
	GVariant* _reply;
	GVariantBuilder _reply_builder;
#line 22 "/home/nick/work/Enso-OS/galal/src/PluginManager.vala"
	g_variant_iter_init (&_arguments_iter, _parameters_);
#line 22 "/home/nick/work/Enso-OS/galal/src/PluginManager.vala"
	_tmp51_ = g_variant_iter_next_value (&_arguments_iter);
#line 22 "/home/nick/work/Enso-OS/galal/src/PluginManager.vala"
	x = g_variant_get_int32 (_tmp51_);
#line 22 "/home/nick/work/Enso-OS/galal/src/PluginManager.vala"
	g_variant_unref (_tmp51_);
#line 22 "/home/nick/work/Enso-OS/galal/src/PluginManager.vala"
	_tmp52_ = g_variant_iter_next_value (&_arguments_iter);
#line 22 "/home/nick/work/Enso-OS/galal/src/PluginManager.vala"
	y = g_variant_get_int32 (_tmp52_);
#line 22 "/home/nick/work/Enso-OS/galal/src/PluginManager.vala"
	g_variant_unref (_tmp52_);
#line 22 "/home/nick/work/Enso-OS/galal/src/PluginManager.vala"
	_tmp53_ = g_variant_iter_next_value (&_arguments_iter);
#line 22 "/home/nick/work/Enso-OS/galal/src/PluginManager.vala"
	width = g_variant_get_int32 (_tmp53_);
#line 22 "/home/nick/work/Enso-OS/galal/src/PluginManager.vala"
	g_variant_unref (_tmp53_);
#line 22 "/home/nick/work/Enso-OS/galal/src/PluginManager.vala"
	_tmp54_ = g_variant_iter_next_value (&_arguments_iter);
#line 22 "/home/nick/work/Enso-OS/galal/src/PluginManager.vala"
	height = g_variant_get_int32 (_tmp54_);
#line 22 "/home/nick/work/Enso-OS/galal/src/PluginManager.vala"
	g_variant_unref (_tmp54_);
#line 22 "/home/nick/work/Enso-OS/galal/src/PluginManager.vala"
	gala_screenshot_manager_flash_area (self, x, y, width, height);
#line 22 "/home/nick/work/Enso-OS/galal/src/PluginManager.vala"
	_reply_message = g_dbus_message_new_method_reply (g_dbus_method_invocation_get_message (invocation));
#line 22 "/home/nick/work/Enso-OS/galal/src/PluginManager.vala"
	g_variant_builder_init (&_reply_builder, G_VARIANT_TYPE_TUPLE);
#line 22 "/home/nick/work/Enso-OS/galal/src/PluginManager.vala"
	_reply = g_variant_builder_end (&_reply_builder);
#line 22 "/home/nick/work/Enso-OS/galal/src/PluginManager.vala"
	g_dbus_message_set_body (_reply_message, _reply);
#line 22 "/home/nick/work/Enso-OS/galal/src/PluginManager.vala"
	g_dbus_connection_send_message (g_dbus_method_invocation_get_connection (invocation), _reply_message, G_DBUS_SEND_MESSAGE_FLAGS_NONE, NULL, NULL);
#line 22 "/home/nick/work/Enso-OS/galal/src/PluginManager.vala"
	g_object_unref (invocation);
#line 22 "/home/nick/work/Enso-OS/galal/src/PluginManager.vala"
	g_object_unref (_reply_message);
#line 972 "ScreenshotManager.c"
}


static void _dbus_gala_screenshot_manager_screenshot (GalaScreenshotManager* self, GVariant* _parameters_, GDBusMethodInvocation* invocation) {
	GError* error = NULL;
	GVariantIter _arguments_iter;
	gboolean include_cursor = FALSE;
	GVariant* _tmp55_;
	gboolean flash = FALSE;
	GVariant* _tmp56_;
	gchar* filename = NULL;
	GVariant* _tmp57_;
	GDBusMessage* _reply_message;
	GVariant* _reply;
	GVariantBuilder _reply_builder;
	gboolean success = FALSE;
	gchar* filename_used = NULL;
#line 22 "/home/nick/work/Enso-OS/galal/src/PluginManager.vala"
	g_variant_iter_init (&_arguments_iter, _parameters_);
#line 22 "/home/nick/work/Enso-OS/galal/src/PluginManager.vala"
	_tmp55_ = g_variant_iter_next_value (&_arguments_iter);
#line 22 "/home/nick/work/Enso-OS/galal/src/PluginManager.vala"
	include_cursor = g_variant_get_boolean (_tmp55_);
#line 22 "/home/nick/work/Enso-OS/galal/src/PluginManager.vala"
	g_variant_unref (_tmp55_);
#line 22 "/home/nick/work/Enso-OS/galal/src/PluginManager.vala"
	_tmp56_ = g_variant_iter_next_value (&_arguments_iter);
#line 22 "/home/nick/work/Enso-OS/galal/src/PluginManager.vala"
	flash = g_variant_get_boolean (_tmp56_);
#line 22 "/home/nick/work/Enso-OS/galal/src/PluginManager.vala"
	g_variant_unref (_tmp56_);
#line 22 "/home/nick/work/Enso-OS/galal/src/PluginManager.vala"
	_tmp57_ = g_variant_iter_next_value (&_arguments_iter);
#line 22 "/home/nick/work/Enso-OS/galal/src/PluginManager.vala"
	filename = g_variant_dup_string (_tmp57_, NULL);
#line 22 "/home/nick/work/Enso-OS/galal/src/PluginManager.vala"
	g_variant_unref (_tmp57_);
#line 22 "/home/nick/work/Enso-OS/galal/src/PluginManager.vala"
	gala_screenshot_manager_screenshot (self, include_cursor, flash, filename, &success, &filename_used);
#line 22 "/home/nick/work/Enso-OS/galal/src/PluginManager.vala"
	_reply_message = g_dbus_message_new_method_reply (g_dbus_method_invocation_get_message (invocation));
#line 22 "/home/nick/work/Enso-OS/galal/src/PluginManager.vala"
	g_variant_builder_init (&_reply_builder, G_VARIANT_TYPE_TUPLE);
#line 22 "/home/nick/work/Enso-OS/galal/src/PluginManager.vala"
	g_variant_builder_add_value (&_reply_builder, g_variant_new_boolean (success));
#line 22 "/home/nick/work/Enso-OS/galal/src/PluginManager.vala"
	g_variant_builder_add_value (&_reply_builder, g_variant_new_string (filename_used));
#line 22 "/home/nick/work/Enso-OS/galal/src/PluginManager.vala"
	_reply = g_variant_builder_end (&_reply_builder);
#line 22 "/home/nick/work/Enso-OS/galal/src/PluginManager.vala"
	g_dbus_message_set_body (_reply_message, _reply);
#line 22 "/home/nick/work/Enso-OS/galal/src/PluginManager.vala"
	_g_free0 (filename);
#line 22 "/home/nick/work/Enso-OS/galal/src/PluginManager.vala"
	_g_free0 (filename_used);
#line 22 "/home/nick/work/Enso-OS/galal/src/PluginManager.vala"
	g_dbus_connection_send_message (g_dbus_method_invocation_get_connection (invocation), _reply_message, G_DBUS_SEND_MESSAGE_FLAGS_NONE, NULL, NULL);
#line 22 "/home/nick/work/Enso-OS/galal/src/PluginManager.vala"
	g_object_unref (invocation);
#line 22 "/home/nick/work/Enso-OS/galal/src/PluginManager.vala"
	g_object_unref (_reply_message);
#line 1034 "ScreenshotManager.c"
}


static void _dbus_gala_screenshot_manager_screenshot_area (GalaScreenshotManager* self, GVariant* _parameters_, GDBusMethodInvocation* invocation) {
	GError* error = NULL;
	GVariantIter _arguments_iter;
	gint x = 0;
	GVariant* _tmp58_;
	gint y = 0;
	GVariant* _tmp59_;
	gint width = 0;
	GVariant* _tmp60_;
	gint height = 0;
	GVariant* _tmp61_;
	gboolean flash = FALSE;
	GVariant* _tmp62_;
	gchar* filename = NULL;
	GVariant* _tmp63_;
	GDBusMessage* _reply_message;
	GVariant* _reply;
	GVariantBuilder _reply_builder;
	gboolean success = FALSE;
	gchar* filename_used = NULL;
#line 22 "/home/nick/work/Enso-OS/galal/src/PluginManager.vala"
	g_variant_iter_init (&_arguments_iter, _parameters_);
#line 22 "/home/nick/work/Enso-OS/galal/src/PluginManager.vala"
	_tmp58_ = g_variant_iter_next_value (&_arguments_iter);
#line 22 "/home/nick/work/Enso-OS/galal/src/PluginManager.vala"
	x = g_variant_get_int32 (_tmp58_);
#line 22 "/home/nick/work/Enso-OS/galal/src/PluginManager.vala"
	g_variant_unref (_tmp58_);
#line 22 "/home/nick/work/Enso-OS/galal/src/PluginManager.vala"
	_tmp59_ = g_variant_iter_next_value (&_arguments_iter);
#line 22 "/home/nick/work/Enso-OS/galal/src/PluginManager.vala"
	y = g_variant_get_int32 (_tmp59_);
#line 22 "/home/nick/work/Enso-OS/galal/src/PluginManager.vala"
	g_variant_unref (_tmp59_);
#line 22 "/home/nick/work/Enso-OS/galal/src/PluginManager.vala"
	_tmp60_ = g_variant_iter_next_value (&_arguments_iter);
#line 22 "/home/nick/work/Enso-OS/galal/src/PluginManager.vala"
	width = g_variant_get_int32 (_tmp60_);
#line 22 "/home/nick/work/Enso-OS/galal/src/PluginManager.vala"
	g_variant_unref (_tmp60_);
#line 22 "/home/nick/work/Enso-OS/galal/src/PluginManager.vala"
	_tmp61_ = g_variant_iter_next_value (&_arguments_iter);
#line 22 "/home/nick/work/Enso-OS/galal/src/PluginManager.vala"
	height = g_variant_get_int32 (_tmp61_);
#line 22 "/home/nick/work/Enso-OS/galal/src/PluginManager.vala"
	g_variant_unref (_tmp61_);
#line 22 "/home/nick/work/Enso-OS/galal/src/PluginManager.vala"
	_tmp62_ = g_variant_iter_next_value (&_arguments_iter);
#line 22 "/home/nick/work/Enso-OS/galal/src/PluginManager.vala"
	flash = g_variant_get_boolean (_tmp62_);
#line 22 "/home/nick/work/Enso-OS/galal/src/PluginManager.vala"
	g_variant_unref (_tmp62_);
#line 22 "/home/nick/work/Enso-OS/galal/src/PluginManager.vala"
	_tmp63_ = g_variant_iter_next_value (&_arguments_iter);
#line 22 "/home/nick/work/Enso-OS/galal/src/PluginManager.vala"
	filename = g_variant_dup_string (_tmp63_, NULL);
#line 22 "/home/nick/work/Enso-OS/galal/src/PluginManager.vala"
	g_variant_unref (_tmp63_);
#line 22 "/home/nick/work/Enso-OS/galal/src/PluginManager.vala"
	gala_screenshot_manager_screenshot_area (self, x, y, width, height, flash, filename, &success, &filename_used, &error);
#line 22 "/home/nick/work/Enso-OS/galal/src/PluginManager.vala"
	if (error) {
#line 22 "/home/nick/work/Enso-OS/galal/src/PluginManager.vala"
		g_dbus_method_invocation_return_gerror (invocation, error);
#line 22 "/home/nick/work/Enso-OS/galal/src/PluginManager.vala"
		return;
#line 1104 "ScreenshotManager.c"
	}
#line 22 "/home/nick/work/Enso-OS/galal/src/PluginManager.vala"
	_reply_message = g_dbus_message_new_method_reply (g_dbus_method_invocation_get_message (invocation));
#line 22 "/home/nick/work/Enso-OS/galal/src/PluginManager.vala"
	g_variant_builder_init (&_reply_builder, G_VARIANT_TYPE_TUPLE);
#line 22 "/home/nick/work/Enso-OS/galal/src/PluginManager.vala"
	g_variant_builder_add_value (&_reply_builder, g_variant_new_boolean (success));
#line 22 "/home/nick/work/Enso-OS/galal/src/PluginManager.vala"
	g_variant_builder_add_value (&_reply_builder, g_variant_new_string (filename_used));
#line 22 "/home/nick/work/Enso-OS/galal/src/PluginManager.vala"
	_reply = g_variant_builder_end (&_reply_builder);
#line 22 "/home/nick/work/Enso-OS/galal/src/PluginManager.vala"
	g_dbus_message_set_body (_reply_message, _reply);
#line 22 "/home/nick/work/Enso-OS/galal/src/PluginManager.vala"
	_g_free0 (filename);
#line 22 "/home/nick/work/Enso-OS/galal/src/PluginManager.vala"
	_g_free0 (filename_used);
#line 22 "/home/nick/work/Enso-OS/galal/src/PluginManager.vala"
	g_dbus_connection_send_message (g_dbus_method_invocation_get_connection (invocation), _reply_message, G_DBUS_SEND_MESSAGE_FLAGS_NONE, NULL, NULL);
#line 22 "/home/nick/work/Enso-OS/galal/src/PluginManager.vala"
	g_object_unref (invocation);
#line 22 "/home/nick/work/Enso-OS/galal/src/PluginManager.vala"
	g_object_unref (_reply_message);
#line 1128 "ScreenshotManager.c"
}


static void _dbus_gala_screenshot_manager_screenshot_window (GalaScreenshotManager* self, GVariant* _parameters_, GDBusMethodInvocation* invocation) {
	GError* error = NULL;
	GVariantIter _arguments_iter;
	gboolean include_frame = FALSE;
	GVariant* _tmp64_;
	gboolean include_cursor = FALSE;
	GVariant* _tmp65_;
	gboolean flash = FALSE;
	GVariant* _tmp66_;
	gchar* filename = NULL;
	GVariant* _tmp67_;
	GDBusMessage* _reply_message;
	GVariant* _reply;
	GVariantBuilder _reply_builder;
	gboolean success = FALSE;
	gchar* filename_used = NULL;
#line 22 "/home/nick/work/Enso-OS/galal/src/PluginManager.vala"
	g_variant_iter_init (&_arguments_iter, _parameters_);
#line 22 "/home/nick/work/Enso-OS/galal/src/PluginManager.vala"
	_tmp64_ = g_variant_iter_next_value (&_arguments_iter);
#line 22 "/home/nick/work/Enso-OS/galal/src/PluginManager.vala"
	include_frame = g_variant_get_boolean (_tmp64_);
#line 22 "/home/nick/work/Enso-OS/galal/src/PluginManager.vala"
	g_variant_unref (_tmp64_);
#line 22 "/home/nick/work/Enso-OS/galal/src/PluginManager.vala"
	_tmp65_ = g_variant_iter_next_value (&_arguments_iter);
#line 22 "/home/nick/work/Enso-OS/galal/src/PluginManager.vala"
	include_cursor = g_variant_get_boolean (_tmp65_);
#line 22 "/home/nick/work/Enso-OS/galal/src/PluginManager.vala"
	g_variant_unref (_tmp65_);
#line 22 "/home/nick/work/Enso-OS/galal/src/PluginManager.vala"
	_tmp66_ = g_variant_iter_next_value (&_arguments_iter);
#line 22 "/home/nick/work/Enso-OS/galal/src/PluginManager.vala"
	flash = g_variant_get_boolean (_tmp66_);
#line 22 "/home/nick/work/Enso-OS/galal/src/PluginManager.vala"
	g_variant_unref (_tmp66_);
#line 22 "/home/nick/work/Enso-OS/galal/src/PluginManager.vala"
	_tmp67_ = g_variant_iter_next_value (&_arguments_iter);
#line 22 "/home/nick/work/Enso-OS/galal/src/PluginManager.vala"
	filename = g_variant_dup_string (_tmp67_, NULL);
#line 22 "/home/nick/work/Enso-OS/galal/src/PluginManager.vala"
	g_variant_unref (_tmp67_);
#line 22 "/home/nick/work/Enso-OS/galal/src/PluginManager.vala"
	gala_screenshot_manager_screenshot_window (self, include_frame, include_cursor, flash, filename, &success, &filename_used);
#line 22 "/home/nick/work/Enso-OS/galal/src/PluginManager.vala"
	_reply_message = g_dbus_message_new_method_reply (g_dbus_method_invocation_get_message (invocation));
#line 22 "/home/nick/work/Enso-OS/galal/src/PluginManager.vala"
	g_variant_builder_init (&_reply_builder, G_VARIANT_TYPE_TUPLE);
#line 22 "/home/nick/work/Enso-OS/galal/src/PluginManager.vala"
	g_variant_builder_add_value (&_reply_builder, g_variant_new_boolean (success));
#line 22 "/home/nick/work/Enso-OS/galal/src/PluginManager.vala"
	g_variant_builder_add_value (&_reply_builder, g_variant_new_string (filename_used));
#line 22 "/home/nick/work/Enso-OS/galal/src/PluginManager.vala"
	_reply = g_variant_builder_end (&_reply_builder);
#line 22 "/home/nick/work/Enso-OS/galal/src/PluginManager.vala"
	g_dbus_message_set_body (_reply_message, _reply);
#line 22 "/home/nick/work/Enso-OS/galal/src/PluginManager.vala"
	_g_free0 (filename);
#line 22 "/home/nick/work/Enso-OS/galal/src/PluginManager.vala"
	_g_free0 (filename_used);
#line 22 "/home/nick/work/Enso-OS/galal/src/PluginManager.vala"
	g_dbus_connection_send_message (g_dbus_method_invocation_get_connection (invocation), _reply_message, G_DBUS_SEND_MESSAGE_FLAGS_NONE, NULL, NULL);
#line 22 "/home/nick/work/Enso-OS/galal/src/PluginManager.vala"
	g_object_unref (invocation);
#line 22 "/home/nick/work/Enso-OS/galal/src/PluginManager.vala"
	g_object_unref (_reply_message);
#line 1198 "ScreenshotManager.c"
}


static void _dbus_gala_screenshot_manager_select_area (GalaScreenshotManager* self, GVariant* _parameters_, GDBusMethodInvocation* invocation) {
	GError* error = NULL;
	GVariantIter _arguments_iter;
	GDBusMessage* _reply_message;
	GVariant* _reply;
	GVariantBuilder _reply_builder;
	gint x = 0;
	gint y = 0;
	gint width = 0;
	gint height = 0;
#line 22 "/home/nick/work/Enso-OS/galal/src/PluginManager.vala"
	g_variant_iter_init (&_arguments_iter, _parameters_);
#line 22 "/home/nick/work/Enso-OS/galal/src/PluginManager.vala"
	gala_screenshot_manager_select_area (self, &x, &y, &width, &height, &error);
#line 22 "/home/nick/work/Enso-OS/galal/src/PluginManager.vala"
	if (error) {
#line 22 "/home/nick/work/Enso-OS/galal/src/PluginManager.vala"
		g_dbus_method_invocation_return_gerror (invocation, error);
#line 22 "/home/nick/work/Enso-OS/galal/src/PluginManager.vala"
		return;
#line 1222 "ScreenshotManager.c"
	}
#line 22 "/home/nick/work/Enso-OS/galal/src/PluginManager.vala"
	_reply_message = g_dbus_message_new_method_reply (g_dbus_method_invocation_get_message (invocation));
#line 22 "/home/nick/work/Enso-OS/galal/src/PluginManager.vala"
	g_variant_builder_init (&_reply_builder, G_VARIANT_TYPE_TUPLE);
#line 22 "/home/nick/work/Enso-OS/galal/src/PluginManager.vala"
	g_variant_builder_add_value (&_reply_builder, g_variant_new_int32 (x));
#line 22 "/home/nick/work/Enso-OS/galal/src/PluginManager.vala"
	g_variant_builder_add_value (&_reply_builder, g_variant_new_int32 (y));
#line 22 "/home/nick/work/Enso-OS/galal/src/PluginManager.vala"
	g_variant_builder_add_value (&_reply_builder, g_variant_new_int32 (width));
#line 22 "/home/nick/work/Enso-OS/galal/src/PluginManager.vala"
	g_variant_builder_add_value (&_reply_builder, g_variant_new_int32 (height));
#line 22 "/home/nick/work/Enso-OS/galal/src/PluginManager.vala"
	_reply = g_variant_builder_end (&_reply_builder);
#line 22 "/home/nick/work/Enso-OS/galal/src/PluginManager.vala"
	g_dbus_message_set_body (_reply_message, _reply);
#line 22 "/home/nick/work/Enso-OS/galal/src/PluginManager.vala"
	g_dbus_connection_send_message (g_dbus_method_invocation_get_connection (invocation), _reply_message, G_DBUS_SEND_MESSAGE_FLAGS_NONE, NULL, NULL);
#line 22 "/home/nick/work/Enso-OS/galal/src/PluginManager.vala"
	g_object_unref (invocation);
#line 22 "/home/nick/work/Enso-OS/galal/src/PluginManager.vala"
	g_object_unref (_reply_message);
#line 1246 "ScreenshotManager.c"
}


static void gala_screenshot_manager_dbus_interface_method_call (GDBusConnection* connection, const gchar* sender, const gchar* object_path, const gchar* interface_name, const gchar* method_name, GVariant* parameters, GDBusMethodInvocation* invocation, gpointer user_data) {
	gpointer* data;
	gpointer object;
	data = user_data;
	object = data[0];
#line 22 "/home/nick/work/Enso-OS/galal/src/PluginManager.vala"
	if (strcmp (method_name, "FlashArea") == 0) {
#line 22 "/home/nick/work/Enso-OS/galal/src/PluginManager.vala"
		_dbus_gala_screenshot_manager_flash_area (object, parameters, invocation);
#line 1259 "ScreenshotManager.c"
	} else if (strcmp (method_name, "Screenshot") == 0) {
#line 22 "/home/nick/work/Enso-OS/galal/src/PluginManager.vala"
		_dbus_gala_screenshot_manager_screenshot (object, parameters, invocation);
#line 1263 "ScreenshotManager.c"
	} else if (strcmp (method_name, "ScreenshotArea") == 0) {
#line 22 "/home/nick/work/Enso-OS/galal/src/PluginManager.vala"
		_dbus_gala_screenshot_manager_screenshot_area (object, parameters, invocation);
#line 1267 "ScreenshotManager.c"
	} else if (strcmp (method_name, "ScreenshotWindow") == 0) {
#line 22 "/home/nick/work/Enso-OS/galal/src/PluginManager.vala"
		_dbus_gala_screenshot_manager_screenshot_window (object, parameters, invocation);
#line 1271 "ScreenshotManager.c"
	} else if (strcmp (method_name, "SelectArea") == 0) {
#line 22 "/home/nick/work/Enso-OS/galal/src/PluginManager.vala"
		_dbus_gala_screenshot_manager_select_area (object, parameters, invocation);
#line 1275 "ScreenshotManager.c"
	} else {
#line 22 "/home/nick/work/Enso-OS/galal/src/PluginManager.vala"
		g_object_unref (invocation);
#line 1279 "ScreenshotManager.c"
	}
}


static GVariant* gala_screenshot_manager_dbus_interface_get_property (GDBusConnection* connection, const gchar* sender, const gchar* object_path, const gchar* interface_name, const gchar* property_name, GError** error, gpointer user_data) {
	gpointer* data;
	gpointer object;
	data = user_data;
	object = data[0];
#line 22 "/home/nick/work/Enso-OS/galal/src/PluginManager.vala"
	return NULL;
#line 1291 "ScreenshotManager.c"
}


static gboolean gala_screenshot_manager_dbus_interface_set_property (GDBusConnection* connection, const gchar* sender, const gchar* object_path, const gchar* interface_name, const gchar* property_name, GVariant* value, GError** error, gpointer user_data) {
	gpointer* data;
	gpointer object;
	data = user_data;
	object = data[0];
#line 22 "/home/nick/work/Enso-OS/galal/src/PluginManager.vala"
	return FALSE;
#line 1302 "ScreenshotManager.c"
}


guint gala_screenshot_manager_register_object (gpointer object, GDBusConnection* connection, const gchar* path, GError** error) {
	guint result;
	gpointer *data;
#line 22 "/home/nick/work/Enso-OS/galal/src/PluginManager.vala"
	data = g_new (gpointer, 3);
#line 22 "/home/nick/work/Enso-OS/galal/src/PluginManager.vala"
	data[0] = g_object_ref (object);
#line 22 "/home/nick/work/Enso-OS/galal/src/PluginManager.vala"
	data[1] = g_object_ref (connection);
#line 22 "/home/nick/work/Enso-OS/galal/src/PluginManager.vala"
	data[2] = g_strdup (path);
#line 22 "/home/nick/work/Enso-OS/galal/src/PluginManager.vala"
	result = g_dbus_connection_register_object (connection, path, (GDBusInterfaceInfo *) (&_gala_screenshot_manager_dbus_interface_info), &_gala_screenshot_manager_dbus_interface_vtable, data, _gala_screenshot_manager_unregister_object, error);
#line 22 "/home/nick/work/Enso-OS/galal/src/PluginManager.vala"
	if (!result) {
#line 22 "/home/nick/work/Enso-OS/galal/src/PluginManager.vala"
		return 0;
#line 1323 "ScreenshotManager.c"
	}
#line 22 "/home/nick/work/Enso-OS/galal/src/PluginManager.vala"
	return result;
#line 1327 "ScreenshotManager.c"
}


static void _gala_screenshot_manager_unregister_object (gpointer user_data) {
	gpointer* data;
	data = user_data;
#line 22 "/home/nick/work/Enso-OS/galal/src/PluginManager.vala"
	g_object_unref (data[0]);
#line 22 "/home/nick/work/Enso-OS/galal/src/PluginManager.vala"
	g_object_unref (data[1]);
#line 22 "/home/nick/work/Enso-OS/galal/src/PluginManager.vala"
	g_free (data[2]);
#line 22 "/home/nick/work/Enso-OS/galal/src/PluginManager.vala"
	g_free (data);
#line 1342 "ScreenshotManager.c"
}



