/* AppEntry.c generated by valac 0.30.1, the Vala compiler
 * generated from AppEntry.vala, do not modify */

/* -*- Mode: vala; indent-tabs-mode: nil; tab-width: 4 -*-*/
/**/
/*  Copyright (C) 2011-2012 Giulio Collura*/
/**/
/*  This program is free software: you can redistribute it and/or modify*/
/*  it under the terms of the GNU General Public License as published by*/
/*  the Free Software Foundation, either version 3 of the License, or*/
/*  (at your option) any later version.*/
/**/
/*  This program is distributed in the hope that it will be useful,*/
/*  but WITHOUT ANY WARRANTY; without even the implied warranty of*/
/*  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the*/
/*  GNU General Public License for more details.*/
/**/
/*  You should have received a copy of the GNU General Public License*/
/*  along with this program.  If not, see <http://www.gnu.org/licenses/>.*/
/**/

#include <glib.h>
#include <glib-object.h>
#include <gtk/gtk.h>
#include <stdlib.h>
#include <string.h>
#include <gio/gio.h>
#include <gdk-pixbuf/gdk-pixbuf.h>
#include <plank.h>
#include <gdk/gdk.h>
#include <float.h>
#include <math.h>
#include <pango/pango.h>
#include <gee.h>
#include <glib/gi18n-lib.h>


#define PANTHER_WIDGETS_TYPE_APP_ENTRY (panther_widgets_app_entry_get_type ())
#define PANTHER_WIDGETS_APP_ENTRY(obj) (G_TYPE_CHECK_INSTANCE_CAST ((obj), PANTHER_WIDGETS_TYPE_APP_ENTRY, PantherWidgetsAppEntry))
#define PANTHER_WIDGETS_APP_ENTRY_CLASS(klass) (G_TYPE_CHECK_CLASS_CAST ((klass), PANTHER_WIDGETS_TYPE_APP_ENTRY, PantherWidgetsAppEntryClass))
#define PANTHER_WIDGETS_IS_APP_ENTRY(obj) (G_TYPE_CHECK_INSTANCE_TYPE ((obj), PANTHER_WIDGETS_TYPE_APP_ENTRY))
#define PANTHER_WIDGETS_IS_APP_ENTRY_CLASS(klass) (G_TYPE_CHECK_CLASS_TYPE ((klass), PANTHER_WIDGETS_TYPE_APP_ENTRY))
#define PANTHER_WIDGETS_APP_ENTRY_GET_CLASS(obj) (G_TYPE_INSTANCE_GET_CLASS ((obj), PANTHER_WIDGETS_TYPE_APP_ENTRY, PantherWidgetsAppEntryClass))

typedef struct _PantherWidgetsAppEntry PantherWidgetsAppEntry;
typedef struct _PantherWidgetsAppEntryClass PantherWidgetsAppEntryClass;
typedef struct _PantherWidgetsAppEntryPrivate PantherWidgetsAppEntryPrivate;

#define PANTHER_BACKEND_TYPE_APP (panther_backend_app_get_type ())
#define PANTHER_BACKEND_APP(obj) (G_TYPE_CHECK_INSTANCE_CAST ((obj), PANTHER_BACKEND_TYPE_APP, PantherBackendApp))
#define PANTHER_BACKEND_APP_CLASS(klass) (G_TYPE_CHECK_CLASS_CAST ((klass), PANTHER_BACKEND_TYPE_APP, PantherBackendAppClass))
#define PANTHER_BACKEND_IS_APP(obj) (G_TYPE_CHECK_INSTANCE_TYPE ((obj), PANTHER_BACKEND_TYPE_APP))
#define PANTHER_BACKEND_IS_APP_CLASS(klass) (G_TYPE_CHECK_CLASS_TYPE ((klass), PANTHER_BACKEND_TYPE_APP))
#define PANTHER_BACKEND_APP_GET_CLASS(obj) (G_TYPE_INSTANCE_GET_CLASS ((obj), PANTHER_BACKEND_TYPE_APP, PantherBackendAppClass))

typedef struct _PantherBackendApp PantherBackendApp;
typedef struct _PantherBackendAppClass PantherBackendAppClass;

#define PANTHER_BACKEND_TYPE_APP_SYSTEM (panther_backend_app_system_get_type ())
#define PANTHER_BACKEND_APP_SYSTEM(obj) (G_TYPE_CHECK_INSTANCE_CAST ((obj), PANTHER_BACKEND_TYPE_APP_SYSTEM, PantherBackendAppSystem))
#define PANTHER_BACKEND_APP_SYSTEM_CLASS(klass) (G_TYPE_CHECK_CLASS_CAST ((klass), PANTHER_BACKEND_TYPE_APP_SYSTEM, PantherBackendAppSystemClass))
#define PANTHER_BACKEND_IS_APP_SYSTEM(obj) (G_TYPE_CHECK_INSTANCE_TYPE ((obj), PANTHER_BACKEND_TYPE_APP_SYSTEM))
#define PANTHER_BACKEND_IS_APP_SYSTEM_CLASS(klass) (G_TYPE_CHECK_CLASS_TYPE ((klass), PANTHER_BACKEND_TYPE_APP_SYSTEM))
#define PANTHER_BACKEND_APP_SYSTEM_GET_CLASS(obj) (G_TYPE_INSTANCE_GET_CLASS ((obj), PANTHER_BACKEND_TYPE_APP_SYSTEM, PantherBackendAppSystemClass))

typedef struct _PantherBackendAppSystem PantherBackendAppSystem;
typedef struct _PantherBackendAppSystemClass PantherBackendAppSystemClass;
#define _g_object_unref0(var) ((var == NULL) ? NULL : (var = (g_object_unref (var), NULL)))
#define _g_free0(var) (var = (g_free (var), NULL))
typedef struct _Block4Data Block4Data;

#define PANTHER_TYPE_SETTINGS (panther_settings_get_type ())
#define PANTHER_SETTINGS(obj) (G_TYPE_CHECK_INSTANCE_CAST ((obj), PANTHER_TYPE_SETTINGS, PantherSettings))
#define PANTHER_SETTINGS_CLASS(klass) (G_TYPE_CHECK_CLASS_CAST ((klass), PANTHER_TYPE_SETTINGS, PantherSettingsClass))
#define PANTHER_IS_SETTINGS(obj) (G_TYPE_CHECK_INSTANCE_TYPE ((obj), PANTHER_TYPE_SETTINGS))
#define PANTHER_IS_SETTINGS_CLASS(klass) (G_TYPE_CHECK_CLASS_TYPE ((klass), PANTHER_TYPE_SETTINGS))
#define PANTHER_SETTINGS_GET_CLASS(obj) (G_TYPE_INSTANCE_GET_CLASS ((obj), PANTHER_TYPE_SETTINGS, PantherSettingsClass))

typedef struct _PantherSettings PantherSettings;
typedef struct _PantherSettingsClass PantherSettingsClass;
#define _g_list_free0(var) ((var == NULL) ? NULL : (var = (g_list_free (var), NULL)))

#define PANTHER_TYPE_PANTHER_VIEW (panther_panther_view_get_type ())
#define PANTHER_PANTHER_VIEW(obj) (G_TYPE_CHECK_INSTANCE_CAST ((obj), PANTHER_TYPE_PANTHER_VIEW, PantherPantherView))
#define PANTHER_PANTHER_VIEW_CLASS(klass) (G_TYPE_CHECK_CLASS_CAST ((klass), PANTHER_TYPE_PANTHER_VIEW, PantherPantherViewClass))
#define PANTHER_IS_PANTHER_VIEW(obj) (G_TYPE_CHECK_INSTANCE_TYPE ((obj), PANTHER_TYPE_PANTHER_VIEW))
#define PANTHER_IS_PANTHER_VIEW_CLASS(klass) (G_TYPE_CHECK_CLASS_TYPE ((klass), PANTHER_TYPE_PANTHER_VIEW))
#define PANTHER_PANTHER_VIEW_GET_CLASS(obj) (G_TYPE_INSTANCE_GET_CLASS ((obj), PANTHER_TYPE_PANTHER_VIEW, PantherPantherViewClass))

typedef struct _PantherPantherView PantherPantherView;
typedef struct _PantherPantherViewClass PantherPantherViewClass;
#define _g_error_free0(var) ((var == NULL) ? NULL : (var = (g_error_free (var), NULL)))
typedef struct _Block5Data Block5Data;
#define _g_key_file_free0(var) ((var == NULL) ? NULL : (var = (g_key_file_free (var), NULL)))

struct _PantherWidgetsAppEntry {
	GtkButton parent_instance;
	PantherWidgetsAppEntryPrivate * priv;
	GtkLabel* app_label;
	gchar* exec_name;
	gchar* app_name;
	gchar* desktop_id;
	gint icon_size;
	gchar* desktop_path;
	GFile* launchers_dir;
};

struct _PantherWidgetsAppEntryClass {
	GtkButtonClass parent_class;
};

struct _PantherWidgetsAppEntryPrivate {
	GdkPixbuf* icon;
	GtkImage* image;
	gboolean dragging;
	PantherBackendApp* application;
	PantherBackendAppSystem* app_system;
	gboolean docked;
	gchar* desktop_uri;
};

struct _Block4Data {
	int _ref_count_;
	PantherWidgetsAppEntry* self;
	PantherBackendApp* app;
};

struct _Block5Data {
	int _ref_count_;
	PantherWidgetsAppEntry* self;
	gchar* action;
};


static gpointer panther_widgets_app_entry_parent_class = NULL;
static GtkMenu* panther_widgets_app_entry_menu;
static GtkMenu* panther_widgets_app_entry_menu = NULL;
static PlankDBusClient* panther_widgets_app_entry_plank_client;
static PlankDBusClient* panther_widgets_app_entry_plank_client = NULL;
extern gint panther_pixels_ITEM_SIZE;

GType panther_widgets_app_entry_get_type (void) G_GNUC_CONST;
GType panther_backend_app_get_type (void) G_GNUC_CONST;
GType panther_backend_app_system_get_type (void) G_GNUC_CONST;
#define PANTHER_WIDGETS_APP_ENTRY_GET_PRIVATE(o) (G_TYPE_INSTANCE_GET_PRIVATE ((o), PANTHER_WIDGETS_TYPE_APP_ENTRY, PantherWidgetsAppEntryPrivate))
enum  {
	PANTHER_WIDGETS_APP_ENTRY_DUMMY_PROPERTY
};
PantherWidgetsAppEntry* panther_widgets_app_entry_new (PantherBackendApp* app);
PantherWidgetsAppEntry* panther_widgets_app_entry_construct (GType object_type, PantherBackendApp* app);
static Block4Data* block4_data_ref (Block4Data* _data4_);
static void block4_data_unref (void * _userdata_);
const gchar* panther_backend_app_get_desktop_id (PantherBackendApp* self);
const gchar* panther_backend_app_get_desktop_path (PantherBackendApp* self);
const gchar* panther_backend_app_get_name (PantherBackendApp* self);
const gchar* panther_backend_app_get_description (PantherBackendApp* self);
const gchar* panther_backend_app_get_exec (PantherBackendApp* self);
GType panther_settings_get_type (void) G_GNUC_CONST;
PantherSettings* panther_panther_get_settings (void);
gint panther_settings_get_icon_size (PantherSettings* self);
GdkPixbuf* panther_backend_app_get_icon (PantherBackendApp* self);
gdouble panther_settings_get_font_size (PantherSettings* self);
void panther_widgets_app_entry_launch_app (PantherWidgetsAppEntry* self);
static void _panther_widgets_app_entry_launch_app_gtk_button_clicked (GtkButton* _sender, gpointer self);
static gboolean __lambda22_ (PantherWidgetsAppEntry* self, GdkEventButton* e);
static void panther_widgets_app_entry_create_menu (PantherWidgetsAppEntry* self);
static gboolean ___lambda22__gtk_widget_button_press_event (GtkWidget* _sender, GdkEventButton* event, gpointer self);
static void __lambda28_ (PantherWidgetsAppEntry* self, GdkDragContext* ctx);
static void ___lambda28__gtk_widget_drag_begin (GtkWidget* _sender, GdkDragContext* context, gpointer self);
static void __lambda29_ (PantherWidgetsAppEntry* self);
GType panther_panther_view_get_type (void) G_GNUC_CONST;
void panther_panther_view_grab_device (PantherPantherView* self);
static void ___lambda29__gtk_widget_drag_end (GtkWidget* _sender, GdkDragContext* context, gpointer self);
static void __lambda30_ (PantherWidgetsAppEntry* self, GdkDragContext* ctx, GtkSelectionData* sel, guint info, guint time);
static void ___lambda30__gtk_widget_drag_data_get (GtkWidget* _sender, GdkDragContext* context, GtkSelectionData* selection_data, guint info, guint time_, gpointer self);
static void __lambda31_ (Block4Data* _data4_);
static void ___lambda31__panther_backend_app_icon_changed (PantherBackendApp* _sender, gpointer self);
static void panther_widgets_app_entry_real_get_preferred_width (GtkWidget* base, gint* minimum_width, gint* natural_width);
static void panther_widgets_app_entry_real_get_preferred_height (GtkWidget* base, gint* minimum_height, gint* natural_height);
gboolean panther_backend_app_launch (PantherBackendApp* self);
GeeArrayList* panther_backend_app_get_actions (PantherBackendApp* self);
void panther_backend_app_init_actions (PantherBackendApp* self, GError** error);
static void __lambda23_ (PantherWidgetsAppEntry* self);
static void ___lambda23__gtk_widget_hide (GtkWidget* _sender, gpointer self);
static Block5Data* block5_data_ref (Block5Data* _data5_);
static void block5_data_unref (void * _userdata_);
static void ____lambda25_ (Block5Data* _data5_);
GeeHashMap* panther_backend_app_get_actions_map (PantherBackendApp* self);
static void _____lambda25__gtk_menu_item_activate (GtkMenuItem* _sender, gpointer self);
static GtkMenuItem* panther_widgets_app_entry_get_saved_menuitem (PantherWidgetsAppEntry* self);
static GtkMenuItem* panther_widgets_app_entry_get_plank_menuitem (PantherWidgetsAppEntry* self);
static gboolean _vala_string_array_contains (gchar** stack, int stack_length, gchar* needle);
static void panther_widgets_app_entry_plank_menuitem_activate (PantherWidgetsAppEntry* self);
static void _panther_widgets_app_entry_plank_menuitem_activate_gtk_menu_item_activate (GtkMenuItem* _sender, gpointer self);
gboolean panther_panther_view_get_cat_saved (PantherPantherView* self);
static void panther_widgets_app_entry_saved_menuitem_activate (PantherWidgetsAppEntry* self);
static void _panther_widgets_app_entry_saved_menuitem_activate_gtk_menu_item_activate (GtkMenuItem* _sender, gpointer self);
static void panther_widgets_app_entry_remove_saved_item (PantherWidgetsAppEntry* self);
static void panther_widgets_app_entry_add_saved_item (PantherWidgetsAppEntry* self);
void panther_panther_view_add_saved (PantherPantherView* self, const gchar* app);
static void panther_widgets_app_entry_finalize (GObject* obj);
static void _vala_array_destroy (gpointer array, gint array_length, GDestroyNotify destroy_func);
static void _vala_array_free (gpointer array, gint array_length, GDestroyNotify destroy_func);
static gint _vala_array_length (gpointer array);


static gpointer _g_object_ref0 (gpointer self) {
	return self ? g_object_ref (self) : NULL;
}


static Block4Data* block4_data_ref (Block4Data* _data4_) {
	g_atomic_int_inc (&_data4_->_ref_count_);
	return _data4_;
}


static void block4_data_unref (void * _userdata_) {
	Block4Data* _data4_;
	_data4_ = (Block4Data*) _userdata_;
	if (g_atomic_int_dec_and_test (&_data4_->_ref_count_)) {
		PantherWidgetsAppEntry* self;
		self = _data4_->self;
		_g_object_unref0 (_data4_->app);
		_g_object_unref0 (self);
		g_slice_free (Block4Data, _data4_);
	}
}


static void _panther_widgets_app_entry_launch_app_gtk_button_clicked (GtkButton* _sender, gpointer self) {
	panther_widgets_app_entry_launch_app ((PantherWidgetsAppEntry*) self);
}


static gboolean __lambda22_ (PantherWidgetsAppEntry* self, GdkEventButton* e) {
	gboolean result = FALSE;
	GdkEventButton* _tmp0_ = NULL;
	guint _tmp1_ = 0U;
	gboolean _tmp2_ = FALSE;
	GtkMenu* _tmp3_ = NULL;
	g_return_val_if_fail (e != NULL, FALSE);
	_tmp0_ = e;
	_tmp1_ = _tmp0_->button;
	if (_tmp1_ != ((guint) GDK_BUTTON_SECONDARY)) {
		result = FALSE;
		return result;
	}
	panther_widgets_app_entry_create_menu (self);
	_tmp3_ = panther_widgets_app_entry_menu;
	if (_tmp3_ != NULL) {
		GtkMenu* _tmp4_ = NULL;
		GList* _tmp5_ = NULL;
		GList* _tmp6_ = NULL;
		_tmp4_ = panther_widgets_app_entry_menu;
		_tmp5_ = gtk_container_get_children ((GtkContainer*) _tmp4_);
		_tmp6_ = _tmp5_;
		_tmp2_ = _tmp6_ != NULL;
		_g_list_free0 (_tmp6_);
	} else {
		_tmp2_ = FALSE;
	}
	if (_tmp2_) {
		GtkMenu* _tmp7_ = NULL;
		GdkEventButton* _tmp8_ = NULL;
		guint _tmp9_ = 0U;
		GdkEventButton* _tmp10_ = NULL;
		guint32 _tmp11_ = 0U;
		_tmp7_ = panther_widgets_app_entry_menu;
		_tmp8_ = e;
		_tmp9_ = _tmp8_->button;
		_tmp10_ = e;
		_tmp11_ = _tmp10_->time;
		gtk_menu_popup (_tmp7_, NULL, NULL, NULL, NULL, _tmp9_, _tmp11_);
		result = TRUE;
		return result;
	}
	result = FALSE;
	return result;
}


static gboolean ___lambda22__gtk_widget_button_press_event (GtkWidget* _sender, GdkEventButton* event, gpointer self) {
	gboolean result;
	result = __lambda22_ ((PantherWidgetsAppEntry*) self, event);
	return result;
}


static void __lambda28_ (PantherWidgetsAppEntry* self, GdkDragContext* ctx) {
	GdkDragContext* _tmp0_ = NULL;
	GdkPixbuf* _tmp1_ = NULL;
	g_return_if_fail (ctx != NULL);
	self->priv->dragging = TRUE;
	_tmp0_ = ctx;
	_tmp1_ = self->priv->icon;
	gtk_drag_set_icon_pixbuf (_tmp0_, _tmp1_, 0, 0);
}


static void ___lambda28__gtk_widget_drag_begin (GtkWidget* _sender, GdkDragContext* context, gpointer self) {
	__lambda28_ ((PantherWidgetsAppEntry*) self, context);
}


static void __lambda29_ (PantherWidgetsAppEntry* self) {
	GtkApplication* panther_app = NULL;
	GApplication* _tmp0_ = NULL;
	GtkApplication* _tmp1_ = NULL;
	GtkWindow* _tmp2_ = NULL;
	GtkWindow* _tmp3_ = NULL;
	self->priv->dragging = FALSE;
	_tmp0_ = g_application_get_default ();
	_tmp1_ = _g_object_ref0 (G_TYPE_CHECK_INSTANCE_CAST (_tmp0_, gtk_application_get_type (), GtkApplication));
	panther_app = _tmp1_;
	_tmp2_ = gtk_application_get_active_window (panther_app);
	_tmp3_ = _tmp2_;
	panther_panther_view_grab_device (G_TYPE_CHECK_INSTANCE_CAST (_tmp3_, PANTHER_TYPE_PANTHER_VIEW, PantherPantherView));
	_g_object_unref0 (panther_app);
}


static void ___lambda29__gtk_widget_drag_end (GtkWidget* _sender, GdkDragContext* context, gpointer self) {
	__lambda29_ ((PantherWidgetsAppEntry*) self);
}


static void __lambda30_ (PantherWidgetsAppEntry* self, GdkDragContext* ctx, GtkSelectionData* sel, guint info, guint time) {
	GtkSelectionData* _tmp0_ = NULL;
	const gchar* _tmp1_ = NULL;
	GFile* _tmp2_ = NULL;
	GFile* _tmp3_ = NULL;
	gchar* _tmp4_ = NULL;
	gchar** _tmp5_ = NULL;
	gchar** _tmp6_ = NULL;
	gint _tmp6__length1 = 0;
	g_return_if_fail (ctx != NULL);
	g_return_if_fail (sel != NULL);
	_tmp0_ = sel;
	_tmp1_ = self->desktop_path;
	_tmp2_ = g_file_new_for_path (_tmp1_);
	_tmp3_ = _tmp2_;
	_tmp4_ = g_file_get_uri (_tmp3_);
	_tmp5_ = g_new0 (gchar*, 1 + 1);
	_tmp5_[0] = _tmp4_;
	_tmp6_ = _tmp5_;
	_tmp6__length1 = 1;
	gtk_selection_data_set_uris (_tmp0_, _tmp6_);
	_tmp6_ = (_vala_array_free (_tmp6_, _tmp6__length1, (GDestroyNotify) g_free), NULL);
	_g_object_unref0 (_tmp3_);
}


static void ___lambda30__gtk_widget_drag_data_get (GtkWidget* _sender, GdkDragContext* context, GtkSelectionData* selection_data, guint info, guint time_, gpointer self) {
	__lambda30_ ((PantherWidgetsAppEntry*) self, context, selection_data, info, time_);
}


static void __lambda31_ (Block4Data* _data4_) {
	PantherWidgetsAppEntry* self;
	PantherBackendApp* _tmp0_ = NULL;
	GdkPixbuf* _tmp1_ = NULL;
	GdkPixbuf* _tmp2_ = NULL;
	GdkPixbuf* _tmp3_ = NULL;
	GtkImage* _tmp4_ = NULL;
	GdkPixbuf* _tmp5_ = NULL;
	self = _data4_->self;
	_tmp0_ = _data4_->app;
	_tmp1_ = panther_backend_app_get_icon (_tmp0_);
	_tmp2_ = _tmp1_;
	_tmp3_ = _g_object_ref0 (_tmp2_);
	_g_object_unref0 (self->priv->icon);
	self->priv->icon = _tmp3_;
	_tmp4_ = self->priv->image;
	_tmp5_ = self->priv->icon;
	gtk_image_set_from_pixbuf (_tmp4_, _tmp5_);
}


static void ___lambda31__panther_backend_app_icon_changed (PantherBackendApp* _sender, gpointer self) {
	__lambda31_ (self);
}


PantherWidgetsAppEntry* panther_widgets_app_entry_construct (GType object_type, PantherBackendApp* app) {
	PantherWidgetsAppEntry * self = NULL;
	Block4Data* _data4_;
	PantherBackendApp* _tmp0_ = NULL;
	PantherBackendApp* _tmp1_ = NULL;
	GtkTargetEntry dnd = {0};
	GtkTargetEntry _tmp2_ = {0};
	GtkTargetEntry _tmp3_ = {0};
	GtkTargetEntry* _tmp4_ = NULL;
	GtkTargetEntry* _tmp5_ = NULL;
	gint _tmp5__length1 = 0;
	PantherBackendApp* _tmp6_ = NULL;
	const gchar* _tmp7_ = NULL;
	const gchar* _tmp8_ = NULL;
	gchar* _tmp9_ = NULL;
	PantherBackendApp* _tmp10_ = NULL;
	const gchar* _tmp11_ = NULL;
	const gchar* _tmp12_ = NULL;
	gchar* _tmp13_ = NULL;
	const gchar* _tmp14_ = NULL;
	GFile* _tmp15_ = NULL;
	GFile* _tmp16_ = NULL;
	gchar* _tmp17_ = NULL;
	PantherBackendApp* _tmp18_ = NULL;
	PantherBackendApp* _tmp19_ = NULL;
	PantherBackendApp* _tmp20_ = NULL;
	const gchar* _tmp21_ = NULL;
	const gchar* _tmp22_ = NULL;
	gchar* _tmp23_ = NULL;
	PantherBackendApp* _tmp24_ = NULL;
	const gchar* _tmp25_ = NULL;
	const gchar* _tmp26_ = NULL;
	PantherBackendApp* _tmp27_ = NULL;
	const gchar* _tmp28_ = NULL;
	const gchar* _tmp29_ = NULL;
	gchar* _tmp30_ = NULL;
	PantherSettings* _tmp31_ = NULL;
	PantherSettings* _tmp32_ = NULL;
	gint _tmp33_ = 0;
	gint _tmp34_ = 0;
	PantherBackendApp* _tmp35_ = NULL;
	GdkPixbuf* _tmp36_ = NULL;
	GdkPixbuf* _tmp37_ = NULL;
	GdkPixbuf* _tmp38_ = NULL;
	GtkStyleContext* _tmp39_ = NULL;
	PantherSettings* _tmp40_ = NULL;
	PantherSettings* _tmp41_ = NULL;
	gdouble _tmp42_ = 0.0;
	gdouble _tmp43_ = 0.0;
	GtkLabel* _tmp56_ = NULL;
	GtkLabel* _tmp57_ = NULL;
	GtkLabel* _tmp58_ = NULL;
	GtkLabel* _tmp59_ = NULL;
	GtkLabel* _tmp60_ = NULL;
	GtkLabel* _tmp61_ = NULL;
	GdkPixbuf* _tmp62_ = NULL;
	GtkImage* _tmp63_ = NULL;
	GtkImage* _tmp64_ = NULL;
	gint _tmp65_ = 0;
	GtkImage* _tmp66_ = NULL;
	GtkGrid* grid = NULL;
	GtkGrid* _tmp67_ = NULL;
	GtkImage* _tmp68_ = NULL;
	GtkLabel* _tmp69_ = NULL;
	gint _tmp70_ = 0;
	gint _tmp71_ = 0;
	PantherBackendApp* _tmp72_ = NULL;
	g_return_val_if_fail (app != NULL, NULL);
	_data4_ = g_slice_new0 (Block4Data);
	_data4_->_ref_count_ = 1;
	_tmp0_ = app;
	_tmp1_ = _g_object_ref0 (_tmp0_);
	_g_object_unref0 (_data4_->app);
	_data4_->app = _tmp1_;
	self = (PantherWidgetsAppEntry*) g_object_new (object_type, NULL);
	_data4_->self = g_object_ref (self);
	_tmp2_.target = "text/uri-list";
	_tmp2_.flags = (guint) 0;
	_tmp2_.info = (guint) 0;
	dnd = _tmp2_;
	_tmp3_ = dnd;
	_tmp4_ = g_new0 (GtkTargetEntry, 1);
	_tmp4_[0] = _tmp3_;
	_tmp5_ = _tmp4_;
	_tmp5__length1 = 1;
	gtk_drag_source_set ((GtkWidget*) self, GDK_BUTTON1_MASK, _tmp5_, 1, GDK_ACTION_COPY);
	_tmp5_ = (g_free (_tmp5_), NULL);
	_tmp6_ = _data4_->app;
	_tmp7_ = panther_backend_app_get_desktop_id (_tmp6_);
	_tmp8_ = _tmp7_;
	_tmp9_ = g_strdup (_tmp8_);
	_g_free0 (self->desktop_id);
	self->desktop_id = _tmp9_;
	_tmp10_ = _data4_->app;
	_tmp11_ = panther_backend_app_get_desktop_path (_tmp10_);
	_tmp12_ = _tmp11_;
	_tmp13_ = g_strdup (_tmp12_);
	_g_free0 (self->desktop_path);
	self->desktop_path = _tmp13_;
	_tmp14_ = self->desktop_path;
	_tmp15_ = g_file_new_for_path (_tmp14_);
	_tmp16_ = _tmp15_;
	_tmp17_ = g_file_get_uri (_tmp16_);
	_g_free0 (self->priv->desktop_uri);
	self->priv->desktop_uri = _tmp17_;
	_g_object_unref0 (_tmp16_);
	_tmp18_ = _data4_->app;
	_tmp19_ = _g_object_ref0 (_tmp18_);
	_g_object_unref0 (self->priv->application);
	self->priv->application = _tmp19_;
	_tmp20_ = _data4_->app;
	_tmp21_ = panther_backend_app_get_name (_tmp20_);
	_tmp22_ = _tmp21_;
	_tmp23_ = g_strdup (_tmp22_);
	_g_free0 (self->app_name);
	self->app_name = _tmp23_;
	_tmp24_ = _data4_->app;
	_tmp25_ = panther_backend_app_get_description (_tmp24_);
	_tmp26_ = _tmp25_;
	gtk_widget_set_tooltip_text ((GtkWidget*) self, _tmp26_);
	_tmp27_ = _data4_->app;
	_tmp28_ = panther_backend_app_get_exec (_tmp27_);
	_tmp29_ = _tmp28_;
	_tmp30_ = g_strdup (_tmp29_);
	_g_free0 (self->exec_name);
	self->exec_name = _tmp30_;
	_tmp31_ = panther_panther_get_settings ();
	_tmp32_ = _tmp31_;
	_tmp33_ = panther_settings_get_icon_size (_tmp32_);
	_tmp34_ = _tmp33_;
	self->icon_size = _tmp34_;
	_tmp35_ = _data4_->app;
	_tmp36_ = panther_backend_app_get_icon (_tmp35_);
	_tmp37_ = _tmp36_;
	_tmp38_ = _g_object_ref0 (_tmp37_);
	_g_object_unref0 (self->priv->icon);
	self->priv->icon = _tmp38_;
	_tmp39_ = gtk_widget_get_style_context ((GtkWidget*) self);
	gtk_style_context_add_class (_tmp39_, GTK_STYLE_CLASS_FLAT);
	_tmp40_ = panther_panther_get_settings ();
	_tmp41_ = _tmp40_;
	_tmp42_ = panther_settings_get_font_size (_tmp41_);
	_tmp43_ = _tmp42_;
	if (_tmp43_ <= 0.001) {
		const gchar* _tmp44_ = NULL;
		GtkLabel* _tmp45_ = NULL;
		GtkLabel* _tmp46_ = NULL;
		_tmp44_ = self->app_name;
		_tmp45_ = (GtkLabel*) gtk_label_new (_tmp44_);
		g_object_ref_sink (_tmp45_);
		_g_object_unref0 (self->app_label);
		self->app_label = _tmp45_;
		_tmp46_ = self->app_label;
		gtk_label_set_use_markup (_tmp46_, FALSE);
	} else {
		gchar* texto = NULL;
		PantherSettings* _tmp47_ = NULL;
		PantherSettings* _tmp48_ = NULL;
		gdouble _tmp49_ = 0.0;
		gdouble _tmp50_ = 0.0;
		const gchar* _tmp51_ = NULL;
		gchar* _tmp52_ = NULL;
		GtkLabel* _tmp53_ = NULL;
		GtkLabel* _tmp54_ = NULL;
		const gchar* _tmp55_ = NULL;
		_tmp47_ = panther_panther_get_settings ();
		_tmp48_ = _tmp47_;
		_tmp49_ = panther_settings_get_font_size (_tmp48_);
		_tmp50_ = _tmp49_;
		_tmp51_ = self->app_name;
		_tmp52_ = g_strdup_printf ("<span font_size=\"%d\">%s</span>", (gint) (_tmp50_ * 1000), _tmp51_);
		texto = _tmp52_;
		_tmp53_ = (GtkLabel*) gtk_label_new (NULL);
		g_object_ref_sink (_tmp53_);
		_g_object_unref0 (self->app_label);
		self->app_label = _tmp53_;
		_tmp54_ = self->app_label;
		_tmp55_ = texto;
		gtk_label_set_markup (_tmp54_, _tmp55_);
		_g_free0 (texto);
	}
	_tmp56_ = self->app_label;
	gtk_widget_set_halign ((GtkWidget*) _tmp56_, GTK_ALIGN_CENTER);
	_tmp57_ = self->app_label;
	gtk_label_set_justify (_tmp57_, GTK_JUSTIFY_CENTER);
	_tmp58_ = self->app_label;
	gtk_label_set_line_wrap (_tmp58_, TRUE);
	_tmp59_ = self->app_label;
	gtk_label_set_lines (_tmp59_, 2);
	_tmp60_ = self->app_label;
	gtk_label_set_single_line_mode (_tmp60_, FALSE);
	_tmp61_ = self->app_label;
	gtk_label_set_ellipsize (_tmp61_, PANGO_ELLIPSIZE_END);
	_tmp62_ = self->priv->icon;
	_tmp63_ = (GtkImage*) gtk_image_new_from_pixbuf (_tmp62_);
	g_object_ref_sink (_tmp63_);
	_g_object_unref0 (self->priv->image);
	self->priv->image = _tmp63_;
	_tmp64_ = self->priv->image;
	_tmp65_ = self->icon_size;
	g_object_set (_tmp64_, "icon-size", _tmp65_, NULL);
	_tmp66_ = self->priv->image;
	gtk_widget_set_margin_top ((GtkWidget*) _tmp66_, 12);
	_tmp67_ = (GtkGrid*) gtk_grid_new ();
	g_object_ref_sink (_tmp67_);
	grid = _tmp67_;
	gtk_orientable_set_orientation ((GtkOrientable*) grid, GTK_ORIENTATION_VERTICAL);
	gtk_grid_set_row_spacing (grid, 6);
	g_object_set ((GtkWidget*) grid, "expand", TRUE, NULL);
	gtk_widget_set_halign ((GtkWidget*) grid, GTK_ALIGN_CENTER);
	_tmp68_ = self->priv->image;
	gtk_container_add ((GtkContainer*) grid, (GtkWidget*) _tmp68_);
	_tmp69_ = self->app_label;
	gtk_container_add ((GtkContainer*) grid, (GtkWidget*) _tmp69_);
	gtk_container_add ((GtkContainer*) self, (GtkWidget*) grid);
	_tmp70_ = panther_pixels_ITEM_SIZE;
	_tmp71_ = panther_pixels_ITEM_SIZE;
	gtk_widget_set_size_request ((GtkWidget*) self, _tmp70_, _tmp71_);
	g_signal_connect_object ((GtkButton*) self, "clicked", (GCallback) _panther_widgets_app_entry_launch_app_gtk_button_clicked, self, 0);
	g_signal_connect_object ((GtkWidget*) self, "button-press-event", (GCallback) ___lambda22__gtk_widget_button_press_event, self, 0);
	g_signal_connect_object ((GtkWidget*) self, "drag-begin", (GCallback) ___lambda28__gtk_widget_drag_begin, self, 0);
	g_signal_connect_object ((GtkWidget*) self, "drag-end", (GCallback) ___lambda29__gtk_widget_drag_end, self, 0);
	g_signal_connect_object ((GtkWidget*) self, "drag-data-get", (GCallback) ___lambda30__gtk_widget_drag_data_get, self, 0);
	_tmp72_ = _data4_->app;
	g_signal_connect_data (_tmp72_, "icon-changed", (GCallback) ___lambda31__panther_backend_app_icon_changed, block4_data_ref (_data4_), (GClosureNotify) block4_data_unref, 0);
	_g_object_unref0 (grid);
	block4_data_unref (_data4_);
	_data4_ = NULL;
	return self;
}


PantherWidgetsAppEntry* panther_widgets_app_entry_new (PantherBackendApp* app) {
	return panther_widgets_app_entry_construct (PANTHER_WIDGETS_TYPE_APP_ENTRY, app);
}


static void panther_widgets_app_entry_real_get_preferred_width (GtkWidget* base, gint* minimum_width, gint* natural_width) {
	PantherWidgetsAppEntry * self;
	gint _vala_minimum_width = 0;
	gint _vala_natural_width = 0;
	gint _tmp0_ = 0;
	gint _tmp1_ = 0;
	self = (PantherWidgetsAppEntry*) base;
	_tmp0_ = panther_pixels_ITEM_SIZE;
	_vala_minimum_width = _tmp0_;
	_tmp1_ = panther_pixels_ITEM_SIZE;
	_vala_natural_width = _tmp1_;
	if (minimum_width) {
		*minimum_width = _vala_minimum_width;
	}
	if (natural_width) {
		*natural_width = _vala_natural_width;
	}
}


static void panther_widgets_app_entry_real_get_preferred_height (GtkWidget* base, gint* minimum_height, gint* natural_height) {
	PantherWidgetsAppEntry * self;
	gint _vala_minimum_height = 0;
	gint _vala_natural_height = 0;
	gint _tmp0_ = 0;
	gint _tmp1_ = 0;
	self = (PantherWidgetsAppEntry*) base;
	_tmp0_ = panther_pixels_ITEM_SIZE;
	_vala_minimum_height = _tmp0_;
	_tmp1_ = panther_pixels_ITEM_SIZE;
	_vala_natural_height = _tmp1_;
	if (minimum_height) {
		*minimum_height = _vala_minimum_height;
	}
	if (natural_height) {
		*natural_height = _vala_natural_height;
	}
}


void panther_widgets_app_entry_launch_app (PantherWidgetsAppEntry* self) {
	PantherBackendApp* _tmp0_ = NULL;
	g_return_if_fail (self != NULL);
	_tmp0_ = self->priv->application;
	panther_backend_app_launch (_tmp0_);
	g_signal_emit_by_name (self, "app-launched");
}


static void __lambda23_ (PantherWidgetsAppEntry* self) {
	GtkApplication* panther_app = NULL;
	GApplication* _tmp0_ = NULL;
	GtkApplication* _tmp1_ = NULL;
	GtkWindow* _tmp2_ = NULL;
	GtkWindow* _tmp3_ = NULL;
	_tmp0_ = g_application_get_default ();
	_tmp1_ = _g_object_ref0 (G_TYPE_CHECK_INSTANCE_CAST (_tmp0_, gtk_application_get_type (), GtkApplication));
	panther_app = _tmp1_;
	_tmp2_ = gtk_application_get_active_window (panther_app);
	_tmp3_ = _tmp2_;
	panther_panther_view_grab_device (G_TYPE_CHECK_INSTANCE_CAST (_tmp3_, PANTHER_TYPE_PANTHER_VIEW, PantherPantherView));
	_g_object_unref0 (panther_app);
}


static void ___lambda23__gtk_widget_hide (GtkWidget* _sender, gpointer self) {
	__lambda23_ ((PantherWidgetsAppEntry*) self);
}


static Block5Data* block5_data_ref (Block5Data* _data5_) {
	g_atomic_int_inc (&_data5_->_ref_count_);
	return _data5_;
}


static void block5_data_unref (void * _userdata_) {
	Block5Data* _data5_;
	_data5_ = (Block5Data*) _userdata_;
	if (g_atomic_int_dec_and_test (&_data5_->_ref_count_)) {
		PantherWidgetsAppEntry* self;
		self = _data5_->self;
		_g_free0 (_data5_->action);
		_g_object_unref0 (self);
		g_slice_free (Block5Data, _data5_);
	}
}


static void ____lambda25_ (Block5Data* _data5_) {
	PantherWidgetsAppEntry* self;
	GError * _inner_error_ = NULL;
	self = _data5_->self;
	{
		gchar** values = NULL;
		PantherBackendApp* _tmp0_ = NULL;
		GeeHashMap* _tmp1_ = NULL;
		GeeHashMap* _tmp2_ = NULL;
		const gchar* _tmp3_ = NULL;
		gpointer _tmp4_ = NULL;
		gchar* _tmp5_ = NULL;
		gchar** _tmp6_ = NULL;
		gchar** _tmp7_ = NULL;
		gchar** _tmp8_ = NULL;
		gint _tmp8__length1 = 0;
		gint values_length1 = 0;
		gint _values_size_ = 0;
		GAppInfo* _tmp9_ = NULL;
		gchar** _tmp10_ = NULL;
		gint _tmp10__length1 = 0;
		const gchar* _tmp11_ = NULL;
		GAppInfo* _tmp12_ = NULL;
		GAppInfo* _tmp13_ = NULL;
		GAppInfo* _tmp14_ = NULL;
		_tmp0_ = self->priv->application;
		_tmp1_ = panther_backend_app_get_actions_map (_tmp0_);
		_tmp2_ = _tmp1_;
		_tmp3_ = _data5_->action;
		_tmp4_ = gee_abstract_map_get ((GeeAbstractMap*) _tmp2_, _tmp3_);
		_tmp5_ = (gchar*) _tmp4_;
		_tmp7_ = _tmp6_ = g_strsplit (_tmp5_, ";;", 0);
		_tmp8_ = _tmp7_;
		_tmp8__length1 = _vala_array_length (_tmp6_);
		_g_free0 (_tmp5_);
		values = _tmp8_;
		values_length1 = _tmp8__length1;
		_values_size_ = values_length1;
		_tmp10_ = values;
		_tmp10__length1 = values_length1;
		_tmp11_ = _tmp10_[0];
		_tmp12_ = g_app_info_create_from_commandline (_tmp11_, NULL, G_APP_INFO_CREATE_NONE, &_inner_error_);
		_tmp9_ = _tmp12_;
		if (G_UNLIKELY (_inner_error_ != NULL)) {
			values = (_vala_array_free (values, values_length1, (GDestroyNotify) g_free), NULL);
			goto __catch19_g_error;
		}
		_tmp13_ = _tmp9_;
		_tmp9_ = NULL;
		_tmp14_ = _tmp13_;
		g_app_info_launch (_tmp14_, NULL, NULL, &_inner_error_);
		_g_object_unref0 (_tmp14_);
		if (G_UNLIKELY (_inner_error_ != NULL)) {
			_g_object_unref0 (_tmp9_);
			values = (_vala_array_free (values, values_length1, (GDestroyNotify) g_free), NULL);
			goto __catch19_g_error;
		}
		g_signal_emit_by_name (self, "app-launched");
		_g_object_unref0 (_tmp9_);
		values = (_vala_array_free (values, values_length1, (GDestroyNotify) g_free), NULL);
	}
	goto __finally19;
	__catch19_g_error:
	{
		GError* e = NULL;
		const gchar* _tmp15_ = NULL;
		GError* _tmp16_ = NULL;
		const gchar* _tmp17_ = NULL;
		e = _inner_error_;
		_inner_error_ = NULL;
		_tmp15_ = self->desktop_path;
		_tmp16_ = e;
		_tmp17_ = _tmp16_->message;
		g_critical ("AppEntry.vala:182: %s: %s", _tmp15_, _tmp17_);
		_g_error_free0 (e);
	}
	__finally19:
	if (G_UNLIKELY (_inner_error_ != NULL)) {
		g_critical ("file %s: line %d: uncaught error: %s (%s, %d)", __FILE__, __LINE__, _inner_error_->message, g_quark_to_string (_inner_error_->domain), _inner_error_->code);
		g_clear_error (&_inner_error_);
		return;
	}
}


static void _____lambda25__gtk_menu_item_activate (GtkMenuItem* _sender, gpointer self) {
	____lambda25_ (self);
}


static gchar* bool_to_string (gboolean self) {
	gchar* result = NULL;
	if (self) {
		gchar* _tmp0_ = NULL;
		_tmp0_ = g_strdup ("true");
		result = _tmp0_;
		return result;
	} else {
		gchar* _tmp1_ = NULL;
		_tmp1_ = g_strdup ("false");
		result = _tmp1_;
		return result;
	}
}


static void panther_widgets_app_entry_create_menu (PantherWidgetsAppEntry* self) {
	PantherBackendApp* _tmp0_ = NULL;
	GeeArrayList* _tmp1_ = NULL;
	GeeArrayList* _tmp2_ = NULL;
	GtkMenu* _tmp7_ = NULL;
	GtkMenu* _tmp8_ = NULL;
	GtkMenu* _tmp27_ = NULL;
	GList* _tmp28_ = NULL;
	GList* _tmp29_ = NULL;
	guint _tmp30_ = 0U;
	gboolean _tmp31_ = FALSE;
	GtkMenu* _tmp35_ = NULL;
	GtkMenuItem* _tmp36_ = NULL;
	GtkMenuItem* _tmp37_ = NULL;
	gboolean _tmp38_ = FALSE;
	PlankDBusClient* _tmp39_ = NULL;
	GtkMenu* _tmp61_ = NULL;
	GError * _inner_error_ = NULL;
	g_return_if_fail (self != NULL);
	_tmp0_ = self->priv->application;
	_tmp1_ = panther_backend_app_get_actions (_tmp0_);
	_tmp2_ = _tmp1_;
	if (_tmp2_ == NULL) {
		{
			PantherBackendApp* _tmp3_ = NULL;
			_tmp3_ = self->priv->application;
			panther_backend_app_init_actions (_tmp3_, &_inner_error_);
			if (G_UNLIKELY (_inner_error_ != NULL)) {
				if (_inner_error_->domain == G_KEY_FILE_ERROR) {
					goto __catch18_g_key_file_error;
				}
				g_critical ("file %s: line %d: unexpected error: %s (%s, %d)", __FILE__, __LINE__, _inner_error_->message, g_quark_to_string (_inner_error_->domain), _inner_error_->code);
				g_clear_error (&_inner_error_);
				return;
			}
		}
		goto __finally18;
		__catch18_g_key_file_error:
		{
			GError* e = NULL;
			const gchar* _tmp4_ = NULL;
			GError* _tmp5_ = NULL;
			const gchar* _tmp6_ = NULL;
			e = _inner_error_;
			_inner_error_ = NULL;
			_tmp4_ = self->desktop_path;
			_tmp5_ = e;
			_tmp6_ = _tmp5_->message;
			g_critical ("AppEntry.vala:162: %s: %s", _tmp4_, _tmp6_);
			_g_error_free0 (e);
		}
		__finally18:
		if (G_UNLIKELY (_inner_error_ != NULL)) {
			g_critical ("file %s: line %d: uncaught error: %s (%s, %d)", __FILE__, __LINE__, _inner_error_->message, g_quark_to_string (_inner_error_->domain), _inner_error_->code);
			g_clear_error (&_inner_error_);
			return;
		}
	}
	_tmp7_ = (GtkMenu*) gtk_menu_new ();
	g_object_ref_sink (_tmp7_);
	_g_object_unref0 (panther_widgets_app_entry_menu);
	panther_widgets_app_entry_menu = _tmp7_;
	_tmp8_ = panther_widgets_app_entry_menu;
	g_signal_connect_object ((GtkWidget*) _tmp8_, "hide", (GCallback) ___lambda23__gtk_widget_hide, self, 0);
	{
		GeeArrayList* _action_list = NULL;
		PantherBackendApp* _tmp9_ = NULL;
		GeeArrayList* _tmp10_ = NULL;
		GeeArrayList* _tmp11_ = NULL;
		GeeArrayList* _tmp12_ = NULL;
		gint _action_size = 0;
		GeeArrayList* _tmp13_ = NULL;
		gint _tmp14_ = 0;
		gint _tmp15_ = 0;
		gint _action_index = 0;
		_tmp9_ = self->priv->application;
		_tmp10_ = panther_backend_app_get_actions (_tmp9_);
		_tmp11_ = _tmp10_;
		_tmp12_ = _g_object_ref0 (_tmp11_);
		_action_list = _tmp12_;
		_tmp13_ = _action_list;
		_tmp14_ = gee_abstract_collection_get_size ((GeeCollection*) _tmp13_);
		_tmp15_ = _tmp14_;
		_action_size = _tmp15_;
		_action_index = -1;
		while (TRUE) {
			Block5Data* _data5_;
			gint _tmp16_ = 0;
			gint _tmp17_ = 0;
			gint _tmp18_ = 0;
			GeeArrayList* _tmp19_ = NULL;
			gint _tmp20_ = 0;
			gpointer _tmp21_ = NULL;
			GtkMenuItem* menuitem = NULL;
			const gchar* _tmp22_ = NULL;
			GtkMenuItem* _tmp23_ = NULL;
			GtkMenu* _tmp24_ = NULL;
			GtkMenuItem* _tmp25_ = NULL;
			GtkMenuItem* _tmp26_ = NULL;
			_data5_ = g_slice_new0 (Block5Data);
			_data5_->_ref_count_ = 1;
			_data5_->self = g_object_ref (self);
			_tmp16_ = _action_index;
			_action_index = _tmp16_ + 1;
			_tmp17_ = _action_index;
			_tmp18_ = _action_size;
			if (!(_tmp17_ < _tmp18_)) {
				block5_data_unref (_data5_);
				_data5_ = NULL;
				break;
			}
			_tmp19_ = _action_list;
			_tmp20_ = _action_index;
			_tmp21_ = gee_abstract_list_get ((GeeAbstractList*) _tmp19_, _tmp20_);
			_data5_->action = (gchar*) _tmp21_;
			_tmp22_ = _data5_->action;
			_tmp23_ = (GtkMenuItem*) gtk_menu_item_new_with_mnemonic (_tmp22_);
			g_object_ref_sink (_tmp23_);
			menuitem = _tmp23_;
			_tmp24_ = panther_widgets_app_entry_menu;
			_tmp25_ = menuitem;
			gtk_container_add ((GtkContainer*) _tmp24_, (GtkWidget*) _tmp25_);
			_tmp26_ = menuitem;
			g_signal_connect_data (_tmp26_, "activate", (GCallback) _____lambda25__gtk_menu_item_activate, block5_data_ref (_data5_), (GClosureNotify) block5_data_unref, 0);
			_g_object_unref0 (menuitem);
			block5_data_unref (_data5_);
			_data5_ = NULL;
		}
		_g_object_unref0 (_action_list);
	}
	_tmp27_ = panther_widgets_app_entry_menu;
	_tmp28_ = gtk_container_get_children ((GtkContainer*) _tmp27_);
	_tmp29_ = _tmp28_;
	_tmp30_ = g_list_length (_tmp29_);
	_tmp31_ = _tmp30_ > ((guint) 0);
	_g_list_free0 (_tmp29_);
	if (_tmp31_) {
		GtkMenu* _tmp32_ = NULL;
		GtkSeparatorMenuItem* _tmp33_ = NULL;
		GtkSeparatorMenuItem* _tmp34_ = NULL;
		_tmp32_ = panther_widgets_app_entry_menu;
		_tmp33_ = (GtkSeparatorMenuItem*) gtk_separator_menu_item_new ();
		g_object_ref_sink (_tmp33_);
		_tmp34_ = _tmp33_;
		gtk_container_add ((GtkContainer*) _tmp32_, (GtkWidget*) _tmp34_);
		_g_object_unref0 (_tmp34_);
	}
	_tmp35_ = panther_widgets_app_entry_menu;
	_tmp36_ = panther_widgets_app_entry_get_saved_menuitem (self);
	_tmp37_ = _tmp36_;
	gtk_container_add ((GtkContainer*) _tmp35_, (GtkWidget*) _tmp37_);
	_g_object_unref0 (_tmp37_);
	_tmp39_ = panther_widgets_app_entry_plank_client;
	if (_tmp39_ != NULL) {
		PlankDBusClient* _tmp40_ = NULL;
		gboolean _tmp41_ = FALSE;
		gboolean _tmp42_ = FALSE;
		_tmp40_ = panther_widgets_app_entry_plank_client;
		_tmp41_ = plank_dbus_client_get_is_connected (_tmp40_);
		_tmp42_ = _tmp41_;
		_tmp38_ = _tmp42_;
	} else {
		_tmp38_ = FALSE;
	}
	if (_tmp38_) {
		GtkMenu* _tmp43_ = NULL;
		GList* _tmp44_ = NULL;
		GList* _tmp45_ = NULL;
		guint _tmp46_ = 0U;
		gboolean _tmp47_ = FALSE;
		GtkMenu* _tmp51_ = NULL;
		GtkMenuItem* _tmp52_ = NULL;
		GtkMenuItem* _tmp53_ = NULL;
		_tmp43_ = panther_widgets_app_entry_menu;
		_tmp44_ = gtk_container_get_children ((GtkContainer*) _tmp43_);
		_tmp45_ = _tmp44_;
		_tmp46_ = g_list_length (_tmp45_);
		_tmp47_ = _tmp46_ > ((guint) 0);
		_g_list_free0 (_tmp45_);
		if (_tmp47_) {
			GtkMenu* _tmp48_ = NULL;
			GtkSeparatorMenuItem* _tmp49_ = NULL;
			GtkSeparatorMenuItem* _tmp50_ = NULL;
			_tmp48_ = panther_widgets_app_entry_menu;
			_tmp49_ = (GtkSeparatorMenuItem*) gtk_separator_menu_item_new ();
			g_object_ref_sink (_tmp49_);
			_tmp50_ = _tmp49_;
			gtk_container_add ((GtkContainer*) _tmp48_, (GtkWidget*) _tmp50_);
			_g_object_unref0 (_tmp50_);
		}
		_tmp51_ = panther_widgets_app_entry_menu;
		_tmp52_ = panther_widgets_app_entry_get_plank_menuitem (self);
		_tmp53_ = _tmp52_;
		gtk_container_add ((GtkContainer*) _tmp51_, (GtkWidget*) _tmp53_);
		_g_object_unref0 (_tmp53_);
	} else {
		PlankDBusClient* _tmp54_ = NULL;
		gboolean _tmp55_ = FALSE;
		gboolean _tmp56_ = FALSE;
		gchar* _tmp57_ = NULL;
		gchar* _tmp58_ = NULL;
		gchar* _tmp59_ = NULL;
		gchar* _tmp60_ = NULL;
		_tmp54_ = panther_widgets_app_entry_plank_client;
		_tmp55_ = plank_dbus_client_get_is_connected (_tmp54_);
		_tmp56_ = _tmp55_;
		_tmp57_ = bool_to_string (_tmp56_);
		_tmp58_ = _tmp57_;
		_tmp59_ = g_strconcat ("Not connected: ", _tmp58_, NULL);
		_tmp60_ = _tmp59_;
		g_message ("AppEntry.vala:200: %s", _tmp60_);
		_g_free0 (_tmp60_);
		_g_free0 (_tmp58_);
	}
	_tmp61_ = panther_widgets_app_entry_menu;
	gtk_widget_show_all ((GtkWidget*) _tmp61_);
}


static gboolean _vala_string_array_contains (gchar** stack, int stack_length, gchar* needle) {
	int i;
	for (i = 0; i < stack_length; i++) {
		if (g_strcmp0 (stack[i], needle) == 0) {
			return TRUE;
		}
	}
	return FALSE;
}


static void _panther_widgets_app_entry_plank_menuitem_activate_gtk_menu_item_activate (GtkMenuItem* _sender, gpointer self) {
	panther_widgets_app_entry_plank_menuitem_activate ((PantherWidgetsAppEntry*) self);
}


static GtkMenuItem* panther_widgets_app_entry_get_plank_menuitem (PantherWidgetsAppEntry* self) {
	GtkMenuItem* result = NULL;
	const gchar* _tmp0_ = NULL;
	PlankDBusClient* _tmp1_ = NULL;
	gint _tmp2_ = 0;
	gchar** _tmp3_ = NULL;
	GtkMenuItem* plank_menuitem = NULL;
	GtkMenuItem* _tmp4_ = NULL;
	GtkMenuItem* _tmp5_ = NULL;
	gboolean _tmp6_ = FALSE;
	GtkMenuItem* _tmp11_ = NULL;
	g_return_val_if_fail (self != NULL, NULL);
	_tmp0_ = self->priv->desktop_uri;
	_tmp1_ = panther_widgets_app_entry_plank_client;
	_tmp3_ = plank_dbus_client_get_persistent_applications (_tmp1_, &_tmp2_);
	self->priv->docked = _vala_string_array_contains (_tmp3_, _tmp2_, _tmp0_);
	_tmp4_ = (GtkMenuItem*) gtk_menu_item_new ();
	g_object_ref_sink (_tmp4_);
	plank_menuitem = _tmp4_;
	_tmp5_ = plank_menuitem;
	gtk_menu_item_set_use_underline (_tmp5_, TRUE);
	_tmp6_ = self->priv->docked;
	if (_tmp6_) {
		GtkMenuItem* _tmp7_ = NULL;
		const gchar* _tmp8_ = NULL;
		_tmp7_ = plank_menuitem;
		_tmp8_ = _ ("Remove from _Dock");
		gtk_menu_item_set_label (_tmp7_, _tmp8_);
	} else {
		GtkMenuItem* _tmp9_ = NULL;
		const gchar* _tmp10_ = NULL;
		_tmp9_ = plank_menuitem;
		_tmp10_ = _ ("Pin to _Dock");
		gtk_menu_item_set_label (_tmp9_, _tmp10_);
	}
	_tmp11_ = plank_menuitem;
	g_signal_connect_object (_tmp11_, "activate", (GCallback) _panther_widgets_app_entry_plank_menuitem_activate_gtk_menu_item_activate, self, 0);
	result = plank_menuitem;
	return result;
}


static void panther_widgets_app_entry_plank_menuitem_activate (PantherWidgetsAppEntry* self) {
	gboolean _tmp0_ = FALSE;
	PlankDBusClient* _tmp1_ = NULL;
	gboolean _tmp5_ = FALSE;
	g_return_if_fail (self != NULL);
	_tmp1_ = panther_widgets_app_entry_plank_client;
	if (_tmp1_ == NULL) {
		_tmp0_ = TRUE;
	} else {
		PlankDBusClient* _tmp2_ = NULL;
		gboolean _tmp3_ = FALSE;
		gboolean _tmp4_ = FALSE;
		_tmp2_ = panther_widgets_app_entry_plank_client;
		_tmp3_ = plank_dbus_client_get_is_connected (_tmp2_);
		_tmp4_ = _tmp3_;
		_tmp0_ = !_tmp4_;
	}
	if (_tmp0_) {
		return;
	}
	_tmp5_ = self->priv->docked;
	if (_tmp5_) {
		PlankDBusClient* _tmp6_ = NULL;
		const gchar* _tmp7_ = NULL;
		_tmp6_ = panther_widgets_app_entry_plank_client;
		_tmp7_ = self->priv->desktop_uri;
		plank_dbus_client_remove_item (_tmp6_, _tmp7_);
	} else {
		PlankDBusClient* _tmp8_ = NULL;
		const gchar* _tmp9_ = NULL;
		_tmp8_ = panther_widgets_app_entry_plank_client;
		_tmp9_ = self->priv->desktop_uri;
		plank_dbus_client_add_item (_tmp8_, _tmp9_);
	}
}


static void _panther_widgets_app_entry_saved_menuitem_activate_gtk_menu_item_activate (GtkMenuItem* _sender, gpointer self) {
	panther_widgets_app_entry_saved_menuitem_activate ((PantherWidgetsAppEntry*) self);
}


static GtkMenuItem* panther_widgets_app_entry_get_saved_menuitem (PantherWidgetsAppEntry* self) {
	GtkMenuItem* result = NULL;
	GtkApplication* panther_app = NULL;
	GApplication* _tmp0_ = NULL;
	GtkApplication* _tmp1_ = NULL;
	gboolean saved = FALSE;
	GtkApplication* _tmp2_ = NULL;
	GtkWindow* _tmp3_ = NULL;
	GtkWindow* _tmp4_ = NULL;
	gboolean _tmp5_ = FALSE;
	gboolean _tmp6_ = FALSE;
	GtkMenuItem* saved_menuitem = NULL;
	GtkMenuItem* _tmp7_ = NULL;
	GtkMenuItem* _tmp8_ = NULL;
	const gchar* _tmp9_ = NULL;
	gboolean _tmp10_ = FALSE;
	GtkMenuItem* _tmp15_ = NULL;
	g_return_val_if_fail (self != NULL, NULL);
	_tmp0_ = g_application_get_default ();
	_tmp1_ = _g_object_ref0 (G_TYPE_CHECK_INSTANCE_CAST (_tmp0_, gtk_application_get_type (), GtkApplication));
	panther_app = _tmp1_;
	_tmp2_ = panther_app;
	_tmp3_ = gtk_application_get_active_window (_tmp2_);
	_tmp4_ = _tmp3_;
	_tmp5_ = panther_panther_view_get_cat_saved (G_TYPE_CHECK_INSTANCE_CAST (_tmp4_, PANTHER_TYPE_PANTHER_VIEW, PantherPantherView));
	_tmp6_ = _tmp5_;
	saved = _tmp6_;
	_tmp7_ = (GtkMenuItem*) gtk_menu_item_new ();
	g_object_ref_sink (_tmp7_);
	saved_menuitem = _tmp7_;
	_tmp8_ = saved_menuitem;
	gtk_menu_item_set_use_underline (_tmp8_, TRUE);
	_tmp9_ = self->priv->desktop_uri;
	g_warning ("AppEntry.vala:242: %s", _tmp9_);
	_tmp10_ = saved;
	if (_tmp10_) {
		GtkMenuItem* _tmp11_ = NULL;
		const gchar* _tmp12_ = NULL;
		_tmp11_ = saved_menuitem;
		_tmp12_ = _ ("Remove from _Saved");
		gtk_menu_item_set_label (_tmp11_, _tmp12_);
	} else {
		GtkMenuItem* _tmp13_ = NULL;
		const gchar* _tmp14_ = NULL;
		_tmp13_ = saved_menuitem;
		_tmp14_ = _ ("Add to Saved");
		gtk_menu_item_set_label (_tmp13_, _tmp14_);
	}
	_tmp15_ = saved_menuitem;
	g_signal_connect_object (_tmp15_, "activate", (GCallback) _panther_widgets_app_entry_saved_menuitem_activate_gtk_menu_item_activate, self, 0);
	result = saved_menuitem;
	_g_object_unref0 (panther_app);
	return result;
}


static void panther_widgets_app_entry_saved_menuitem_activate (PantherWidgetsAppEntry* self) {
	GtkApplication* panther_app = NULL;
	GApplication* _tmp0_ = NULL;
	GtkApplication* _tmp1_ = NULL;
	gboolean saved = FALSE;
	GtkApplication* _tmp2_ = NULL;
	GtkWindow* _tmp3_ = NULL;
	GtkWindow* _tmp4_ = NULL;
	gboolean _tmp5_ = FALSE;
	gboolean _tmp6_ = FALSE;
	gboolean _tmp7_ = FALSE;
	g_return_if_fail (self != NULL);
	_tmp0_ = g_application_get_default ();
	_tmp1_ = _g_object_ref0 (G_TYPE_CHECK_INSTANCE_CAST (_tmp0_, gtk_application_get_type (), GtkApplication));
	panther_app = _tmp1_;
	_tmp2_ = panther_app;
	_tmp3_ = gtk_application_get_active_window (_tmp2_);
	_tmp4_ = _tmp3_;
	_tmp5_ = panther_panther_view_get_cat_saved (G_TYPE_CHECK_INSTANCE_CAST (_tmp4_, PANTHER_TYPE_PANTHER_VIEW, PantherPantherView));
	_tmp6_ = _tmp5_;
	saved = _tmp6_;
	_tmp7_ = saved;
	if (_tmp7_) {
		panther_widgets_app_entry_remove_saved_item (self);
	} else {
		panther_widgets_app_entry_add_saved_item (self);
	}
	_g_object_unref0 (panther_app);
}


static gint string_last_index_of (const gchar* self, const gchar* needle, gint start_index) {
	gint result = 0;
	gchar* _result_ = NULL;
	gint _tmp0_ = 0;
	const gchar* _tmp1_ = NULL;
	gchar* _tmp2_ = NULL;
	gchar* _tmp3_ = NULL;
	g_return_val_if_fail (self != NULL, 0);
	g_return_val_if_fail (needle != NULL, 0);
	_tmp0_ = start_index;
	_tmp1_ = needle;
	_tmp2_ = g_strrstr (((gchar*) self) + _tmp0_, (gchar*) _tmp1_);
	_result_ = _tmp2_;
	_tmp3_ = _result_;
	if (_tmp3_ != NULL) {
		gchar* _tmp4_ = NULL;
		_tmp4_ = _result_;
		result = (gint) (_tmp4_ - ((gchar*) self));
		return result;
	} else {
		result = -1;
		return result;
	}
}


static gchar* string_slice (const gchar* self, glong start, glong end) {
	gchar* result = NULL;
	glong string_length = 0L;
	gint _tmp0_ = 0;
	gint _tmp1_ = 0;
	glong _tmp2_ = 0L;
	glong _tmp5_ = 0L;
	gboolean _tmp8_ = FALSE;
	glong _tmp9_ = 0L;
	gboolean _tmp12_ = FALSE;
	glong _tmp13_ = 0L;
	glong _tmp16_ = 0L;
	glong _tmp17_ = 0L;
	glong _tmp18_ = 0L;
	glong _tmp19_ = 0L;
	glong _tmp20_ = 0L;
	gchar* _tmp21_ = NULL;
	g_return_val_if_fail (self != NULL, NULL);
	_tmp0_ = strlen (self);
	_tmp1_ = _tmp0_;
	string_length = (glong) _tmp1_;
	_tmp2_ = start;
	if (_tmp2_ < ((glong) 0)) {
		glong _tmp3_ = 0L;
		glong _tmp4_ = 0L;
		_tmp3_ = string_length;
		_tmp4_ = start;
		start = _tmp3_ + _tmp4_;
	}
	_tmp5_ = end;
	if (_tmp5_ < ((glong) 0)) {
		glong _tmp6_ = 0L;
		glong _tmp7_ = 0L;
		_tmp6_ = string_length;
		_tmp7_ = end;
		end = _tmp6_ + _tmp7_;
	}
	_tmp9_ = start;
	if (_tmp9_ >= ((glong) 0)) {
		glong _tmp10_ = 0L;
		glong _tmp11_ = 0L;
		_tmp10_ = start;
		_tmp11_ = string_length;
		_tmp8_ = _tmp10_ <= _tmp11_;
	} else {
		_tmp8_ = FALSE;
	}
	g_return_val_if_fail (_tmp8_, NULL);
	_tmp13_ = end;
	if (_tmp13_ >= ((glong) 0)) {
		glong _tmp14_ = 0L;
		glong _tmp15_ = 0L;
		_tmp14_ = end;
		_tmp15_ = string_length;
		_tmp12_ = _tmp14_ <= _tmp15_;
	} else {
		_tmp12_ = FALSE;
	}
	g_return_val_if_fail (_tmp12_, NULL);
	_tmp16_ = start;
	_tmp17_ = end;
	g_return_val_if_fail (_tmp16_ <= _tmp17_, NULL);
	_tmp18_ = start;
	_tmp19_ = end;
	_tmp20_ = start;
	_tmp21_ = g_strndup (((gchar*) self) + _tmp18_, (gsize) (_tmp19_ - _tmp20_));
	result = _tmp21_;
	return result;
}


static void panther_widgets_app_entry_add_saved_item (PantherWidgetsAppEntry* self) {
	gchar* uri = NULL;
	const gchar* _tmp0_ = NULL;
	gchar* _tmp1_ = NULL;
	GFile* target_dir = NULL;
	GFile* _tmp2_ = NULL;
	gboolean is_valid = FALSE;
	gchar* basename = NULL;
	GFile* launcher_file = NULL;
	const gchar* _tmp16_ = NULL;
	GFile* _tmp17_ = NULL;
	GFile* _tmp18_ = NULL;
	gboolean _tmp19_ = FALSE;
	gchar* _tmp20_ = NULL;
	GFile* _tmp21_ = NULL;
	gchar* _tmp22_ = NULL;
	gchar* _tmp24_ = NULL;
	gboolean _tmp25_ = FALSE;
	GError * _inner_error_ = NULL;
	g_return_if_fail (self != NULL);
	_tmp0_ = self->priv->desktop_uri;
	_tmp1_ = g_strdup (_tmp0_);
	uri = _tmp1_;
	target_dir = NULL;
	_tmp2_ = target_dir;
	if (_tmp2_ == NULL) {
		const gchar* _tmp3_ = NULL;
		gchar* _tmp4_ = NULL;
		gchar* _tmp5_ = NULL;
		GFile* _tmp6_ = NULL;
		GFile* _tmp7_ = NULL;
		gboolean _tmp8_ = FALSE;
		_tmp3_ = g_get_user_config_dir ();
		_tmp4_ = g_strconcat (_tmp3_, "/panther/saved/", NULL);
		_tmp5_ = _tmp4_;
		_tmp6_ = g_file_new_for_path (_tmp5_);
		_g_object_unref0 (target_dir);
		target_dir = _tmp6_;
		_g_free0 (_tmp5_);
		_tmp7_ = target_dir;
		_tmp8_ = g_file_query_exists (_tmp7_, NULL);
		if (!_tmp8_) {
			{
				GFile* _tmp9_ = NULL;
				_tmp9_ = target_dir;
				g_file_make_directory_with_parents (_tmp9_, NULL, &_inner_error_);
				if (G_UNLIKELY (_inner_error_ != NULL)) {
					goto __catch20_g_error;
				}
			}
			goto __finally20;
			__catch20_g_error:
			{
				GError* e = NULL;
				gchar* _tmp10_ = NULL;
				GFile* _tmp11_ = NULL;
				gchar* _tmp12_ = NULL;
				GError* _tmp14_ = NULL;
				const gchar* _tmp15_ = NULL;
				e = _inner_error_;
				_inner_error_ = NULL;
				_tmp11_ = target_dir;
				_tmp12_ = g_file_get_path (_tmp11_);
				_tmp10_ = _tmp12_;
				if (_tmp10_ == NULL) {
					gchar* _tmp13_ = NULL;
					_tmp13_ = g_strdup ("");
					_g_free0 (_tmp10_);
					_tmp10_ = _tmp13_;
				}
				_tmp14_ = e;
				_tmp15_ = _tmp14_->message;
				g_critical ("AppEntry.vala:276: Could not access or create the directory '%s'. (%s)", _tmp10_, _tmp15_);
				_g_free0 (_tmp10_);
				_g_error_free0 (e);
			}
			__finally20:
			if (G_UNLIKELY (_inner_error_ != NULL)) {
				_g_object_unref0 (target_dir);
				_g_free0 (uri);
				g_critical ("file %s: line %d: uncaught error: %s (%s, %d)", __FILE__, __LINE__, _inner_error_->message, g_quark_to_string (_inner_error_->domain), _inner_error_->code);
				g_clear_error (&_inner_error_);
				return;
			}
		}
	}
	is_valid = FALSE;
	_tmp16_ = uri;
	_tmp17_ = g_file_new_for_uri (_tmp16_);
	launcher_file = _tmp17_;
	_tmp18_ = launcher_file;
	_tmp19_ = g_file_query_exists (_tmp18_, NULL);
	is_valid = _tmp19_;
	_tmp21_ = launcher_file;
	_tmp22_ = g_file_get_basename (_tmp21_);
	_tmp20_ = _tmp22_;
	if (_tmp20_ == NULL) {
		gchar* _tmp23_ = NULL;
		_tmp23_ = g_strdup ("unknown");
		_g_free0 (_tmp20_);
		_tmp20_ = _tmp23_;
	}
	_tmp24_ = _tmp20_;
	_tmp20_ = NULL;
	_g_free0 (basename);
	basename = _tmp24_;
	_tmp25_ = is_valid;
	if (_tmp25_) {
		GKeyFile* file = NULL;
		GKeyFile* _tmp26_ = NULL;
		_tmp26_ = g_key_file_new ();
		file = _tmp26_;
		{
			gint index_of_last_dot = 0;
			const gchar* _tmp27_ = NULL;
			gint _tmp28_ = 0;
			gchar* _tmp29_ = NULL;
			gint _tmp30_ = 0;
			gchar* launcher_base = NULL;
			gchar* _tmp36_ = NULL;
			gchar* dockitem = NULL;
			const gchar* _tmp37_ = NULL;
			gchar* _tmp38_ = NULL;
			GFile* dockitem_file = NULL;
			GFile* _tmp39_ = NULL;
			const gchar* _tmp40_ = NULL;
			GFile* _tmp41_ = NULL;
			gint counter = 0;
			GFile* _tmp42_ = NULL;
			gboolean _tmp43_ = FALSE;
			_tmp27_ = basename;
			_tmp28_ = string_last_index_of (_tmp27_, ".", 0);
			index_of_last_dot = _tmp28_;
			_tmp30_ = index_of_last_dot;
			if (_tmp30_ >= 0) {
				const gchar* _tmp31_ = NULL;
				gint _tmp32_ = 0;
				gchar* _tmp33_ = NULL;
				_tmp31_ = basename;
				_tmp32_ = index_of_last_dot;
				_tmp33_ = string_slice (_tmp31_, (glong) 0, (glong) _tmp32_);
				_g_free0 (_tmp29_);
				_tmp29_ = _tmp33_;
			} else {
				const gchar* _tmp34_ = NULL;
				gchar* _tmp35_ = NULL;
				_tmp34_ = basename;
				_tmp35_ = g_strdup (_tmp34_);
				_g_free0 (_tmp29_);
				_tmp29_ = _tmp35_;
			}
			_tmp36_ = g_strdup (_tmp29_);
			launcher_base = _tmp36_;
			_tmp37_ = launcher_base;
			_tmp38_ = g_strdup_printf ("%s.saveditem", _tmp37_);
			dockitem = _tmp38_;
			_tmp39_ = target_dir;
			_tmp40_ = dockitem;
			_tmp41_ = g_file_get_child (_tmp39_, _tmp40_);
			dockitem_file = _tmp41_;
			counter = 1;
			_tmp42_ = dockitem_file;
			_tmp43_ = g_file_query_exists (_tmp42_, NULL);
			if (!_tmp43_) {
				GFileOutputStream* _tmp44_ = NULL;
				GFile* _tmp45_ = NULL;
				GFileOutputStream* _tmp46_ = NULL;
				GDataOutputStream* stream = NULL;
				GDataOutputStream* _tmp47_ = NULL;
				GDataOutputStream* _tmp48_ = NULL;
				GKeyFile* _tmp49_ = NULL;
				gchar* _tmp50_ = NULL;
				gchar* _tmp51_ = NULL;
				GDataOutputStream* _tmp52_ = NULL;
				GtkApplication* panther_app = NULL;
				GApplication* _tmp53_ = NULL;
				GtkApplication* _tmp54_ = NULL;
				GtkApplication* _tmp55_ = NULL;
				GtkWindow* _tmp56_ = NULL;
				GtkWindow* _tmp57_ = NULL;
				const gchar* _tmp58_ = NULL;
				_tmp45_ = dockitem_file;
				_tmp46_ = g_file_create (_tmp45_, G_FILE_CREATE_NONE, NULL, &_inner_error_);
				_tmp44_ = _tmp46_;
				if (G_UNLIKELY (_inner_error_ != NULL)) {
					_g_object_unref0 (dockitem_file);
					_g_free0 (dockitem);
					_g_free0 (launcher_base);
					_g_free0 (_tmp29_);
					goto __catch21_g_error;
				}
				_tmp47_ = g_data_output_stream_new ((GOutputStream*) _tmp44_);
				stream = _tmp47_;
				_tmp48_ = stream;
				_tmp49_ = file;
				_tmp50_ = g_key_file_to_data (_tmp49_, NULL, NULL);
				_tmp51_ = _tmp50_;
				g_data_output_stream_put_string (_tmp48_, _tmp51_, NULL, &_inner_error_);
				_g_free0 (_tmp51_);
				if (G_UNLIKELY (_inner_error_ != NULL)) {
					_g_object_unref0 (stream);
					_g_object_unref0 (_tmp44_);
					_g_object_unref0 (dockitem_file);
					_g_free0 (dockitem);
					_g_free0 (launcher_base);
					_g_free0 (_tmp29_);
					goto __catch21_g_error;
				}
				_tmp52_ = stream;
				g_output_stream_close ((GOutputStream*) _tmp52_, NULL, &_inner_error_);
				if (G_UNLIKELY (_inner_error_ != NULL)) {
					_g_object_unref0 (stream);
					_g_object_unref0 (_tmp44_);
					_g_object_unref0 (dockitem_file);
					_g_free0 (dockitem);
					_g_free0 (launcher_base);
					_g_free0 (_tmp29_);
					goto __catch21_g_error;
				}
				_tmp53_ = g_application_get_default ();
				_tmp54_ = _g_object_ref0 (G_TYPE_CHECK_INSTANCE_CAST (_tmp53_, gtk_application_get_type (), GtkApplication));
				panther_app = _tmp54_;
				_tmp55_ = panther_app;
				_tmp56_ = gtk_application_get_active_window (_tmp55_);
				_tmp57_ = _tmp56_;
				_tmp58_ = basename;
				panther_panther_view_add_saved (G_TYPE_CHECK_INSTANCE_CAST (_tmp57_, PANTHER_TYPE_PANTHER_VIEW, PantherPantherView), _tmp58_);
				_g_object_unref0 (panther_app);
				_g_object_unref0 (stream);
				_g_object_unref0 (_tmp44_);
			}
			_g_object_unref0 (dockitem_file);
			_g_free0 (dockitem);
			_g_free0 (launcher_base);
			_g_free0 (_tmp29_);
		}
		goto __finally21;
		__catch21_g_error:
		{
			GError* e = NULL;
			GError* _tmp59_ = NULL;
			const gchar* _tmp60_ = NULL;
			e = _inner_error_;
			_inner_error_ = NULL;
			_tmp59_ = e;
			_tmp60_ = _tmp59_->message;
			g_warning ("AppEntry.vala:308: %s", _tmp60_);
			_g_error_free0 (e);
		}
		__finally21:
		if (G_UNLIKELY (_inner_error_ != NULL)) {
			_g_key_file_free0 (file);
			_g_free0 (_tmp20_);
			_g_object_unref0 (launcher_file);
			_g_free0 (basename);
			_g_object_unref0 (target_dir);
			_g_free0 (uri);
			g_critical ("file %s: line %d: uncaught error: %s (%s, %d)", __FILE__, __LINE__, _inner_error_->message, g_quark_to_string (_inner_error_->domain), _inner_error_->code);
			g_clear_error (&_inner_error_);
			return;
		}
		_g_key_file_free0 (file);
	}
	_g_free0 (_tmp20_);
	_g_object_unref0 (launcher_file);
	_g_free0 (basename);
	_g_object_unref0 (target_dir);
	_g_free0 (uri);
}


static glong string_strnlen (gchar* str, glong maxlen) {
	glong result = 0L;
	gchar* end = NULL;
	gchar* _tmp0_ = NULL;
	glong _tmp1_ = 0L;
	gchar* _tmp2_ = NULL;
	gchar* _tmp3_ = NULL;
	_tmp0_ = str;
	_tmp1_ = maxlen;
	_tmp2_ = memchr (_tmp0_, 0, (gsize) _tmp1_);
	end = _tmp2_;
	_tmp3_ = end;
	if (_tmp3_ == NULL) {
		glong _tmp4_ = 0L;
		_tmp4_ = maxlen;
		result = _tmp4_;
		return result;
	} else {
		gchar* _tmp5_ = NULL;
		gchar* _tmp6_ = NULL;
		_tmp5_ = end;
		_tmp6_ = str;
		result = (glong) (_tmp5_ - _tmp6_);
		return result;
	}
}


static gchar* string_substring (const gchar* self, glong offset, glong len) {
	gchar* result = NULL;
	glong string_length = 0L;
	gboolean _tmp0_ = FALSE;
	glong _tmp1_ = 0L;
	glong _tmp8_ = 0L;
	glong _tmp14_ = 0L;
	glong _tmp17_ = 0L;
	glong _tmp18_ = 0L;
	glong _tmp19_ = 0L;
	glong _tmp20_ = 0L;
	glong _tmp21_ = 0L;
	gchar* _tmp22_ = NULL;
	g_return_val_if_fail (self != NULL, NULL);
	_tmp1_ = offset;
	if (_tmp1_ >= ((glong) 0)) {
		glong _tmp2_ = 0L;
		_tmp2_ = len;
		_tmp0_ = _tmp2_ >= ((glong) 0);
	} else {
		_tmp0_ = FALSE;
	}
	if (_tmp0_) {
		glong _tmp3_ = 0L;
		glong _tmp4_ = 0L;
		glong _tmp5_ = 0L;
		_tmp3_ = offset;
		_tmp4_ = len;
		_tmp5_ = string_strnlen ((gchar*) self, _tmp3_ + _tmp4_);
		string_length = _tmp5_;
	} else {
		gint _tmp6_ = 0;
		gint _tmp7_ = 0;
		_tmp6_ = strlen (self);
		_tmp7_ = _tmp6_;
		string_length = (glong) _tmp7_;
	}
	_tmp8_ = offset;
	if (_tmp8_ < ((glong) 0)) {
		glong _tmp9_ = 0L;
		glong _tmp10_ = 0L;
		glong _tmp11_ = 0L;
		_tmp9_ = string_length;
		_tmp10_ = offset;
		offset = _tmp9_ + _tmp10_;
		_tmp11_ = offset;
		g_return_val_if_fail (_tmp11_ >= ((glong) 0), NULL);
	} else {
		glong _tmp12_ = 0L;
		glong _tmp13_ = 0L;
		_tmp12_ = offset;
		_tmp13_ = string_length;
		g_return_val_if_fail (_tmp12_ <= _tmp13_, NULL);
	}
	_tmp14_ = len;
	if (_tmp14_ < ((glong) 0)) {
		glong _tmp15_ = 0L;
		glong _tmp16_ = 0L;
		_tmp15_ = string_length;
		_tmp16_ = offset;
		len = _tmp15_ - _tmp16_;
	}
	_tmp17_ = offset;
	_tmp18_ = len;
	_tmp19_ = string_length;
	g_return_val_if_fail ((_tmp17_ + _tmp18_) <= _tmp19_, NULL);
	_tmp20_ = offset;
	_tmp21_ = len;
	_tmp22_ = g_strndup (((gchar*) self) + _tmp20_, (gsize) _tmp21_);
	result = _tmp22_;
	return result;
}


static void panther_widgets_app_entry_remove_saved_item (PantherWidgetsAppEntry* self) {
	gchar* uri = NULL;
	const gchar* _tmp0_ = NULL;
	gchar* _tmp1_ = NULL;
	GFile* target_dir = NULL;
	GFile* saved_file = NULL;
	GFile* _tmp2_ = NULL;
	gboolean is_valid = FALSE;
	gchar* basename = NULL;
	GFile* launcher_file = NULL;
	const gchar* _tmp7_ = NULL;
	GFile* _tmp8_ = NULL;
	gchar* _tmp9_ = NULL;
	GFile* _tmp10_ = NULL;
	gchar* _tmp11_ = NULL;
	gchar* _tmp13_ = NULL;
	gchar* saveditem = NULL;
	GFile* _tmp14_ = NULL;
	gchar* _tmp15_ = NULL;
	gchar* _tmp16_ = NULL;
	gchar* _tmp17_ = NULL;
	gchar* _tmp18_ = NULL;
	const gchar* _tmp19_ = NULL;
	const gchar* _tmp20_ = NULL;
	gint _tmp21_ = 0;
	gint _tmp22_ = 0;
	gchar* _tmp23_ = NULL;
	gchar* _tmp24_ = NULL;
	gchar* _tmp25_ = NULL;
	gchar* _tmp26_ = NULL;
	const gchar* _tmp27_ = NULL;
	gchar* _tmp28_ = NULL;
	gchar* _tmp29_ = NULL;
	const gchar* _tmp30_ = NULL;
	GFile* _tmp31_ = NULL;
	GFile* _tmp32_ = NULL;
	gboolean _tmp33_ = FALSE;
	gboolean _tmp34_ = FALSE;
	GError * _inner_error_ = NULL;
	g_return_if_fail (self != NULL);
	_tmp0_ = self->priv->desktop_uri;
	_tmp1_ = g_strdup (_tmp0_);
	uri = _tmp1_;
	target_dir = NULL;
	saved_file = NULL;
	_tmp2_ = target_dir;
	if (_tmp2_ == NULL) {
		const gchar* _tmp3_ = NULL;
		gchar* _tmp4_ = NULL;
		gchar* _tmp5_ = NULL;
		GFile* _tmp6_ = NULL;
		_tmp3_ = g_get_home_dir ();
		_tmp4_ = g_strconcat (_tmp3_, "/.config/panther/saved/", NULL);
		_tmp5_ = _tmp4_;
		_tmp6_ = g_file_new_for_path (_tmp5_);
		_g_object_unref0 (target_dir);
		target_dir = _tmp6_;
		_g_free0 (_tmp5_);
	}
	is_valid = FALSE;
	_tmp7_ = uri;
	_tmp8_ = g_file_new_for_uri (_tmp7_);
	launcher_file = _tmp8_;
	_tmp10_ = launcher_file;
	_tmp11_ = g_file_get_basename (_tmp10_);
	_tmp9_ = _tmp11_;
	if (_tmp9_ == NULL) {
		gchar* _tmp12_ = NULL;
		_tmp12_ = g_strdup ("unknown");
		_g_free0 (_tmp9_);
		_tmp9_ = _tmp12_;
	}
	_tmp13_ = _tmp9_;
	_tmp9_ = NULL;
	_g_free0 (basename);
	basename = _tmp13_;
	_tmp14_ = target_dir;
	_tmp15_ = g_file_get_path (_tmp14_);
	_tmp16_ = _tmp15_;
	_tmp17_ = g_strconcat (_tmp16_, "/", NULL);
	_tmp18_ = _tmp17_;
	_tmp19_ = basename;
	_tmp20_ = basename;
	_tmp21_ = strlen (_tmp20_);
	_tmp22_ = _tmp21_;
	_tmp23_ = string_substring (_tmp19_, (glong) 0, (glong) (_tmp22_ - 8));
	_tmp24_ = _tmp23_;
	_tmp25_ = g_strdup_printf ("%s%s.saveditem", _tmp18_, _tmp24_);
	_tmp26_ = _tmp25_;
	_g_free0 (_tmp24_);
	_g_free0 (_tmp18_);
	_g_free0 (_tmp16_);
	saveditem = _tmp26_;
	_tmp27_ = saveditem;
	_tmp28_ = g_strconcat ("removing saved file: ", _tmp27_, NULL);
	_tmp29_ = _tmp28_;
	g_message ("AppEntry.vala:328: %s", _tmp29_);
	_g_free0 (_tmp29_);
	_tmp30_ = saveditem;
	_tmp31_ = g_file_new_for_path (_tmp30_);
	_g_object_unref0 (saved_file);
	saved_file = _tmp31_;
	_tmp32_ = saved_file;
	_tmp33_ = g_file_query_exists (_tmp32_, NULL);
	is_valid = _tmp33_;
	_tmp34_ = is_valid;
	if (_tmp34_) {
		{
			GFile* _tmp35_ = NULL;
			GtkApplication* panther_app = NULL;
			GApplication* _tmp36_ = NULL;
			GtkApplication* _tmp37_ = NULL;
			GtkApplication* _tmp38_ = NULL;
			GtkWindow* _tmp39_ = NULL;
			GtkWindow* _tmp40_ = NULL;
			const gchar* _tmp41_ = NULL;
			_tmp35_ = saved_file;
			g_file_delete (_tmp35_, NULL, &_inner_error_);
			if (G_UNLIKELY (_inner_error_ != NULL)) {
				goto __catch22_g_error;
			}
			_tmp36_ = g_application_get_default ();
			_tmp37_ = _g_object_ref0 (G_TYPE_CHECK_INSTANCE_CAST (_tmp36_, gtk_application_get_type (), GtkApplication));
			panther_app = _tmp37_;
			_tmp38_ = panther_app;
			_tmp39_ = gtk_application_get_active_window (_tmp38_);
			_tmp40_ = _tmp39_;
			_tmp41_ = basename;
			panther_panther_view_add_saved (G_TYPE_CHECK_INSTANCE_CAST (_tmp40_, PANTHER_TYPE_PANTHER_VIEW, PantherPantherView), _tmp41_);
			_g_object_unref0 (panther_app);
		}
		goto __finally22;
		__catch22_g_error:
		{
			GError* e = NULL;
			GError* _tmp42_ = NULL;
			const gchar* _tmp43_ = NULL;
			e = _inner_error_;
			_inner_error_ = NULL;
			_tmp42_ = e;
			_tmp43_ = _tmp42_->message;
			g_warning ("AppEntry.vala:340: %s", _tmp43_);
			_g_error_free0 (e);
		}
		__finally22:
		if (G_UNLIKELY (_inner_error_ != NULL)) {
			_g_free0 (saveditem);
			_g_free0 (_tmp9_);
			_g_object_unref0 (launcher_file);
			_g_free0 (basename);
			_g_object_unref0 (saved_file);
			_g_object_unref0 (target_dir);
			_g_free0 (uri);
			g_critical ("file %s: line %d: uncaught error: %s (%s, %d)", __FILE__, __LINE__, _inner_error_->message, g_quark_to_string (_inner_error_->domain), _inner_error_->code);
			g_clear_error (&_inner_error_);
			return;
		}
	}
	_g_free0 (saveditem);
	_g_free0 (_tmp9_);
	_g_object_unref0 (launcher_file);
	_g_free0 (basename);
	_g_object_unref0 (saved_file);
	_g_object_unref0 (target_dir);
	_g_free0 (uri);
}


static void panther_widgets_app_entry_class_init (PantherWidgetsAppEntryClass * klass) {
	PlankDBusClient* _tmp0_ = NULL;
	PlankDBusClient* _tmp1_ = NULL;
	panther_widgets_app_entry_parent_class = g_type_class_peek_parent (klass);
	g_type_class_add_private (klass, sizeof (PantherWidgetsAppEntryPrivate));
	((GtkWidgetClass *) klass)->get_preferred_width = panther_widgets_app_entry_real_get_preferred_width;
	((GtkWidgetClass *) klass)->get_preferred_height = panther_widgets_app_entry_real_get_preferred_height;
	G_OBJECT_CLASS (klass)->finalize = panther_widgets_app_entry_finalize;
	g_signal_new ("app_launched", PANTHER_WIDGETS_TYPE_APP_ENTRY, G_SIGNAL_RUN_LAST, 0, NULL, NULL, g_cclosure_marshal_VOID__VOID, G_TYPE_NONE, 0);
	_tmp0_ = plank_dbus_client_get_instance ();
	_tmp1_ = _g_object_ref0 (_tmp0_);
	_g_object_unref0 (panther_widgets_app_entry_plank_client);
	panther_widgets_app_entry_plank_client = _tmp1_;
}


static void panther_widgets_app_entry_instance_init (PantherWidgetsAppEntry * self) {
	self->priv = PANTHER_WIDGETS_APP_ENTRY_GET_PRIVATE (self);
	self->priv->dragging = FALSE;
	self->priv->docked = FALSE;
}


static void panther_widgets_app_entry_finalize (GObject* obj) {
	PantherWidgetsAppEntry * self;
	self = G_TYPE_CHECK_INSTANCE_CAST (obj, PANTHER_WIDGETS_TYPE_APP_ENTRY, PantherWidgetsAppEntry);
	_g_object_unref0 (self->app_label);
	_g_object_unref0 (self->priv->icon);
	_g_object_unref0 (self->priv->image);
	_g_free0 (self->exec_name);
	_g_free0 (self->app_name);
	_g_free0 (self->desktop_id);
	_g_free0 (self->desktop_path);
	_g_object_unref0 (self->launchers_dir);
	_g_object_unref0 (self->priv->application);
	_g_object_unref0 (self->priv->app_system);
	_g_free0 (self->priv->desktop_uri);
	G_OBJECT_CLASS (panther_widgets_app_entry_parent_class)->finalize (obj);
}


GType panther_widgets_app_entry_get_type (void) {
	static volatile gsize panther_widgets_app_entry_type_id__volatile = 0;
	if (g_once_init_enter (&panther_widgets_app_entry_type_id__volatile)) {
		static const GTypeInfo g_define_type_info = { sizeof (PantherWidgetsAppEntryClass), (GBaseInitFunc) NULL, (GBaseFinalizeFunc) NULL, (GClassInitFunc) panther_widgets_app_entry_class_init, (GClassFinalizeFunc) NULL, NULL, sizeof (PantherWidgetsAppEntry), 0, (GInstanceInitFunc) panther_widgets_app_entry_instance_init, NULL };
		GType panther_widgets_app_entry_type_id;
		panther_widgets_app_entry_type_id = g_type_register_static (gtk_button_get_type (), "PantherWidgetsAppEntry", &g_define_type_info, 0);
		g_once_init_leave (&panther_widgets_app_entry_type_id__volatile, panther_widgets_app_entry_type_id);
	}
	return panther_widgets_app_entry_type_id__volatile;
}


static void _vala_array_destroy (gpointer array, gint array_length, GDestroyNotify destroy_func) {
	if ((array != NULL) && (destroy_func != NULL)) {
		int i;
		for (i = 0; i < array_length; i = i + 1) {
			if (((gpointer*) array)[i] != NULL) {
				destroy_func (((gpointer*) array)[i]);
			}
		}
	}
}


static void _vala_array_free (gpointer array, gint array_length, GDestroyNotify destroy_func) {
	_vala_array_destroy (array, array_length, destroy_func);
	g_free (array);
}


static gint _vala_array_length (gpointer array) {
	int length;
	length = 0;
	if (array) {
		while (((gpointer*) array)[length]) {
			length++;
		}
	}
	return length;
}



